WITH 
CD AS(
	SELECT ID, FUNC_DATE FROM HIGH_AGE_CD.DBO.CD1996
	WHERE 
((SUBSTRING(ACODE_ICD9_1,1,3) = '250' AND SUBSTRING(ACODE_ICD9_1,5,1) != '3' AND SUBSTRING(ACODE_ICD9_1,5,1) != '1')
OR
(SUBSTRING(ACODE_ICD9_2,1,3) = '250' AND SUBSTRING(ACODE_ICD9_2,5,1) != '3' AND SUBSTRING(ACODE_ICD9_2,5,1) != '1')
OR
(SUBSTRING(ACODE_ICD9_3,1,3) = '250' AND SUBSTRING(ACODE_ICD9_3,5,1) != '3' AND SUBSTRING(ACODE_ICD9_3,5,1) != '1')
OR
substring(ACODE_ICD9_1,1,4) = 'A181' or substring(ACODE_ICD9_2,1,4) = 'A181' or substring(ACODE_ICD9_3,1,4) = 'A181')
and
(CASE_TYPE = '04' or CASE_TYPE = '06')
	union all
	SELECT ID, FUNC_DATE FROM HIGH_AGE_CD.DBO.CD1997
	WHERE 
((SUBSTRING(ACODE_ICD9_1,1,3) = '250' AND SUBSTRING(ACODE_ICD9_1,5,1) != '3' AND SUBSTRING(ACODE_ICD9_1,5,1) != '1')
OR
(SUBSTRING(ACODE_ICD9_2,1,3) = '250' AND SUBSTRING(ACODE_ICD9_2,5,1) != '3' AND SUBSTRING(ACODE_ICD9_2,5,1) != '1')
OR
(SUBSTRING(ACODE_ICD9_3,1,3) = '250' AND SUBSTRING(ACODE_ICD9_3,5,1) != '3' AND SUBSTRING(ACODE_ICD9_3,5,1) != '1')
OR
substring(ACODE_ICD9_1,1,4) = 'A181' or substring(ACODE_ICD9_2,1,4) = 'A181' or substring(ACODE_ICD9_3,1,4) = 'A181')
and
(CASE_TYPE = '04' or CASE_TYPE = '06')
	union all
	SELECT ID, FUNC_DATE FROM HIGH_AGE_CD.DBO.CD1998
	WHERE 
((SUBSTRING(ACODE_ICD9_1,1,3) = '250' AND SUBSTRING(ACODE_ICD9_1,5,1) != '3' AND SUBSTRING(ACODE_ICD9_1,5,1) != '1')
OR
(SUBSTRING(ACODE_ICD9_2,1,3) = '250' AND SUBSTRING(ACODE_ICD9_2,5,1) != '3' AND SUBSTRING(ACODE_ICD9_2,5,1) != '1')
OR
(SUBSTRING(ACODE_ICD9_3,1,3) = '250' AND SUBSTRING(ACODE_ICD9_3,5,1) != '3' AND SUBSTRING(ACODE_ICD9_3,5,1) != '1')
OR
substring(ACODE_ICD9_1,1,4) = 'A181' or substring(ACODE_ICD9_2,1,4) = 'A181' or substring(ACODE_ICD9_3,1,4) = 'A181')
and
(CASE_TYPE = '04' or CASE_TYPE = '06')
	union all
	SELECT ID, FUNC_DATE FROM HIGH_AGE_CD.DBO.CD1999
	WHERE 
((SUBSTRING(ACODE_ICD9_1,1,3) = '250' AND SUBSTRING(ACODE_ICD9_1,5,1) != '3' AND SUBSTRING(ACODE_ICD9_1,5,1) != '1')
OR
(SUBSTRING(ACODE_ICD9_2,1,3) = '250' AND SUBSTRING(ACODE_ICD9_2,5,1) != '3' AND SUBSTRING(ACODE_ICD9_2,5,1) != '1')
OR
(SUBSTRING(ACODE_ICD9_3,1,3) = '250' AND SUBSTRING(ACODE_ICD9_3,5,1) != '3' AND SUBSTRING(ACODE_ICD9_3,5,1) != '1')
OR
substring(ACODE_ICD9_1,1,4) = 'A181' or substring(ACODE_ICD9_2,1,4) = 'A181' or substring(ACODE_ICD9_3,1,4) = 'A181')
and
(CASE_TYPE = '04' or CASE_TYPE = '06')
	union all
	SELECT ID, FUNC_DATE FROM HIGH_AGE_CD.DBO.CD2000
	WHERE 
((SUBSTRING(ACODE_ICD9_1,1,3) = '250' AND SUBSTRING(ACODE_ICD9_1,5,1) != '3' AND SUBSTRING(ACODE_ICD9_1,5,1) != '1')
OR
(SUBSTRING(ACODE_ICD9_2,1,3) = '250' AND SUBSTRING(ACODE_ICD9_2,5,1) != '3' AND SUBSTRING(ACODE_ICD9_2,5,1) != '1')
OR
(SUBSTRING(ACODE_ICD9_3,1,3) = '250' AND SUBSTRING(ACODE_ICD9_3,5,1) != '3' AND SUBSTRING(ACODE_ICD9_3,5,1) != '1')
OR
substring(ACODE_ICD9_1,1,4) = 'A181' or substring(ACODE_ICD9_2,1,4) = 'A181' or substring(ACODE_ICD9_3,1,4) = 'A181')
and
(CASE_TYPE = '04' or CASE_TYPE = '06')
	union all
	SELECT ID, FUNC_DATE FROM HIGH_AGE_CD.DBO.CD2001
	WHERE 
((SUBSTRING(ACODE_ICD9_1,1,3) = '250' AND SUBSTRING(ACODE_ICD9_1,5,1) != '3' AND SUBSTRING(ACODE_ICD9_1,5,1) != '1')
OR
(SUBSTRING(ACODE_ICD9_2,1,3) = '250' AND SUBSTRING(ACODE_ICD9_2,5,1) != '3' AND SUBSTRING(ACODE_ICD9_2,5,1) != '1')
OR
(SUBSTRING(ACODE_ICD9_3,1,3) = '250' AND SUBSTRING(ACODE_ICD9_3,5,1) != '3' AND SUBSTRING(ACODE_ICD9_3,5,1) != '1')
OR
substring(ACODE_ICD9_1,1,4) = 'A181' or substring(ACODE_ICD9_2,1,4) = 'A181' or substring(ACODE_ICD9_3,1,4) = 'A181')
and
(CASE_TYPE = '04' or CASE_TYPE = '06')
	union all
	SELECT ID, FUNC_DATE FROM HIGH_AGE_CD.DBO.CD2002
	WHERE 
((SUBSTRING(ACODE_ICD9_1,1,3) = '250' AND SUBSTRING(ACODE_ICD9_1,5,1) != '3' AND SUBSTRING(ACODE_ICD9_1,5,1) != '1')
OR
(SUBSTRING(ACODE_ICD9_2,1,3) = '250' AND SUBSTRING(ACODE_ICD9_2,5,1) != '3' AND SUBSTRING(ACODE_ICD9_2,5,1) != '1')
OR
(SUBSTRING(ACODE_ICD9_3,1,3) = '250' AND SUBSTRING(ACODE_ICD9_3,5,1) != '3' AND SUBSTRING(ACODE_ICD9_3,5,1) != '1')
OR
substring(ACODE_ICD9_1,1,4) = 'A181' or substring(ACODE_ICD9_2,1,4) = 'A181' or substring(ACODE_ICD9_3,1,4) = 'A181')
and
(CASE_TYPE = '04' or CASE_TYPE = '06')
	union all
	SELECT ID, FUNC_DATE FROM HIGH_AGE_CD.DBO.CD2003
	WHERE 
((SUBSTRING(ACODE_ICD9_1,1,3) = '250' AND SUBSTRING(ACODE_ICD9_1,5,1) != '3' AND SUBSTRING(ACODE_ICD9_1,5,1) != '1')
OR
(SUBSTRING(ACODE_ICD9_2,1,3) = '250' AND SUBSTRING(ACODE_ICD9_2,5,1) != '3' AND SUBSTRING(ACODE_ICD9_2,5,1) != '1')
OR
(SUBSTRING(ACODE_ICD9_3,1,3) = '250' AND SUBSTRING(ACODE_ICD9_3,5,1) != '3' AND SUBSTRING(ACODE_ICD9_3,5,1) != '1')
OR
substring(ACODE_ICD9_1,1,4) = 'A181' or substring(ACODE_ICD9_2,1,4) = 'A181' or substring(ACODE_ICD9_3,1,4) = 'A181')
and
(CASE_TYPE = '04' or CASE_TYPE = '06')
	union all
	SELECT ID, FUNC_DATE FROM HIGH_AGE_CD.DBO.CD2004
	WHERE 
((SUBSTRING(ACODE_ICD9_1,1,3) = '250' AND SUBSTRING(ACODE_ICD9_1,5,1) != '3' AND SUBSTRING(ACODE_ICD9_1,5,1) != '1')
OR
(SUBSTRING(ACODE_ICD9_2,1,3) = '250' AND SUBSTRING(ACODE_ICD9_2,5,1) != '3' AND SUBSTRING(ACODE_ICD9_2,5,1) != '1')
OR
(SUBSTRING(ACODE_ICD9_3,1,3) = '250' AND SUBSTRING(ACODE_ICD9_3,5,1) != '3' AND SUBSTRING(ACODE_ICD9_3,5,1) != '1')
OR
substring(ACODE_ICD9_1,1,4) = 'A181' or substring(ACODE_ICD9_2,1,4) = 'A181' or substring(ACODE_ICD9_3,1,4) = 'A181')
and
(CASE_TYPE = '04' or CASE_TYPE = '06')
	union all
	SELECT ID, FUNC_DATE FROM HIGH_AGE_CD.DBO.CD2005
	WHERE 
((SUBSTRING(ACODE_ICD9_1,1,3) = '250' AND SUBSTRING(ACODE_ICD9_1,5,1) != '3' AND SUBSTRING(ACODE_ICD9_1,5,1) != '1')
OR
(SUBSTRING(ACODE_ICD9_2,1,3) = '250' AND SUBSTRING(ACODE_ICD9_2,5,1) != '3' AND SUBSTRING(ACODE_ICD9_2,5,1) != '1')
OR
(SUBSTRING(ACODE_ICD9_3,1,3) = '250' AND SUBSTRING(ACODE_ICD9_3,5,1) != '3' AND SUBSTRING(ACODE_ICD9_3,5,1) != '1')
OR
substring(ACODE_ICD9_1,1,4) = 'A181' or substring(ACODE_ICD9_2,1,4) = 'A181' or substring(ACODE_ICD9_3,1,4) = 'A181')
and
(CASE_TYPE = '04' or CASE_TYPE = '06')
	union all
	SELECT ID, FUNC_DATE FROM HIGH_AGE_CD.DBO.CD2006
	WHERE 
((SUBSTRING(ACODE_ICD9_1,1,3) = '250' AND SUBSTRING(ACODE_ICD9_1,5,1) != '3' AND SUBSTRING(ACODE_ICD9_1,5,1) != '1')
OR
(SUBSTRING(ACODE_ICD9_2,1,3) = '250' AND SUBSTRING(ACODE_ICD9_2,5,1) != '3' AND SUBSTRING(ACODE_ICD9_2,5,1) != '1')
OR
(SUBSTRING(ACODE_ICD9_3,1,3) = '250' AND SUBSTRING(ACODE_ICD9_3,5,1) != '3' AND SUBSTRING(ACODE_ICD9_3,5,1) != '1')
OR
substring(ACODE_ICD9_1,1,4) = 'A181' or substring(ACODE_ICD9_2,1,4) = 'A181' or substring(ACODE_ICD9_3,1,4) = 'A181')
and
(CASE_TYPE = '04' or CASE_TYPE = '06')
	union all
	SELECT ID, FUNC_DATE FROM HIGH_AGE_CD.DBO.CD2007
	WHERE 
((SUBSTRING(ACODE_ICD9_1,1,3) = '250' AND SUBSTRING(ACODE_ICD9_1,5,1) != '3' AND SUBSTRING(ACODE_ICD9_1,5,1) != '1')
OR
(SUBSTRING(ACODE_ICD9_2,1,3) = '250' AND SUBSTRING(ACODE_ICD9_2,5,1) != '3' AND SUBSTRING(ACODE_ICD9_2,5,1) != '1')
OR
(SUBSTRING(ACODE_ICD9_3,1,3) = '250' AND SUBSTRING(ACODE_ICD9_3,5,1) != '3' AND SUBSTRING(ACODE_ICD9_3,5,1) != '1')
OR
substring(ACODE_ICD9_1,1,4) = 'A181' or substring(ACODE_ICD9_2,1,4) = 'A181' or substring(ACODE_ICD9_3,1,4) = 'A181')
and
(CASE_TYPE = '04' or CASE_TYPE = '06')
	union all
	SELECT ID, FUNC_DATE FROM HIGH_AGE_CD.DBO.CD2008
	WHERE 
((SUBSTRING(ACODE_ICD9_1,1,3) = '250' AND SUBSTRING(ACODE_ICD9_1,5,1) != '3' AND SUBSTRING(ACODE_ICD9_1,5,1) != '1')
OR
(SUBSTRING(ACODE_ICD9_2,1,3) = '250' AND SUBSTRING(ACODE_ICD9_2,5,1) != '3' AND SUBSTRING(ACODE_ICD9_2,5,1) != '1')
OR
(SUBSTRING(ACODE_ICD9_3,1,3) = '250' AND SUBSTRING(ACODE_ICD9_3,5,1) != '3' AND SUBSTRING(ACODE_ICD9_3,5,1) != '1')
OR
substring(ACODE_ICD9_1,1,4) = 'A181' or substring(ACODE_ICD9_2,1,4) = 'A181' or substring(ACODE_ICD9_3,1,4) = 'A181')
and
(CASE_TYPE = '04' or CASE_TYPE = '06')
	union all
	SELECT ID, FUNC_DATE FROM HIGH_AGE_CD.DBO.CD2009
	WHERE 
((SUBSTRING(ACODE_ICD9_1,1,3) = '250' AND SUBSTRING(ACODE_ICD9_1,5,1) != '3' AND SUBSTRING(ACODE_ICD9_1,5,1) != '1')
OR
(SUBSTRING(ACODE_ICD9_2,1,3) = '250' AND SUBSTRING(ACODE_ICD9_2,5,1) != '3' AND SUBSTRING(ACODE_ICD9_2,5,1) != '1')
OR
(SUBSTRING(ACODE_ICD9_3,1,3) = '250' AND SUBSTRING(ACODE_ICD9_3,5,1) != '3' AND SUBSTRING(ACODE_ICD9_3,5,1) != '1')
OR
substring(ACODE_ICD9_1,1,4) = 'A181' or substring(ACODE_ICD9_2,1,4) = 'A181' or substring(ACODE_ICD9_3,1,4) = 'A181')
and
(CASE_TYPE = '04' or CASE_TYPE = '06')
	union all
	SELECT ID, FUNC_DATE FROM HIGH_AGE_CD.DBO.CD2010
	WHERE 
((SUBSTRING(ACODE_ICD9_1,1,3) = '250' AND SUBSTRING(ACODE_ICD9_1,5,1) != '3' AND SUBSTRING(ACODE_ICD9_1,5,1) != '1')
OR
(SUBSTRING(ACODE_ICD9_2,1,3) = '250' AND SUBSTRING(ACODE_ICD9_2,5,1) != '3' AND SUBSTRING(ACODE_ICD9_2,5,1) != '1')
OR
(SUBSTRING(ACODE_ICD9_3,1,3) = '250' AND SUBSTRING(ACODE_ICD9_3,5,1) != '3' AND SUBSTRING(ACODE_ICD9_3,5,1) != '1')
OR
substring(ACODE_ICD9_1,1,4) = 'A181' or substring(ACODE_ICD9_2,1,4) = 'A181' or substring(ACODE_ICD9_3,1,4) = 'A181')
and
(CASE_TYPE = '04' or CASE_TYPE = '06')
	union all
	SELECT ID, FUNC_DATE FROM HIGH_AGE_CD.DBO.CD2011
	WHERE 
((SUBSTRING(ACODE_ICD9_1,1,3) = '250' AND SUBSTRING(ACODE_ICD9_1,5,1) != '3' AND SUBSTRING(ACODE_ICD9_1,5,1) != '1')
OR
(SUBSTRING(ACODE_ICD9_2,1,3) = '250' AND SUBSTRING(ACODE_ICD9_2,5,1) != '3' AND SUBSTRING(ACODE_ICD9_2,5,1) != '1')
OR
(SUBSTRING(ACODE_ICD9_3,1,3) = '250' AND SUBSTRING(ACODE_ICD9_3,5,1) != '3' AND SUBSTRING(ACODE_ICD9_3,5,1) != '1')
OR
substring(ACODE_ICD9_1,1,4) = 'A181' or substring(ACODE_ICD9_2,1,4) = 'A181' or substring(ACODE_ICD9_3,1,4) = 'A181')
and
(CASE_TYPE = '04' or CASE_TYPE = '06')
	union all
	SELECT ID, FUNC_DATE FROM HIGH_AGE_CD.DBO.CD2012
	WHERE 
((SUBSTRING(ACODE_ICD9_1,1,3) = '250' AND SUBSTRING(ACODE_ICD9_1,5,1) != '3' AND SUBSTRING(ACODE_ICD9_1,5,1) != '1')
OR
(SUBSTRING(ACODE_ICD9_2,1,3) = '250' AND SUBSTRING(ACODE_ICD9_2,5,1) != '3' AND SUBSTRING(ACODE_ICD9_2,5,1) != '1')
OR
(SUBSTRING(ACODE_ICD9_3,1,3) = '250' AND SUBSTRING(ACODE_ICD9_3,5,1) != '3' AND SUBSTRING(ACODE_ICD9_3,5,1) != '1')
OR
substring(ACODE_ICD9_1,1,4) = 'A181' or substring(ACODE_ICD9_2,1,4) = 'A181' or substring(ACODE_ICD9_3,1,4) = 'A181')
and
(CASE_TYPE = '04' or CASE_TYPE = '06')
	union all
	SELECT ID, FUNC_DATE FROM HIGH_AGE_CD.DBO.CD2013
	WHERE 
((SUBSTRING(ACODE_ICD9_1,1,3) = '250' AND SUBSTRING(ACODE_ICD9_1,5,1) != '3' AND SUBSTRING(ACODE_ICD9_1,5,1) != '1')
OR
(SUBSTRING(ACODE_ICD9_2,1,3) = '250' AND SUBSTRING(ACODE_ICD9_2,5,1) != '3' AND SUBSTRING(ACODE_ICD9_2,5,1) != '1')
OR
(SUBSTRING(ACODE_ICD9_3,1,3) = '250' AND SUBSTRING(ACODE_ICD9_3,5,1) != '3' AND SUBSTRING(ACODE_ICD9_3,5,1) != '1')
OR
substring(ACODE_ICD9_1,1,4) = 'A181' or substring(ACODE_ICD9_2,1,4) = 'A181' or substring(ACODE_ICD9_3,1,4) = 'A181')
and
(CASE_TYPE = '04' or CASE_TYPE = '06')
),
DD AS(
	SELECT ID, IN_DATE FROM HIGH_AGE_DD.DBO.DD1996
	WHERE 
(SUBSTRING(ICD9CM_CODE,1,3) = '250' AND SUBSTRING(ICD9CM_CODE,5,1) != '3' AND SUBSTRING(ICD9CM_CODE,5,1) != '1')
OR
(SUBSTRING(ICD9CM_CODE_1,1,3) = '250' AND SUBSTRING(ICD9CM_CODE_1,5,1) != '3' AND SUBSTRING(ICD9CM_CODE_1,5,1) != '1')
OR
(SUBSTRING(ICD9CM_CODE_2,1,3) = '250' AND SUBSTRING(ICD9CM_CODE_2,5,1) != '3' AND SUBSTRING(ICD9CM_CODE_2,5,1) != '1')
OR
(SUBSTRING(ICD9CM_CODE_3,1,3) = '250' AND SUBSTRING(ICD9CM_CODE_3,5,1) != '3' AND SUBSTRING(ICD9CM_CODE_3,5,1) != '1')
OR
(SUBSTRING(ICD9CM_CODE_4,1,3) = '250' AND SUBSTRING(ICD9CM_CODE_4,5,1) != '3' AND SUBSTRING(ICD9CM_CODE_4,5,1) != '1')
OR
substring(ICD9CM_CODE,1,4) = 'A181' or substring(ICD9CM_CODE_1,1,4) = 'A181' or substring(ICD9CM_CODE_2,1,4) = 'A181' or substring(ICD9CM_CODE_3,1,4) = 'A181' or substring(ICD9CM_CODE_4,1,4) = 'A181'
	UNION ALL
	SELECT ID, IN_DATE FROM HIGH_AGE_DD.DBO.DD1997
	WHERE 
(SUBSTRING(ICD9CM_CODE,1,3) = '250' AND SUBSTRING(ICD9CM_CODE,5,1) != '3' AND SUBSTRING(ICD9CM_CODE,5,1) != '1')
OR
(SUBSTRING(ICD9CM_CODE_1,1,3) = '250' AND SUBSTRING(ICD9CM_CODE_1,5,1) != '3' AND SUBSTRING(ICD9CM_CODE_1,5,1) != '1')
OR
(SUBSTRING(ICD9CM_CODE_2,1,3) = '250' AND SUBSTRING(ICD9CM_CODE_2,5,1) != '3' AND SUBSTRING(ICD9CM_CODE_2,5,1) != '1')
OR
(SUBSTRING(ICD9CM_CODE_3,1,3) = '250' AND SUBSTRING(ICD9CM_CODE_3,5,1) != '3' AND SUBSTRING(ICD9CM_CODE_3,5,1) != '1')
OR
(SUBSTRING(ICD9CM_CODE_4,1,3) = '250' AND SUBSTRING(ICD9CM_CODE_4,5,1) != '3' AND SUBSTRING(ICD9CM_CODE_4,5,1) != '1')
OR
substring(ICD9CM_CODE,1,4) = 'A181' or substring(ICD9CM_CODE_1,1,4) = 'A181' or substring(ICD9CM_CODE_2,1,4) = 'A181' or substring(ICD9CM_CODE_3,1,4) = 'A181' or substring(ICD9CM_CODE_4,1,4) = 'A181'
	UNION ALL
	SELECT ID, IN_DATE FROM HIGH_AGE_DD.DBO.DD1998
	WHERE 
(SUBSTRING(ICD9CM_CODE,1,3) = '250' AND SUBSTRING(ICD9CM_CODE,5,1) != '3' AND SUBSTRING(ICD9CM_CODE,5,1) != '1')
OR
(SUBSTRING(ICD9CM_CODE_1,1,3) = '250' AND SUBSTRING(ICD9CM_CODE_1,5,1) != '3' AND SUBSTRING(ICD9CM_CODE_1,5,1) != '1')
OR
(SUBSTRING(ICD9CM_CODE_2,1,3) = '250' AND SUBSTRING(ICD9CM_CODE_2,5,1) != '3' AND SUBSTRING(ICD9CM_CODE_2,5,1) != '1')
OR
(SUBSTRING(ICD9CM_CODE_3,1,3) = '250' AND SUBSTRING(ICD9CM_CODE_3,5,1) != '3' AND SUBSTRING(ICD9CM_CODE_3,5,1) != '1')
OR
(SUBSTRING(ICD9CM_CODE_4,1,3) = '250' AND SUBSTRING(ICD9CM_CODE_4,5,1) != '3' AND SUBSTRING(ICD9CM_CODE_4,5,1) != '1')
OR
substring(ICD9CM_CODE,1,4) = 'A181' or substring(ICD9CM_CODE_1,1,4) = 'A181' or substring(ICD9CM_CODE_2,1,4) = 'A181' or substring(ICD9CM_CODE_3,1,4) = 'A181' or substring(ICD9CM_CODE_4,1,4) = 'A181'
	UNION ALL
	SELECT ID, IN_DATE FROM HIGH_AGE_DD.DBO.DD1999
	WHERE 
(SUBSTRING(ICD9CM_CODE,1,3) = '250' AND SUBSTRING(ICD9CM_CODE,5,1) != '3' AND SUBSTRING(ICD9CM_CODE,5,1) != '1')
OR
(SUBSTRING(ICD9CM_CODE_1,1,3) = '250' AND SUBSTRING(ICD9CM_CODE_1,5,1) != '3' AND SUBSTRING(ICD9CM_CODE_1,5,1) != '1')
OR
(SUBSTRING(ICD9CM_CODE_2,1,3) = '250' AND SUBSTRING(ICD9CM_CODE_2,5,1) != '3' AND SUBSTRING(ICD9CM_CODE_2,5,1) != '1')
OR
(SUBSTRING(ICD9CM_CODE_3,1,3) = '250' AND SUBSTRING(ICD9CM_CODE_3,5,1) != '3' AND SUBSTRING(ICD9CM_CODE_3,5,1) != '1')
OR
(SUBSTRING(ICD9CM_CODE_4,1,3) = '250' AND SUBSTRING(ICD9CM_CODE_4,5,1) != '3' AND SUBSTRING(ICD9CM_CODE_4,5,1) != '1')
OR
substring(ICD9CM_CODE,1,4) = 'A181' or substring(ICD9CM_CODE_1,1,4) = 'A181' or substring(ICD9CM_CODE_2,1,4) = 'A181' or substring(ICD9CM_CODE_3,1,4) = 'A181' or substring(ICD9CM_CODE_4,1,4) = 'A181'
	UNION ALL
	SELECT ID, IN_DATE FROM HIGH_AGE_DD.DBO.DD2000
	WHERE 
(SUBSTRING(ICD9CM_CODE,1,3) = '250' AND SUBSTRING(ICD9CM_CODE,5,1) != '3' AND SUBSTRING(ICD9CM_CODE,5,1) != '1')
OR
(SUBSTRING(ICD9CM_CODE_1,1,3) = '250' AND SUBSTRING(ICD9CM_CODE_1,5,1) != '3' AND SUBSTRING(ICD9CM_CODE_1,5,1) != '1')
OR
(SUBSTRING(ICD9CM_CODE_2,1,3) = '250' AND SUBSTRING(ICD9CM_CODE_2,5,1) != '3' AND SUBSTRING(ICD9CM_CODE_2,5,1) != '1')
OR
(SUBSTRING(ICD9CM_CODE_3,1,3) = '250' AND SUBSTRING(ICD9CM_CODE_3,5,1) != '3' AND SUBSTRING(ICD9CM_CODE_3,5,1) != '1')
OR
(SUBSTRING(ICD9CM_CODE_4,1,3) = '250' AND SUBSTRING(ICD9CM_CODE_4,5,1) != '3' AND SUBSTRING(ICD9CM_CODE_4,5,1) != '1')
OR
substring(ICD9CM_CODE,1,4) = 'A181' or substring(ICD9CM_CODE_1,1,4) = 'A181' or substring(ICD9CM_CODE_2,1,4) = 'A181' or substring(ICD9CM_CODE_3,1,4) = 'A181' or substring(ICD9CM_CODE_4,1,4) = 'A181'
	UNION ALL
	SELECT ID, IN_DATE FROM HIGH_AGE_DD.DBO.DD2001
	WHERE 
(SUBSTRING(ICD9CM_CODE,1,3) = '250' AND SUBSTRING(ICD9CM_CODE,5,1) != '3' AND SUBSTRING(ICD9CM_CODE,5,1) != '1')
OR
(SUBSTRING(ICD9CM_CODE_1,1,3) = '250' AND SUBSTRING(ICD9CM_CODE_1,5,1) != '3' AND SUBSTRING(ICD9CM_CODE_1,5,1) != '1')
OR
(SUBSTRING(ICD9CM_CODE_2,1,3) = '250' AND SUBSTRING(ICD9CM_CODE_2,5,1) != '3' AND SUBSTRING(ICD9CM_CODE_2,5,1) != '1')
OR
(SUBSTRING(ICD9CM_CODE_3,1,3) = '250' AND SUBSTRING(ICD9CM_CODE_3,5,1) != '3' AND SUBSTRING(ICD9CM_CODE_3,5,1) != '1')
OR
(SUBSTRING(ICD9CM_CODE_4,1,3) = '250' AND SUBSTRING(ICD9CM_CODE_4,5,1) != '3' AND SUBSTRING(ICD9CM_CODE_4,5,1) != '1')
OR
substring(ICD9CM_CODE,1,4) = 'A181' or substring(ICD9CM_CODE_1,1,4) = 'A181' or substring(ICD9CM_CODE_2,1,4) = 'A181' or substring(ICD9CM_CODE_3,1,4) = 'A181' or substring(ICD9CM_CODE_4,1,4) = 'A181'
	UNION ALL
	SELECT ID, IN_DATE FROM HIGH_AGE_DD.DBO.DD2002
	WHERE 
(SUBSTRING(ICD9CM_CODE,1,3) = '250' AND SUBSTRING(ICD9CM_CODE,5,1) != '3' AND SUBSTRING(ICD9CM_CODE,5,1) != '1')
OR
(SUBSTRING(ICD9CM_CODE_1,1,3) = '250' AND SUBSTRING(ICD9CM_CODE_1,5,1) != '3' AND SUBSTRING(ICD9CM_CODE_1,5,1) != '1')
OR
(SUBSTRING(ICD9CM_CODE_2,1,3) = '250' AND SUBSTRING(ICD9CM_CODE_2,5,1) != '3' AND SUBSTRING(ICD9CM_CODE_2,5,1) != '1')
OR
(SUBSTRING(ICD9CM_CODE_3,1,3) = '250' AND SUBSTRING(ICD9CM_CODE_3,5,1) != '3' AND SUBSTRING(ICD9CM_CODE_3,5,1) != '1')
OR
(SUBSTRING(ICD9CM_CODE_4,1,3) = '250' AND SUBSTRING(ICD9CM_CODE_4,5,1) != '3' AND SUBSTRING(ICD9CM_CODE_4,5,1) != '1')
OR
substring(ICD9CM_CODE,1,4) = 'A181' or substring(ICD9CM_CODE_1,1,4) = 'A181' or substring(ICD9CM_CODE_2,1,4) = 'A181' or substring(ICD9CM_CODE_3,1,4) = 'A181' or substring(ICD9CM_CODE_4,1,4) = 'A181'
	UNION ALL
	SELECT ID, IN_DATE FROM HIGH_AGE_DD.DBO.DD2003
	WHERE 
(SUBSTRING(ICD9CM_CODE,1,3) = '250' AND SUBSTRING(ICD9CM_CODE,5,1) != '3' AND SUBSTRING(ICD9CM_CODE,5,1) != '1')
OR
(SUBSTRING(ICD9CM_CODE_1,1,3) = '250' AND SUBSTRING(ICD9CM_CODE_1,5,1) != '3' AND SUBSTRING(ICD9CM_CODE_1,5,1) != '1')
OR
(SUBSTRING(ICD9CM_CODE_2,1,3) = '250' AND SUBSTRING(ICD9CM_CODE_2,5,1) != '3' AND SUBSTRING(ICD9CM_CODE_2,5,1) != '1')
OR
(SUBSTRING(ICD9CM_CODE_3,1,3) = '250' AND SUBSTRING(ICD9CM_CODE_3,5,1) != '3' AND SUBSTRING(ICD9CM_CODE_3,5,1) != '1')
OR
(SUBSTRING(ICD9CM_CODE_4,1,3) = '250' AND SUBSTRING(ICD9CM_CODE_4,5,1) != '3' AND SUBSTRING(ICD9CM_CODE_4,5,1) != '1')
OR
substring(ICD9CM_CODE,1,4) = 'A181' or substring(ICD9CM_CODE_1,1,4) = 'A181' or substring(ICD9CM_CODE_2,1,4) = 'A181' or substring(ICD9CM_CODE_3,1,4) = 'A181' or substring(ICD9CM_CODE_4,1,4) = 'A181'
	UNION ALL
	SELECT ID, IN_DATE FROM HIGH_AGE_DD.DBO.DD2004
	WHERE 
(SUBSTRING(ICD9CM_CODE,1,3) = '250' AND SUBSTRING(ICD9CM_CODE,5,1) != '3' AND SUBSTRING(ICD9CM_CODE,5,1) != '1')
OR
(SUBSTRING(ICD9CM_CODE_1,1,3) = '250' AND SUBSTRING(ICD9CM_CODE_1,5,1) != '3' AND SUBSTRING(ICD9CM_CODE_1,5,1) != '1')
OR
(SUBSTRING(ICD9CM_CODE_2,1,3) = '250' AND SUBSTRING(ICD9CM_CODE_2,5,1) != '3' AND SUBSTRING(ICD9CM_CODE_2,5,1) != '1')
OR
(SUBSTRING(ICD9CM_CODE_3,1,3) = '250' AND SUBSTRING(ICD9CM_CODE_3,5,1) != '3' AND SUBSTRING(ICD9CM_CODE_3,5,1) != '1')
OR
(SUBSTRING(ICD9CM_CODE_4,1,3) = '250' AND SUBSTRING(ICD9CM_CODE_4,5,1) != '3' AND SUBSTRING(ICD9CM_CODE_4,5,1) != '1')
OR
substring(ICD9CM_CODE,1,4) = 'A181' or substring(ICD9CM_CODE_1,1,4) = 'A181' or substring(ICD9CM_CODE_2,1,4) = 'A181' or substring(ICD9CM_CODE_3,1,4) = 'A181' or substring(ICD9CM_CODE_4,1,4) = 'A181'
	UNION ALL
	SELECT ID, IN_DATE FROM HIGH_AGE_DD.DBO.DD2005
	WHERE 
(SUBSTRING(ICD9CM_CODE,1,3) = '250' AND SUBSTRING(ICD9CM_CODE,5,1) != '3' AND SUBSTRING(ICD9CM_CODE,5,1) != '1')
OR
(SUBSTRING(ICD9CM_CODE_1,1,3) = '250' AND SUBSTRING(ICD9CM_CODE_1,5,1) != '3' AND SUBSTRING(ICD9CM_CODE_1,5,1) != '1')
OR
(SUBSTRING(ICD9CM_CODE_2,1,3) = '250' AND SUBSTRING(ICD9CM_CODE_2,5,1) != '3' AND SUBSTRING(ICD9CM_CODE_2,5,1) != '1')
OR
(SUBSTRING(ICD9CM_CODE_3,1,3) = '250' AND SUBSTRING(ICD9CM_CODE_3,5,1) != '3' AND SUBSTRING(ICD9CM_CODE_3,5,1) != '1')
OR
(SUBSTRING(ICD9CM_CODE_4,1,3) = '250' AND SUBSTRING(ICD9CM_CODE_4,5,1) != '3' AND SUBSTRING(ICD9CM_CODE_4,5,1) != '1')
OR
substring(ICD9CM_CODE,1,4) = 'A181' or substring(ICD9CM_CODE_1,1,4) = 'A181' or substring(ICD9CM_CODE_2,1,4) = 'A181' or substring(ICD9CM_CODE_3,1,4) = 'A181' or substring(ICD9CM_CODE_4,1,4) = 'A181'
	UNION ALL
	SELECT ID, IN_DATE FROM HIGH_AGE_DD.DBO.DD2006
	WHERE 
(SUBSTRING(ICD9CM_CODE,1,3) = '250' AND SUBSTRING(ICD9CM_CODE,5,1) != '3' AND SUBSTRING(ICD9CM_CODE,5,1) != '1')
OR
(SUBSTRING(ICD9CM_CODE_1,1,3) = '250' AND SUBSTRING(ICD9CM_CODE_1,5,1) != '3' AND SUBSTRING(ICD9CM_CODE_1,5,1) != '1')
OR
(SUBSTRING(ICD9CM_CODE_2,1,3) = '250' AND SUBSTRING(ICD9CM_CODE_2,5,1) != '3' AND SUBSTRING(ICD9CM_CODE_2,5,1) != '1')
OR
(SUBSTRING(ICD9CM_CODE_3,1,3) = '250' AND SUBSTRING(ICD9CM_CODE_3,5,1) != '3' AND SUBSTRING(ICD9CM_CODE_3,5,1) != '1')
OR
(SUBSTRING(ICD9CM_CODE_4,1,3) = '250' AND SUBSTRING(ICD9CM_CODE_4,5,1) != '3' AND SUBSTRING(ICD9CM_CODE_4,5,1) != '1')
OR
substring(ICD9CM_CODE,1,4) = 'A181' or substring(ICD9CM_CODE_1,1,4) = 'A181' or substring(ICD9CM_CODE_2,1,4) = 'A181' or substring(ICD9CM_CODE_3,1,4) = 'A181' or substring(ICD9CM_CODE_4,1,4) = 'A181'
	UNION ALL
	SELECT ID, IN_DATE FROM HIGH_AGE_DD.DBO.DD2007
	WHERE 
(SUBSTRING(ICD9CM_CODE,1,3) = '250' AND SUBSTRING(ICD9CM_CODE,5,1) != '3' AND SUBSTRING(ICD9CM_CODE,5,1) != '1')
OR
(SUBSTRING(ICD9CM_CODE_1,1,3) = '250' AND SUBSTRING(ICD9CM_CODE_1,5,1) != '3' AND SUBSTRING(ICD9CM_CODE_1,5,1) != '1')
OR
(SUBSTRING(ICD9CM_CODE_2,1,3) = '250' AND SUBSTRING(ICD9CM_CODE_2,5,1) != '3' AND SUBSTRING(ICD9CM_CODE_2,5,1) != '1')
OR
(SUBSTRING(ICD9CM_CODE_3,1,3) = '250' AND SUBSTRING(ICD9CM_CODE_3,5,1) != '3' AND SUBSTRING(ICD9CM_CODE_3,5,1) != '1')
OR
(SUBSTRING(ICD9CM_CODE_4,1,3) = '250' AND SUBSTRING(ICD9CM_CODE_4,5,1) != '3' AND SUBSTRING(ICD9CM_CODE_4,5,1) != '1')
OR
substring(ICD9CM_CODE,1,4) = 'A181' or substring(ICD9CM_CODE_1,1,4) = 'A181' or substring(ICD9CM_CODE_2,1,4) = 'A181' or substring(ICD9CM_CODE_3,1,4) = 'A181' or substring(ICD9CM_CODE_4,1,4) = 'A181'
	UNION ALL
	SELECT ID, IN_DATE FROM HIGH_AGE_DD.DBO.DD2008
	WHERE 
(SUBSTRING(ICD9CM_CODE,1,3) = '250' AND SUBSTRING(ICD9CM_CODE,5,1) != '3' AND SUBSTRING(ICD9CM_CODE,5,1) != '1')
OR
(SUBSTRING(ICD9CM_CODE_1,1,3) = '250' AND SUBSTRING(ICD9CM_CODE_1,5,1) != '3' AND SUBSTRING(ICD9CM_CODE_1,5,1) != '1')
OR
(SUBSTRING(ICD9CM_CODE_2,1,3) = '250' AND SUBSTRING(ICD9CM_CODE_2,5,1) != '3' AND SUBSTRING(ICD9CM_CODE_2,5,1) != '1')
OR
(SUBSTRING(ICD9CM_CODE_3,1,3) = '250' AND SUBSTRING(ICD9CM_CODE_3,5,1) != '3' AND SUBSTRING(ICD9CM_CODE_3,5,1) != '1')
OR
(SUBSTRING(ICD9CM_CODE_4,1,3) = '250' AND SUBSTRING(ICD9CM_CODE_4,5,1) != '3' AND SUBSTRING(ICD9CM_CODE_4,5,1) != '1')
OR
substring(ICD9CM_CODE,1,4) = 'A181' or substring(ICD9CM_CODE_1,1,4) = 'A181' or substring(ICD9CM_CODE_2,1,4) = 'A181' or substring(ICD9CM_CODE_3,1,4) = 'A181' or substring(ICD9CM_CODE_4,1,4) = 'A181'
	UNION ALL
	SELECT ID, IN_DATE FROM HIGH_AGE_DD.DBO.DD2009
	WHERE 
(SUBSTRING(ICD9CM_CODE,1,3) = '250' AND SUBSTRING(ICD9CM_CODE,5,1) != '3' AND SUBSTRING(ICD9CM_CODE,5,1) != '1')
OR
(SUBSTRING(ICD9CM_CODE_1,1,3) = '250' AND SUBSTRING(ICD9CM_CODE_1,5,1) != '3' AND SUBSTRING(ICD9CM_CODE_1,5,1) != '1')
OR
(SUBSTRING(ICD9CM_CODE_2,1,3) = '250' AND SUBSTRING(ICD9CM_CODE_2,5,1) != '3' AND SUBSTRING(ICD9CM_CODE_2,5,1) != '1')
OR
(SUBSTRING(ICD9CM_CODE_3,1,3) = '250' AND SUBSTRING(ICD9CM_CODE_3,5,1) != '3' AND SUBSTRING(ICD9CM_CODE_3,5,1) != '1')
OR
(SUBSTRING(ICD9CM_CODE_4,1,3) = '250' AND SUBSTRING(ICD9CM_CODE_4,5,1) != '3' AND SUBSTRING(ICD9CM_CODE_4,5,1) != '1')
OR
substring(ICD9CM_CODE,1,4) = 'A181' or substring(ICD9CM_CODE_1,1,4) = 'A181' or substring(ICD9CM_CODE_2,1,4) = 'A181' or substring(ICD9CM_CODE_3,1,4) = 'A181' or substring(ICD9CM_CODE_4,1,4) = 'A181'
	UNION ALL
	SELECT ID, IN_DATE FROM HIGH_AGE_DD.DBO.DD2010
	WHERE 
(SUBSTRING(ICD9CM_CODE,1,3) = '250' AND SUBSTRING(ICD9CM_CODE,5,1) != '3' AND SUBSTRING(ICD9CM_CODE,5,1) != '1')
OR
(SUBSTRING(ICD9CM_CODE_1,1,3) = '250' AND SUBSTRING(ICD9CM_CODE_1,5,1) != '3' AND SUBSTRING(ICD9CM_CODE_1,5,1) != '1')
OR
(SUBSTRING(ICD9CM_CODE_2,1,3) = '250' AND SUBSTRING(ICD9CM_CODE_2,5,1) != '3' AND SUBSTRING(ICD9CM_CODE_2,5,1) != '1')
OR
(SUBSTRING(ICD9CM_CODE_3,1,3) = '250' AND SUBSTRING(ICD9CM_CODE_3,5,1) != '3' AND SUBSTRING(ICD9CM_CODE_3,5,1) != '1')
OR
(SUBSTRING(ICD9CM_CODE_4,1,3) = '250' AND SUBSTRING(ICD9CM_CODE_4,5,1) != '3' AND SUBSTRING(ICD9CM_CODE_4,5,1) != '1')
OR
substring(ICD9CM_CODE,1,4) = 'A181' or substring(ICD9CM_CODE_1,1,4) = 'A181' or substring(ICD9CM_CODE_2,1,4) = 'A181' or substring(ICD9CM_CODE_3,1,4) = 'A181' or substring(ICD9CM_CODE_4,1,4) = 'A181'
	UNION ALL
	SELECT ID, IN_DATE FROM HIGH_AGE_DD.DBO.DD2011
	WHERE 
(SUBSTRING(ICD9CM_CODE,1,3) = '250' AND SUBSTRING(ICD9CM_CODE,5,1) != '3' AND SUBSTRING(ICD9CM_CODE,5,1) != '1')
OR
(SUBSTRING(ICD9CM_CODE_1,1,3) = '250' AND SUBSTRING(ICD9CM_CODE_1,5,1) != '3' AND SUBSTRING(ICD9CM_CODE_1,5,1) != '1')
OR
(SUBSTRING(ICD9CM_CODE_2,1,3) = '250' AND SUBSTRING(ICD9CM_CODE_2,5,1) != '3' AND SUBSTRING(ICD9CM_CODE_2,5,1) != '1')
OR
(SUBSTRING(ICD9CM_CODE_3,1,3) = '250' AND SUBSTRING(ICD9CM_CODE_3,5,1) != '3' AND SUBSTRING(ICD9CM_CODE_3,5,1) != '1')
OR
(SUBSTRING(ICD9CM_CODE_4,1,3) = '250' AND SUBSTRING(ICD9CM_CODE_4,5,1) != '3' AND SUBSTRING(ICD9CM_CODE_4,5,1) != '1')
OR
substring(ICD9CM_CODE,1,4) = 'A181' or substring(ICD9CM_CODE_1,1,4) = 'A181' or substring(ICD9CM_CODE_2,1,4) = 'A181' or substring(ICD9CM_CODE_3,1,4) = 'A181' or substring(ICD9CM_CODE_4,1,4) = 'A181'
	UNION ALL
	SELECT ID, IN_DATE FROM HIGH_AGE_DD.DBO.DD2012
	WHERE 
(SUBSTRING(ICD9CM_CODE,1,3) = '250' AND SUBSTRING(ICD9CM_CODE,5,1) != '3' AND SUBSTRING(ICD9CM_CODE,5,1) != '1')
OR
(SUBSTRING(ICD9CM_CODE_1,1,3) = '250' AND SUBSTRING(ICD9CM_CODE_1,5,1) != '3' AND SUBSTRING(ICD9CM_CODE_1,5,1) != '1')
OR
(SUBSTRING(ICD9CM_CODE_2,1,3) = '250' AND SUBSTRING(ICD9CM_CODE_2,5,1) != '3' AND SUBSTRING(ICD9CM_CODE_2,5,1) != '1')
OR
(SUBSTRING(ICD9CM_CODE_3,1,3) = '250' AND SUBSTRING(ICD9CM_CODE_3,5,1) != '3' AND SUBSTRING(ICD9CM_CODE_3,5,1) != '1')
OR
(SUBSTRING(ICD9CM_CODE_4,1,3) = '250' AND SUBSTRING(ICD9CM_CODE_4,5,1) != '3' AND SUBSTRING(ICD9CM_CODE_4,5,1) != '1')
OR
substring(ICD9CM_CODE,1,4) = 'A181' or substring(ICD9CM_CODE_1,1,4) = 'A181' or substring(ICD9CM_CODE_2,1,4) = 'A181' or substring(ICD9CM_CODE_3,1,4) = 'A181' or substring(ICD9CM_CODE_4,1,4) = 'A181'
	UNION ALL
	SELECT ID, IN_DATE FROM HIGH_AGE_DD.DBO.DD2013
	WHERE 
(SUBSTRING(ICD9CM_CODE,1,3) = '250' AND SUBSTRING(ICD9CM_CODE,5,1) != '3' AND SUBSTRING(ICD9CM_CODE,5,1) != '1')
OR
(SUBSTRING(ICD9CM_CODE_1,1,3) = '250' AND SUBSTRING(ICD9CM_CODE_1,5,1) != '3' AND SUBSTRING(ICD9CM_CODE_1,5,1) != '1')
OR
(SUBSTRING(ICD9CM_CODE_2,1,3) = '250' AND SUBSTRING(ICD9CM_CODE_2,5,1) != '3' AND SUBSTRING(ICD9CM_CODE_2,5,1) != '1')
OR
(SUBSTRING(ICD9CM_CODE_3,1,3) = '250' AND SUBSTRING(ICD9CM_CODE_3,5,1) != '3' AND SUBSTRING(ICD9CM_CODE_3,5,1) != '1')
OR
(SUBSTRING(ICD9CM_CODE_4,1,3) = '250' AND SUBSTRING(ICD9CM_CODE_4,5,1) != '3' AND SUBSTRING(ICD9CM_CODE_4,5,1) != '1')
OR
substring(ICD9CM_CODE,1,4) = 'A181' or substring(ICD9CM_CODE_1,1,4) = 'A181' or substring(ICD9CM_CODE_2,1,4) = 'A181' or substring(ICD9CM_CODE_3,1,4) = 'A181' or substring(ICD9CM_CODE_4,1,4) = 'A181'
),
A AS(
SELECT ID FROM CD
)

SELECT distinct A.ID, HIGH_AGE_ID.dbo.UID100W.ID_SEX into A.dbo.diabetes_cp FROM A
left join HIGH_AGE_ID.dbo.UID100W
on UID100W.ID = A.ID

with C as(
	SELECT ID, FUNC_DATE FROM HIGH_AGE_CD.DBO.CD1996
	WHERE 
not((SUBSTRING(ACODE_ICD9_1,1,3) = '250' AND SUBSTRING(ACODE_ICD9_1,5,1) != '3' AND SUBSTRING(ACODE_ICD9_1,5,1) != '1')
OR
(SUBSTRING(ACODE_ICD9_2,1,3) = '250' AND SUBSTRING(ACODE_ICD9_2,5,1) != '3' AND SUBSTRING(ACODE_ICD9_2,5,1) != '1')
OR
(SUBSTRING(ACODE_ICD9_3,1,3) = '250' AND SUBSTRING(ACODE_ICD9_3,5,1) != '3' AND SUBSTRING(ACODE_ICD9_3,5,1) != '1')
OR
substring(ACODE_ICD9_1,1,4) = 'A181' or substring(ACODE_ICD9_2,1,4) = 'A181' or substring(ACODE_ICD9_3,1,4) = 'A181')
and
(CASE_TYPE = '04' or CASE_TYPE = '06')
	union all
	SELECT ID, FUNC_DATE FROM HIGH_AGE_CD.DBO.CD1997
	WHERE 
not((SUBSTRING(ACODE_ICD9_1,1,3) = '250' AND SUBSTRING(ACODE_ICD9_1,5,1) != '3' AND SUBSTRING(ACODE_ICD9_1,5,1) != '1')
OR
(SUBSTRING(ACODE_ICD9_2,1,3) = '250' AND SUBSTRING(ACODE_ICD9_2,5,1) != '3' AND SUBSTRING(ACODE_ICD9_2,5,1) != '1')
OR
(SUBSTRING(ACODE_ICD9_3,1,3) = '250' AND SUBSTRING(ACODE_ICD9_3,5,1) != '3' AND SUBSTRING(ACODE_ICD9_3,5,1) != '1')
OR
substring(ACODE_ICD9_1,1,4) = 'A181' or substring(ACODE_ICD9_2,1,4) = 'A181' or substring(ACODE_ICD9_3,1,4) = 'A181')
and
(CASE_TYPE = '04' or CASE_TYPE = '06')
	union all
	SELECT ID, FUNC_DATE FROM HIGH_AGE_CD.DBO.CD1998
	WHERE 
not((SUBSTRING(ACODE_ICD9_1,1,3) = '250' AND SUBSTRING(ACODE_ICD9_1,5,1) != '3' AND SUBSTRING(ACODE_ICD9_1,5,1) != '1')
OR
(SUBSTRING(ACODE_ICD9_2,1,3) = '250' AND SUBSTRING(ACODE_ICD9_2,5,1) != '3' AND SUBSTRING(ACODE_ICD9_2,5,1) != '1')
OR
(SUBSTRING(ACODE_ICD9_3,1,3) = '250' AND SUBSTRING(ACODE_ICD9_3,5,1) != '3' AND SUBSTRING(ACODE_ICD9_3,5,1) != '1')
OR
substring(ACODE_ICD9_1,1,4) = 'A181' or substring(ACODE_ICD9_2,1,4) = 'A181' or substring(ACODE_ICD9_3,1,4) = 'A181')
and
(CASE_TYPE = '04' or CASE_TYPE = '06')
	union all
	SELECT ID, FUNC_DATE FROM HIGH_AGE_CD.DBO.CD1999
	WHERE 
not((SUBSTRING(ACODE_ICD9_1,1,3) = '250' AND SUBSTRING(ACODE_ICD9_1,5,1) != '3' AND SUBSTRING(ACODE_ICD9_1,5,1) != '1')
OR
(SUBSTRING(ACODE_ICD9_2,1,3) = '250' AND SUBSTRING(ACODE_ICD9_2,5,1) != '3' AND SUBSTRING(ACODE_ICD9_2,5,1) != '1')
OR
(SUBSTRING(ACODE_ICD9_3,1,3) = '250' AND SUBSTRING(ACODE_ICD9_3,5,1) != '3' AND SUBSTRING(ACODE_ICD9_3,5,1) != '1')
OR
substring(ACODE_ICD9_1,1,4) = 'A181' or substring(ACODE_ICD9_2,1,4) = 'A181' or substring(ACODE_ICD9_3,1,4) = 'A181')
and
(CASE_TYPE = '04' or CASE_TYPE = '06')
	union all
	SELECT ID, FUNC_DATE FROM HIGH_AGE_CD.DBO.CD2000
	WHERE 
not((SUBSTRING(ACODE_ICD9_1,1,3) = '250' AND SUBSTRING(ACODE_ICD9_1,5,1) != '3' AND SUBSTRING(ACODE_ICD9_1,5,1) != '1')
OR
(SUBSTRING(ACODE_ICD9_2,1,3) = '250' AND SUBSTRING(ACODE_ICD9_2,5,1) != '3' AND SUBSTRING(ACODE_ICD9_2,5,1) != '1')
OR
(SUBSTRING(ACODE_ICD9_3,1,3) = '250' AND SUBSTRING(ACODE_ICD9_3,5,1) != '3' AND SUBSTRING(ACODE_ICD9_3,5,1) != '1')
OR
substring(ACODE_ICD9_1,1,4) = 'A181' or substring(ACODE_ICD9_2,1,4) = 'A181' or substring(ACODE_ICD9_3,1,4) = 'A181')
and
(CASE_TYPE = '04' or CASE_TYPE = '06')
	union all
	SELECT ID, FUNC_DATE FROM HIGH_AGE_CD.DBO.CD2001
	WHERE 
not((SUBSTRING(ACODE_ICD9_1,1,3) = '250' AND SUBSTRING(ACODE_ICD9_1,5,1) != '3' AND SUBSTRING(ACODE_ICD9_1,5,1) != '1')
OR
(SUBSTRING(ACODE_ICD9_2,1,3) = '250' AND SUBSTRING(ACODE_ICD9_2,5,1) != '3' AND SUBSTRING(ACODE_ICD9_2,5,1) != '1')
OR
(SUBSTRING(ACODE_ICD9_3,1,3) = '250' AND SUBSTRING(ACODE_ICD9_3,5,1) != '3' AND SUBSTRING(ACODE_ICD9_3,5,1) != '1')
OR
substring(ACODE_ICD9_1,1,4) = 'A181' or substring(ACODE_ICD9_2,1,4) = 'A181' or substring(ACODE_ICD9_3,1,4) = 'A181')
and
(CASE_TYPE = '04' or CASE_TYPE = '06')
	union all
	SELECT ID, FUNC_DATE FROM HIGH_AGE_CD.DBO.CD2002
	WHERE 
not((SUBSTRING(ACODE_ICD9_1,1,3) = '250' AND SUBSTRING(ACODE_ICD9_1,5,1) != '3' AND SUBSTRING(ACODE_ICD9_1,5,1) != '1')
OR
(SUBSTRING(ACODE_ICD9_2,1,3) = '250' AND SUBSTRING(ACODE_ICD9_2,5,1) != '3' AND SUBSTRING(ACODE_ICD9_2,5,1) != '1')
OR
(SUBSTRING(ACODE_ICD9_3,1,3) = '250' AND SUBSTRING(ACODE_ICD9_3,5,1) != '3' AND SUBSTRING(ACODE_ICD9_3,5,1) != '1')
OR
substring(ACODE_ICD9_1,1,4) = 'A181' or substring(ACODE_ICD9_2,1,4) = 'A181' or substring(ACODE_ICD9_3,1,4) = 'A181')
and
(CASE_TYPE = '04' or CASE_TYPE = '06')
	union all
	SELECT ID, FUNC_DATE FROM HIGH_AGE_CD.DBO.CD2003
	WHERE 
not((SUBSTRING(ACODE_ICD9_1,1,3) = '250' AND SUBSTRING(ACODE_ICD9_1,5,1) != '3' AND SUBSTRING(ACODE_ICD9_1,5,1) != '1')
OR
(SUBSTRING(ACODE_ICD9_2,1,3) = '250' AND SUBSTRING(ACODE_ICD9_2,5,1) != '3' AND SUBSTRING(ACODE_ICD9_2,5,1) != '1')
OR
(SUBSTRING(ACODE_ICD9_3,1,3) = '250' AND SUBSTRING(ACODE_ICD9_3,5,1) != '3' AND SUBSTRING(ACODE_ICD9_3,5,1) != '1')
OR
substring(ACODE_ICD9_1,1,4) = 'A181' or substring(ACODE_ICD9_2,1,4) = 'A181' or substring(ACODE_ICD9_3,1,4) = 'A181')
and
(CASE_TYPE = '04' or CASE_TYPE = '06')
	union all
	SELECT ID, FUNC_DATE FROM HIGH_AGE_CD.DBO.CD2004
	WHERE 
not((SUBSTRING(ACODE_ICD9_1,1,3) = '250' AND SUBSTRING(ACODE_ICD9_1,5,1) != '3' AND SUBSTRING(ACODE_ICD9_1,5,1) != '1')
OR
(SUBSTRING(ACODE_ICD9_2,1,3) = '250' AND SUBSTRING(ACODE_ICD9_2,5,1) != '3' AND SUBSTRING(ACODE_ICD9_2,5,1) != '1')
OR
(SUBSTRING(ACODE_ICD9_3,1,3) = '250' AND SUBSTRING(ACODE_ICD9_3,5,1) != '3' AND SUBSTRING(ACODE_ICD9_3,5,1) != '1')
OR
substring(ACODE_ICD9_1,1,4) = 'A181' or substring(ACODE_ICD9_2,1,4) = 'A181' or substring(ACODE_ICD9_3,1,4) = 'A181')
and
(CASE_TYPE = '04' or CASE_TYPE = '06')
	union all
	SELECT ID, FUNC_DATE FROM HIGH_AGE_CD.DBO.CD2005
	WHERE 
not((SUBSTRING(ACODE_ICD9_1,1,3) = '250' AND SUBSTRING(ACODE_ICD9_1,5,1) != '3' AND SUBSTRING(ACODE_ICD9_1,5,1) != '1')
OR
(SUBSTRING(ACODE_ICD9_2,1,3) = '250' AND SUBSTRING(ACODE_ICD9_2,5,1) != '3' AND SUBSTRING(ACODE_ICD9_2,5,1) != '1')
OR
(SUBSTRING(ACODE_ICD9_3,1,3) = '250' AND SUBSTRING(ACODE_ICD9_3,5,1) != '3' AND SUBSTRING(ACODE_ICD9_3,5,1) != '1')
OR
substring(ACODE_ICD9_1,1,4) = 'A181' or substring(ACODE_ICD9_2,1,4) = 'A181' or substring(ACODE_ICD9_3,1,4) = 'A181')
and
(CASE_TYPE = '04' or CASE_TYPE = '06')
	union all
	SELECT ID, FUNC_DATE FROM HIGH_AGE_CD.DBO.CD2006
	WHERE 
not((SUBSTRING(ACODE_ICD9_1,1,3) = '250' AND SUBSTRING(ACODE_ICD9_1,5,1) != '3' AND SUBSTRING(ACODE_ICD9_1,5,1) != '1')
OR
(SUBSTRING(ACODE_ICD9_2,1,3) = '250' AND SUBSTRING(ACODE_ICD9_2,5,1) != '3' AND SUBSTRING(ACODE_ICD9_2,5,1) != '1')
OR
(SUBSTRING(ACODE_ICD9_3,1,3) = '250' AND SUBSTRING(ACODE_ICD9_3,5,1) != '3' AND SUBSTRING(ACODE_ICD9_3,5,1) != '1')
OR
substring(ACODE_ICD9_1,1,4) = 'A181' or substring(ACODE_ICD9_2,1,4) = 'A181' or substring(ACODE_ICD9_3,1,4) = 'A181')
and
(CASE_TYPE = '04' or CASE_TYPE = '06')
	union all
	SELECT ID, FUNC_DATE FROM HIGH_AGE_CD.DBO.CD2007
	WHERE 
not((SUBSTRING(ACODE_ICD9_1,1,3) = '250' AND SUBSTRING(ACODE_ICD9_1,5,1) != '3' AND SUBSTRING(ACODE_ICD9_1,5,1) != '1')
OR
(SUBSTRING(ACODE_ICD9_2,1,3) = '250' AND SUBSTRING(ACODE_ICD9_2,5,1) != '3' AND SUBSTRING(ACODE_ICD9_2,5,1) != '1')
OR
(SUBSTRING(ACODE_ICD9_3,1,3) = '250' AND SUBSTRING(ACODE_ICD9_3,5,1) != '3' AND SUBSTRING(ACODE_ICD9_3,5,1) != '1')
OR
substring(ACODE_ICD9_1,1,4) = 'A181' or substring(ACODE_ICD9_2,1,4) = 'A181' or substring(ACODE_ICD9_3,1,4) = 'A181')
and
(CASE_TYPE = '04' or CASE_TYPE = '06')
	union all
	SELECT ID, FUNC_DATE FROM HIGH_AGE_CD.DBO.CD2008
	WHERE 
not((SUBSTRING(ACODE_ICD9_1,1,3) = '250' AND SUBSTRING(ACODE_ICD9_1,5,1) != '3' AND SUBSTRING(ACODE_ICD9_1,5,1) != '1')
OR
(SUBSTRING(ACODE_ICD9_2,1,3) = '250' AND SUBSTRING(ACODE_ICD9_2,5,1) != '3' AND SUBSTRING(ACODE_ICD9_2,5,1) != '1')
OR
(SUBSTRING(ACODE_ICD9_3,1,3) = '250' AND SUBSTRING(ACODE_ICD9_3,5,1) != '3' AND SUBSTRING(ACODE_ICD9_3,5,1) != '1')
OR
substring(ACODE_ICD9_1,1,4) = 'A181' or substring(ACODE_ICD9_2,1,4) = 'A181' or substring(ACODE_ICD9_3,1,4) = 'A181')
and
(CASE_TYPE = '04' or CASE_TYPE = '06')
	union all
	SELECT ID, FUNC_DATE FROM HIGH_AGE_CD.DBO.CD2009
	WHERE 
not((SUBSTRING(ACODE_ICD9_1,1,3) = '250' AND SUBSTRING(ACODE_ICD9_1,5,1) != '3' AND SUBSTRING(ACODE_ICD9_1,5,1) != '1')
OR
(SUBSTRING(ACODE_ICD9_2,1,3) = '250' AND SUBSTRING(ACODE_ICD9_2,5,1) != '3' AND SUBSTRING(ACODE_ICD9_2,5,1) != '1')
OR
(SUBSTRING(ACODE_ICD9_3,1,3) = '250' AND SUBSTRING(ACODE_ICD9_3,5,1) != '3' AND SUBSTRING(ACODE_ICD9_3,5,1) != '1')
OR
substring(ACODE_ICD9_1,1,4) = 'A181' or substring(ACODE_ICD9_2,1,4) = 'A181' or substring(ACODE_ICD9_3,1,4) = 'A181')
and
(CASE_TYPE = '04' or CASE_TYPE = '06')
	union all
	SELECT ID, FUNC_DATE FROM HIGH_AGE_CD.DBO.CD2010
	WHERE 
not((SUBSTRING(ACODE_ICD9_1,1,3) = '250' AND SUBSTRING(ACODE_ICD9_1,5,1) != '3' AND SUBSTRING(ACODE_ICD9_1,5,1) != '1')
OR
(SUBSTRING(ACODE_ICD9_2,1,3) = '250' AND SUBSTRING(ACODE_ICD9_2,5,1) != '3' AND SUBSTRING(ACODE_ICD9_2,5,1) != '1')
OR
(SUBSTRING(ACODE_ICD9_3,1,3) = '250' AND SUBSTRING(ACODE_ICD9_3,5,1) != '3' AND SUBSTRING(ACODE_ICD9_3,5,1) != '1')
OR
substring(ACODE_ICD9_1,1,4) = 'A181' or substring(ACODE_ICD9_2,1,4) = 'A181' or substring(ACODE_ICD9_3,1,4) = 'A181')
and
(CASE_TYPE = '04' or CASE_TYPE = '06')
	union all
	SELECT ID, FUNC_DATE FROM HIGH_AGE_CD.DBO.CD2011
	WHERE 
not((SUBSTRING(ACODE_ICD9_1,1,3) = '250' AND SUBSTRING(ACODE_ICD9_1,5,1) != '3' AND SUBSTRING(ACODE_ICD9_1,5,1) != '1')
OR
(SUBSTRING(ACODE_ICD9_2,1,3) = '250' AND SUBSTRING(ACODE_ICD9_2,5,1) != '3' AND SUBSTRING(ACODE_ICD9_2,5,1) != '1')
OR
(SUBSTRING(ACODE_ICD9_3,1,3) = '250' AND SUBSTRING(ACODE_ICD9_3,5,1) != '3' AND SUBSTRING(ACODE_ICD9_3,5,1) != '1')
OR
substring(ACODE_ICD9_1,1,4) = 'A181' or substring(ACODE_ICD9_2,1,4) = 'A181' or substring(ACODE_ICD9_3,1,4) = 'A181')
and
(CASE_TYPE = '04' or CASE_TYPE = '06')
	union all
	SELECT ID, FUNC_DATE FROM HIGH_AGE_CD.DBO.CD2012
	WHERE 
not((SUBSTRING(ACODE_ICD9_1,1,3) = '250' AND SUBSTRING(ACODE_ICD9_1,5,1) != '3' AND SUBSTRING(ACODE_ICD9_1,5,1) != '1')
OR
(SUBSTRING(ACODE_ICD9_2,1,3) = '250' AND SUBSTRING(ACODE_ICD9_2,5,1) != '3' AND SUBSTRING(ACODE_ICD9_2,5,1) != '1')
OR
(SUBSTRING(ACODE_ICD9_3,1,3) = '250' AND SUBSTRING(ACODE_ICD9_3,5,1) != '3' AND SUBSTRING(ACODE_ICD9_3,5,1) != '1')
OR
substring(ACODE_ICD9_1,1,4) = 'A181' or substring(ACODE_ICD9_2,1,4) = 'A181' or substring(ACODE_ICD9_3,1,4) = 'A181')
and
(CASE_TYPE = '04' or CASE_TYPE = '06')
	union all
	SELECT ID, FUNC_DATE FROM HIGH_AGE_CD.DBO.CD2013
	WHERE 
not((SUBSTRING(ACODE_ICD9_1,1,3) = '250' AND SUBSTRING(ACODE_ICD9_1,5,1) != '3' AND SUBSTRING(ACODE_ICD9_1,5,1) != '1')
OR
(SUBSTRING(ACODE_ICD9_2,1,3) = '250' AND SUBSTRING(ACODE_ICD9_2,5,1) != '3' AND SUBSTRING(ACODE_ICD9_2,5,1) != '1')
OR
(SUBSTRING(ACODE_ICD9_3,1,3) = '250' AND SUBSTRING(ACODE_ICD9_3,5,1) != '3' AND SUBSTRING(ACODE_ICD9_3,5,1) != '1')
OR
substring(ACODE_ICD9_1,1,4) = 'A181' or substring(ACODE_ICD9_2,1,4) = 'A181' or substring(ACODE_ICD9_3,1,4) = 'A181')
and
(CASE_TYPE = '04' or CASE_TYPE = '06')
)

select distinct id into A.dbo.none_diabetes_cp from C

with E as(
select id, id_sex from A.dbo.diabetes_cp
where id in (select id from A.dbo.none_diabetes_cp) 
)
select E.id_sex, count(E.id_sex) from E
group by E.ID_SEX