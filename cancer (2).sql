--癌症--
WITH
CD AS(
select ID, FUNC_DATE from HIGH_AGE_CD.DBO.CD1996
where
--前三碼--
substring(ACODE_ICD9_1,1,3) in ('140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','179','180','181','182','183','184','185','186','187','188','189','190','191','192','193','194','195','196','197','198','199','200','201','202','203','204','205','206','207','208','A08', 'A16') or
substring(ACODE_ICD9_2,1,3) in ('140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','179','180','181','182','183','184','185','186','187','188','189','190','191','192','193','194','195','196','197','198','199','200','201','202','203','204','205','206','207','208','A08', 'A16') or
substring(ACODE_ICD9_3,1,3) in ('140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','179','180','181','182','183','184','185','186','187','188','189','190','191','192','193','194','195','196','197','198','199','200','201','202','203','204','205','206','207','208','A08', 'A16') or
--前四碼--
substring(ACODE_ICD9_1,1,4) in ('A090', 'A091', 'A094', 'A095', 'A096', 'A099', 'A100', 'A101', 'A109', 'A110', 'A111', 'A112', 'A113', 'A114', 'A115', 'A120', 'A121', 'A112', 'A123', 'A124', 'A125', 'A126', 'A129', 'A130', 'A139', 'A140', 'A141', 'A149') or
substring(ACODE_ICD9_2,1,4) in ('A090', 'A091', 'A094', 'A095', 'A096', 'A099', 'A100', 'A101', 'A109', 'A110', 'A111', 'A112', 'A113', 'A114', 'A115', 'A120', 'A121', 'A112', 'A123', 'A124', 'A125', 'A126', 'A129', 'A130', 'A139', 'A140', 'A141', 'A149') or
substring(ACODE_ICD9_3,1,4) in ('A090', 'A091', 'A094', 'A095', 'A096', 'A099', 'A100', 'A101', 'A109', 'A110', 'A111', 'A112', 'A113', 'A114', 'A115', 'A120', 'A121', 'A112', 'A123', 'A124', 'A125', 'A126', 'A129', 'A130', 'A139', 'A140', 'A141', 'A149')
union all
select ID, FUNC_DATE from HIGH_AGE_CD.DBO.CD1997
where
--前三碼--
substring(ACODE_ICD9_1,1,3) in ('140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','179','180','181','182','183','184','185','186','187','188','189','190','191','192','193','194','195','196','197','198','199','200','201','202','203','204','205','206','207','208','A08', 'A16') or
substring(ACODE_ICD9_2,1,3) in ('140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','179','180','181','182','183','184','185','186','187','188','189','190','191','192','193','194','195','196','197','198','199','200','201','202','203','204','205','206','207','208','A08', 'A16') or
substring(ACODE_ICD9_3,1,3) in ('140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','179','180','181','182','183','184','185','186','187','188','189','190','191','192','193','194','195','196','197','198','199','200','201','202','203','204','205','206','207','208','A08', 'A16') or
--前四碼--
substring(ACODE_ICD9_1,1,4) in ('A090', 'A091', 'A094', 'A095', 'A096', 'A099', 'A100', 'A101', 'A109', 'A110', 'A111', 'A112', 'A113', 'A114', 'A115', 'A120', 'A121', 'A112', 'A123', 'A124', 'A125', 'A126', 'A129', 'A130', 'A139', 'A140', 'A141', 'A149') or
substring(ACODE_ICD9_2,1,4) in ('A090', 'A091', 'A094', 'A095', 'A096', 'A099', 'A100', 'A101', 'A109', 'A110', 'A111', 'A112', 'A113', 'A114', 'A115', 'A120', 'A121', 'A112', 'A123', 'A124', 'A125', 'A126', 'A129', 'A130', 'A139', 'A140', 'A141', 'A149') or
substring(ACODE_ICD9_3,1,4) in ('A090', 'A091', 'A094', 'A095', 'A096', 'A099', 'A100', 'A101', 'A109', 'A110', 'A111', 'A112', 'A113', 'A114', 'A115', 'A120', 'A121', 'A112', 'A123', 'A124', 'A125', 'A126', 'A129', 'A130', 'A139', 'A140', 'A141', 'A149')
union all
select ID, FUNC_DATE from HIGH_AGE_CD.DBO.CD1997
where
--前三碼--
substring(ACODE_ICD9_1,1,3) in ('140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','179','180','181','182','183','184','185','186','187','188','189','190','191','192','193','194','195','196','197','198','199','200','201','202','203','204','205','206','207','208','A08', 'A16') or
substring(ACODE_ICD9_2,1,3) in ('140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','179','180','181','182','183','184','185','186','187','188','189','190','191','192','193','194','195','196','197','198','199','200','201','202','203','204','205','206','207','208','A08', 'A16') or
substring(ACODE_ICD9_3,1,3) in ('140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','179','180','181','182','183','184','185','186','187','188','189','190','191','192','193','194','195','196','197','198','199','200','201','202','203','204','205','206','207','208','A08', 'A16') or
--前四碼--
substring(ACODE_ICD9_1,1,4) in ('A090', 'A091', 'A094', 'A095', 'A096', 'A099', 'A100', 'A101', 'A109', 'A110', 'A111', 'A112', 'A113', 'A114', 'A115', 'A120', 'A121', 'A112', 'A123', 'A124', 'A125', 'A126', 'A129', 'A130', 'A139', 'A140', 'A141', 'A149') or
substring(ACODE_ICD9_2,1,4) in ('A090', 'A091', 'A094', 'A095', 'A096', 'A099', 'A100', 'A101', 'A109', 'A110', 'A111', 'A112', 'A113', 'A114', 'A115', 'A120', 'A121', 'A112', 'A123', 'A124', 'A125', 'A126', 'A129', 'A130', 'A139', 'A140', 'A141', 'A149') or
substring(ACODE_ICD9_3,1,4) in ('A090', 'A091', 'A094', 'A095', 'A096', 'A099', 'A100', 'A101', 'A109', 'A110', 'A111', 'A112', 'A113', 'A114', 'A115', 'A120', 'A121', 'A112', 'A123', 'A124', 'A125', 'A126', 'A129', 'A130', 'A139', 'A140', 'A141', 'A149')
union all
select ID, FUNC_DATE from HIGH_AGE_CD.DBO.CD1998
where
--前三碼--
substring(ACODE_ICD9_1,1,3) in ('140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','179','180','181','182','183','184','185','186','187','188','189','190','191','192','193','194','195','196','197','198','199','200','201','202','203','204','205','206','207','208','A08', 'A16') or
substring(ACODE_ICD9_2,1,3) in ('140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','179','180','181','182','183','184','185','186','187','188','189','190','191','192','193','194','195','196','197','198','199','200','201','202','203','204','205','206','207','208','A08', 'A16') or
substring(ACODE_ICD9_3,1,3) in ('140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','179','180','181','182','183','184','185','186','187','188','189','190','191','192','193','194','195','196','197','198','199','200','201','202','203','204','205','206','207','208','A08', 'A16') or
--前四碼--
substring(ACODE_ICD9_1,1,4) in ('A090', 'A091', 'A094', 'A095', 'A096', 'A099', 'A100', 'A101', 'A109', 'A110', 'A111', 'A112', 'A113', 'A114', 'A115', 'A120', 'A121', 'A112', 'A123', 'A124', 'A125', 'A126', 'A129', 'A130', 'A139', 'A140', 'A141', 'A149') or
substring(ACODE_ICD9_2,1,4) in ('A090', 'A091', 'A094', 'A095', 'A096', 'A099', 'A100', 'A101', 'A109', 'A110', 'A111', 'A112', 'A113', 'A114', 'A115', 'A120', 'A121', 'A112', 'A123', 'A124', 'A125', 'A126', 'A129', 'A130', 'A139', 'A140', 'A141', 'A149') or
substring(ACODE_ICD9_3,1,4) in ('A090', 'A091', 'A094', 'A095', 'A096', 'A099', 'A100', 'A101', 'A109', 'A110', 'A111', 'A112', 'A113', 'A114', 'A115', 'A120', 'A121', 'A112', 'A123', 'A124', 'A125', 'A126', 'A129', 'A130', 'A139', 'A140', 'A141', 'A149')
union all
select ID, FUNC_DATE from HIGH_AGE_CD.DBO.CD1999
where
--前三碼--
substring(ACODE_ICD9_1,1,3) in ('140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','179','180','181','182','183','184','185','186','187','188','189','190','191','192','193','194','195','196','197','198','199','200','201','202','203','204','205','206','207','208','A08', 'A16') or
substring(ACODE_ICD9_2,1,3) in ('140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','179','180','181','182','183','184','185','186','187','188','189','190','191','192','193','194','195','196','197','198','199','200','201','202','203','204','205','206','207','208','A08', 'A16') or
substring(ACODE_ICD9_3,1,3) in ('140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','179','180','181','182','183','184','185','186','187','188','189','190','191','192','193','194','195','196','197','198','199','200','201','202','203','204','205','206','207','208','A08', 'A16') or
--前四碼--
substring(ACODE_ICD9_1,1,4) in ('A090', 'A091', 'A094', 'A095', 'A096', 'A099', 'A100', 'A101', 'A109', 'A110', 'A111', 'A112', 'A113', 'A114', 'A115', 'A120', 'A121', 'A112', 'A123', 'A124', 'A125', 'A126', 'A129', 'A130', 'A139', 'A140', 'A141', 'A149') or
substring(ACODE_ICD9_2,1,4) in ('A090', 'A091', 'A094', 'A095', 'A096', 'A099', 'A100', 'A101', 'A109', 'A110', 'A111', 'A112', 'A113', 'A114', 'A115', 'A120', 'A121', 'A112', 'A123', 'A124', 'A125', 'A126', 'A129', 'A130', 'A139', 'A140', 'A141', 'A149') or
substring(ACODE_ICD9_3,1,4) in ('A090', 'A091', 'A094', 'A095', 'A096', 'A099', 'A100', 'A101', 'A109', 'A110', 'A111', 'A112', 'A113', 'A114', 'A115', 'A120', 'A121', 'A112', 'A123', 'A124', 'A125', 'A126', 'A129', 'A130', 'A139', 'A140', 'A141', 'A149')
union all
select ID, FUNC_DATE from HIGH_AGE_CD.DBO.CD2000
where
--前三碼--
substring(ACODE_ICD9_1,1,3) in ('140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','179','180','181','182','183','184','185','186','187','188','189','190','191','192','193','194','195','196','197','198','199','200','201','202','203','204','205','206','207','208','A08', 'A16') or
substring(ACODE_ICD9_2,1,3) in ('140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','179','180','181','182','183','184','185','186','187','188','189','190','191','192','193','194','195','196','197','198','199','200','201','202','203','204','205','206','207','208','A08', 'A16') or
substring(ACODE_ICD9_3,1,3) in ('140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','179','180','181','182','183','184','185','186','187','188','189','190','191','192','193','194','195','196','197','198','199','200','201','202','203','204','205','206','207','208','A08', 'A16') or
--前四碼--
substring(ACODE_ICD9_1,1,4) in ('A090', 'A091', 'A094', 'A095', 'A096', 'A099', 'A100', 'A101', 'A109', 'A110', 'A111', 'A112', 'A113', 'A114', 'A115', 'A120', 'A121', 'A112', 'A123', 'A124', 'A125', 'A126', 'A129', 'A130', 'A139', 'A140', 'A141', 'A149') or
substring(ACODE_ICD9_2,1,4) in ('A090', 'A091', 'A094', 'A095', 'A096', 'A099', 'A100', 'A101', 'A109', 'A110', 'A111', 'A112', 'A113', 'A114', 'A115', 'A120', 'A121', 'A112', 'A123', 'A124', 'A125', 'A126', 'A129', 'A130', 'A139', 'A140', 'A141', 'A149') or
substring(ACODE_ICD9_3,1,4) in ('A090', 'A091', 'A094', 'A095', 'A096', 'A099', 'A100', 'A101', 'A109', 'A110', 'A111', 'A112', 'A113', 'A114', 'A115', 'A120', 'A121', 'A112', 'A123', 'A124', 'A125', 'A126', 'A129', 'A130', 'A139', 'A140', 'A141', 'A149')
union all
select ID, FUNC_DATE from HIGH_AGE_CD.DBO.CD2001
where
--前三碼--
substring(ACODE_ICD9_1,1,3) in ('140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','179','180','181','182','183','184','185','186','187','188','189','190','191','192','193','194','195','196','197','198','199','200','201','202','203','204','205','206','207','208','A08', 'A16') or
substring(ACODE_ICD9_2,1,3) in ('140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','179','180','181','182','183','184','185','186','187','188','189','190','191','192','193','194','195','196','197','198','199','200','201','202','203','204','205','206','207','208','A08', 'A16') or
substring(ACODE_ICD9_3,1,3) in ('140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','179','180','181','182','183','184','185','186','187','188','189','190','191','192','193','194','195','196','197','198','199','200','201','202','203','204','205','206','207','208','A08', 'A16') or
--前四碼--
substring(ACODE_ICD9_1,1,4) in ('A090', 'A091', 'A094', 'A095', 'A096', 'A099', 'A100', 'A101', 'A109', 'A110', 'A111', 'A112', 'A113', 'A114', 'A115', 'A120', 'A121', 'A112', 'A123', 'A124', 'A125', 'A126', 'A129', 'A130', 'A139', 'A140', 'A141', 'A149') or
substring(ACODE_ICD9_2,1,4) in ('A090', 'A091', 'A094', 'A095', 'A096', 'A099', 'A100', 'A101', 'A109', 'A110', 'A111', 'A112', 'A113', 'A114', 'A115', 'A120', 'A121', 'A112', 'A123', 'A124', 'A125', 'A126', 'A129', 'A130', 'A139', 'A140', 'A141', 'A149') or
substring(ACODE_ICD9_3,1,4) in ('A090', 'A091', 'A094', 'A095', 'A096', 'A099', 'A100', 'A101', 'A109', 'A110', 'A111', 'A112', 'A113', 'A114', 'A115', 'A120', 'A121', 'A112', 'A123', 'A124', 'A125', 'A126', 'A129', 'A130', 'A139', 'A140', 'A141', 'A149')
union all
select ID, FUNC_DATE from HIGH_AGE_CD.DBO.CD2002
where
--前三碼--
substring(ACODE_ICD9_1,1,3) in ('140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','179','180','181','182','183','184','185','186','187','188','189','190','191','192','193','194','195','196','197','198','199','200','201','202','203','204','205','206','207','208','A08', 'A16') or
substring(ACODE_ICD9_2,1,3) in ('140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','179','180','181','182','183','184','185','186','187','188','189','190','191','192','193','194','195','196','197','198','199','200','201','202','203','204','205','206','207','208','A08', 'A16') or
substring(ACODE_ICD9_3,1,3) in ('140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','179','180','181','182','183','184','185','186','187','188','189','190','191','192','193','194','195','196','197','198','199','200','201','202','203','204','205','206','207','208','A08', 'A16') or
--前四碼--
substring(ACODE_ICD9_1,1,4) in ('A090', 'A091', 'A094', 'A095', 'A096', 'A099', 'A100', 'A101', 'A109', 'A110', 'A111', 'A112', 'A113', 'A114', 'A115', 'A120', 'A121', 'A112', 'A123', 'A124', 'A125', 'A126', 'A129', 'A130', 'A139', 'A140', 'A141', 'A149') or
substring(ACODE_ICD9_2,1,4) in ('A090', 'A091', 'A094', 'A095', 'A096', 'A099', 'A100', 'A101', 'A109', 'A110', 'A111', 'A112', 'A113', 'A114', 'A115', 'A120', 'A121', 'A112', 'A123', 'A124', 'A125', 'A126', 'A129', 'A130', 'A139', 'A140', 'A141', 'A149') or
substring(ACODE_ICD9_3,1,4) in ('A090', 'A091', 'A094', 'A095', 'A096', 'A099', 'A100', 'A101', 'A109', 'A110', 'A111', 'A112', 'A113', 'A114', 'A115', 'A120', 'A121', 'A112', 'A123', 'A124', 'A125', 'A126', 'A129', 'A130', 'A139', 'A140', 'A141', 'A149')
union all
select ID, FUNC_DATE from HIGH_AGE_CD.DBO.CD2003
where
--前三碼--
substring(ACODE_ICD9_1,1,3) in ('140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','179','180','181','182','183','184','185','186','187','188','189','190','191','192','193','194','195','196','197','198','199','200','201','202','203','204','205','206','207','208','A08', 'A16') or
substring(ACODE_ICD9_2,1,3) in ('140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','179','180','181','182','183','184','185','186','187','188','189','190','191','192','193','194','195','196','197','198','199','200','201','202','203','204','205','206','207','208','A08', 'A16') or
substring(ACODE_ICD9_3,1,3) in ('140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','179','180','181','182','183','184','185','186','187','188','189','190','191','192','193','194','195','196','197','198','199','200','201','202','203','204','205','206','207','208','A08', 'A16') or
--前四碼--
substring(ACODE_ICD9_1,1,4) in ('A090', 'A091', 'A094', 'A095', 'A096', 'A099', 'A100', 'A101', 'A109', 'A110', 'A111', 'A112', 'A113', 'A114', 'A115', 'A120', 'A121', 'A112', 'A123', 'A124', 'A125', 'A126', 'A129', 'A130', 'A139', 'A140', 'A141', 'A149') or
substring(ACODE_ICD9_2,1,4) in ('A090', 'A091', 'A094', 'A095', 'A096', 'A099', 'A100', 'A101', 'A109', 'A110', 'A111', 'A112', 'A113', 'A114', 'A115', 'A120', 'A121', 'A112', 'A123', 'A124', 'A125', 'A126', 'A129', 'A130', 'A139', 'A140', 'A141', 'A149') or
substring(ACODE_ICD9_3,1,4) in ('A090', 'A091', 'A094', 'A095', 'A096', 'A099', 'A100', 'A101', 'A109', 'A110', 'A111', 'A112', 'A113', 'A114', 'A115', 'A120', 'A121', 'A112', 'A123', 'A124', 'A125', 'A126', 'A129', 'A130', 'A139', 'A140', 'A141', 'A149')
union all
select ID, FUNC_DATE from HIGH_AGE_CD.DBO.CD2004
where
--前三碼--
substring(ACODE_ICD9_1,1,3) in ('140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','179','180','181','182','183','184','185','186','187','188','189','190','191','192','193','194','195','196','197','198','199','200','201','202','203','204','205','206','207','208','A08', 'A16') or
substring(ACODE_ICD9_2,1,3) in ('140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','179','180','181','182','183','184','185','186','187','188','189','190','191','192','193','194','195','196','197','198','199','200','201','202','203','204','205','206','207','208','A08', 'A16') or
substring(ACODE_ICD9_3,1,3) in ('140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','179','180','181','182','183','184','185','186','187','188','189','190','191','192','193','194','195','196','197','198','199','200','201','202','203','204','205','206','207','208','A08', 'A16') or
--前四碼--
substring(ACODE_ICD9_1,1,4) in ('A090', 'A091', 'A094', 'A095', 'A096', 'A099', 'A100', 'A101', 'A109', 'A110', 'A111', 'A112', 'A113', 'A114', 'A115', 'A120', 'A121', 'A112', 'A123', 'A124', 'A125', 'A126', 'A129', 'A130', 'A139', 'A140', 'A141', 'A149') or
substring(ACODE_ICD9_2,1,4) in ('A090', 'A091', 'A094', 'A095', 'A096', 'A099', 'A100', 'A101', 'A109', 'A110', 'A111', 'A112', 'A113', 'A114', 'A115', 'A120', 'A121', 'A112', 'A123', 'A124', 'A125', 'A126', 'A129', 'A130', 'A139', 'A140', 'A141', 'A149') or
substring(ACODE_ICD9_3,1,4) in ('A090', 'A091', 'A094', 'A095', 'A096', 'A099', 'A100', 'A101', 'A109', 'A110', 'A111', 'A112', 'A113', 'A114', 'A115', 'A120', 'A121', 'A112', 'A123', 'A124', 'A125', 'A126', 'A129', 'A130', 'A139', 'A140', 'A141', 'A149')
union all
select ID, FUNC_DATE from HIGH_AGE_CD.DBO.CD2005
where
--前三碼--
substring(ACODE_ICD9_1,1,3) in ('140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','179','180','181','182','183','184','185','186','187','188','189','190','191','192','193','194','195','196','197','198','199','200','201','202','203','204','205','206','207','208','A08', 'A16') or
substring(ACODE_ICD9_2,1,3) in ('140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','179','180','181','182','183','184','185','186','187','188','189','190','191','192','193','194','195','196','197','198','199','200','201','202','203','204','205','206','207','208','A08', 'A16') or
substring(ACODE_ICD9_3,1,3) in ('140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','179','180','181','182','183','184','185','186','187','188','189','190','191','192','193','194','195','196','197','198','199','200','201','202','203','204','205','206','207','208','A08', 'A16') or
--前四碼--
substring(ACODE_ICD9_1,1,4) in ('A090', 'A091', 'A094', 'A095', 'A096', 'A099', 'A100', 'A101', 'A109', 'A110', 'A111', 'A112', 'A113', 'A114', 'A115', 'A120', 'A121', 'A112', 'A123', 'A124', 'A125', 'A126', 'A129', 'A130', 'A139', 'A140', 'A141', 'A149') or
substring(ACODE_ICD9_2,1,4) in ('A090', 'A091', 'A094', 'A095', 'A096', 'A099', 'A100', 'A101', 'A109', 'A110', 'A111', 'A112', 'A113', 'A114', 'A115', 'A120', 'A121', 'A112', 'A123', 'A124', 'A125', 'A126', 'A129', 'A130', 'A139', 'A140', 'A141', 'A149') or
substring(ACODE_ICD9_3,1,4) in ('A090', 'A091', 'A094', 'A095', 'A096', 'A099', 'A100', 'A101', 'A109', 'A110', 'A111', 'A112', 'A113', 'A114', 'A115', 'A120', 'A121', 'A112', 'A123', 'A124', 'A125', 'A126', 'A129', 'A130', 'A139', 'A140', 'A141', 'A149')
union all
select ID, FUNC_DATE from HIGH_AGE_CD.DBO.CD2006
where
--前三碼--
substring(ACODE_ICD9_1,1,3) in ('140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','179','180','181','182','183','184','185','186','187','188','189','190','191','192','193','194','195','196','197','198','199','200','201','202','203','204','205','206','207','208','A08', 'A16') or
substring(ACODE_ICD9_2,1,3) in ('140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','179','180','181','182','183','184','185','186','187','188','189','190','191','192','193','194','195','196','197','198','199','200','201','202','203','204','205','206','207','208','A08', 'A16') or
substring(ACODE_ICD9_3,1,3) in ('140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','179','180','181','182','183','184','185','186','187','188','189','190','191','192','193','194','195','196','197','198','199','200','201','202','203','204','205','206','207','208','A08', 'A16') or
--前四碼--
substring(ACODE_ICD9_1,1,4) in ('A090', 'A091', 'A094', 'A095', 'A096', 'A099', 'A100', 'A101', 'A109', 'A110', 'A111', 'A112', 'A113', 'A114', 'A115', 'A120', 'A121', 'A112', 'A123', 'A124', 'A125', 'A126', 'A129', 'A130', 'A139', 'A140', 'A141', 'A149') or
substring(ACODE_ICD9_2,1,4) in ('A090', 'A091', 'A094', 'A095', 'A096', 'A099', 'A100', 'A101', 'A109', 'A110', 'A111', 'A112', 'A113', 'A114', 'A115', 'A120', 'A121', 'A112', 'A123', 'A124', 'A125', 'A126', 'A129', 'A130', 'A139', 'A140', 'A141', 'A149') or
substring(ACODE_ICD9_3,1,4) in ('A090', 'A091', 'A094', 'A095', 'A096', 'A099', 'A100', 'A101', 'A109', 'A110', 'A111', 'A112', 'A113', 'A114', 'A115', 'A120', 'A121', 'A112', 'A123', 'A124', 'A125', 'A126', 'A129', 'A130', 'A139', 'A140', 'A141', 'A149')
union all
select ID, FUNC_DATE from HIGH_AGE_CD.DBO.CD2007
where
--前三碼--
substring(ACODE_ICD9_1,1,3) in ('140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','179','180','181','182','183','184','185','186','187','188','189','190','191','192','193','194','195','196','197','198','199','200','201','202','203','204','205','206','207','208','A08', 'A16') or
substring(ACODE_ICD9_2,1,3) in ('140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','179','180','181','182','183','184','185','186','187','188','189','190','191','192','193','194','195','196','197','198','199','200','201','202','203','204','205','206','207','208','A08', 'A16') or
substring(ACODE_ICD9_3,1,3) in ('140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','179','180','181','182','183','184','185','186','187','188','189','190','191','192','193','194','195','196','197','198','199','200','201','202','203','204','205','206','207','208','A08', 'A16') or
--前四碼--
substring(ACODE_ICD9_1,1,4) in ('A090', 'A091', 'A094', 'A095', 'A096', 'A099', 'A100', 'A101', 'A109', 'A110', 'A111', 'A112', 'A113', 'A114', 'A115', 'A120', 'A121', 'A112', 'A123', 'A124', 'A125', 'A126', 'A129', 'A130', 'A139', 'A140', 'A141', 'A149') or
substring(ACODE_ICD9_2,1,4) in ('A090', 'A091', 'A094', 'A095', 'A096', 'A099', 'A100', 'A101', 'A109', 'A110', 'A111', 'A112', 'A113', 'A114', 'A115', 'A120', 'A121', 'A112', 'A123', 'A124', 'A125', 'A126', 'A129', 'A130', 'A139', 'A140', 'A141', 'A149') or
substring(ACODE_ICD9_3,1,4) in ('A090', 'A091', 'A094', 'A095', 'A096', 'A099', 'A100', 'A101', 'A109', 'A110', 'A111', 'A112', 'A113', 'A114', 'A115', 'A120', 'A121', 'A112', 'A123', 'A124', 'A125', 'A126', 'A129', 'A130', 'A139', 'A140', 'A141', 'A149')
union all
select ID, FUNC_DATE from HIGH_AGE_CD.DBO.CD2008
where
--前三碼--
substring(ACODE_ICD9_1,1,3) in ('140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','179','180','181','182','183','184','185','186','187','188','189','190','191','192','193','194','195','196','197','198','199','200','201','202','203','204','205','206','207','208','A08', 'A16') or
substring(ACODE_ICD9_2,1,3) in ('140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','179','180','181','182','183','184','185','186','187','188','189','190','191','192','193','194','195','196','197','198','199','200','201','202','203','204','205','206','207','208','A08', 'A16') or
substring(ACODE_ICD9_3,1,3) in ('140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','179','180','181','182','183','184','185','186','187','188','189','190','191','192','193','194','195','196','197','198','199','200','201','202','203','204','205','206','207','208','A08', 'A16') or
--前四碼--
substring(ACODE_ICD9_1,1,4) in ('A090', 'A091', 'A094', 'A095', 'A096', 'A099', 'A100', 'A101', 'A109', 'A110', 'A111', 'A112', 'A113', 'A114', 'A115', 'A120', 'A121', 'A112', 'A123', 'A124', 'A125', 'A126', 'A129', 'A130', 'A139', 'A140', 'A141', 'A149') or
substring(ACODE_ICD9_2,1,4) in ('A090', 'A091', 'A094', 'A095', 'A096', 'A099', 'A100', 'A101', 'A109', 'A110', 'A111', 'A112', 'A113', 'A114', 'A115', 'A120', 'A121', 'A112', 'A123', 'A124', 'A125', 'A126', 'A129', 'A130', 'A139', 'A140', 'A141', 'A149') or
substring(ACODE_ICD9_3,1,4) in ('A090', 'A091', 'A094', 'A095', 'A096', 'A099', 'A100', 'A101', 'A109', 'A110', 'A111', 'A112', 'A113', 'A114', 'A115', 'A120', 'A121', 'A112', 'A123', 'A124', 'A125', 'A126', 'A129', 'A130', 'A139', 'A140', 'A141', 'A149')
union all
select ID, FUNC_DATE from HIGH_AGE_CD.DBO.CD2009
where
--前三碼--
substring(ACODE_ICD9_1,1,3) in ('140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','179','180','181','182','183','184','185','186','187','188','189','190','191','192','193','194','195','196','197','198','199','200','201','202','203','204','205','206','207','208','A08', 'A16') or
substring(ACODE_ICD9_2,1,3) in ('140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','179','180','181','182','183','184','185','186','187','188','189','190','191','192','193','194','195','196','197','198','199','200','201','202','203','204','205','206','207','208','A08', 'A16') or
substring(ACODE_ICD9_3,1,3) in ('140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','179','180','181','182','183','184','185','186','187','188','189','190','191','192','193','194','195','196','197','198','199','200','201','202','203','204','205','206','207','208','A08', 'A16') or
--前四碼--
substring(ACODE_ICD9_1,1,4) in ('A090', 'A091', 'A094', 'A095', 'A096', 'A099', 'A100', 'A101', 'A109', 'A110', 'A111', 'A112', 'A113', 'A114', 'A115', 'A120', 'A121', 'A112', 'A123', 'A124', 'A125', 'A126', 'A129', 'A130', 'A139', 'A140', 'A141', 'A149') or
substring(ACODE_ICD9_2,1,4) in ('A090', 'A091', 'A094', 'A095', 'A096', 'A099', 'A100', 'A101', 'A109', 'A110', 'A111', 'A112', 'A113', 'A114', 'A115', 'A120', 'A121', 'A112', 'A123', 'A124', 'A125', 'A126', 'A129', 'A130', 'A139', 'A140', 'A141', 'A149') or
substring(ACODE_ICD9_3,1,4) in ('A090', 'A091', 'A094', 'A095', 'A096', 'A099', 'A100', 'A101', 'A109', 'A110', 'A111', 'A112', 'A113', 'A114', 'A115', 'A120', 'A121', 'A112', 'A123', 'A124', 'A125', 'A126', 'A129', 'A130', 'A139', 'A140', 'A141', 'A149')
union all
select ID, FUNC_DATE from HIGH_AGE_CD.DBO.CD2010
where
--前三碼--
substring(ACODE_ICD9_1,1,3) in ('140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','179','180','181','182','183','184','185','186','187','188','189','190','191','192','193','194','195','196','197','198','199','200','201','202','203','204','205','206','207','208','A08', 'A16') or
substring(ACODE_ICD9_2,1,3) in ('140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','179','180','181','182','183','184','185','186','187','188','189','190','191','192','193','194','195','196','197','198','199','200','201','202','203','204','205','206','207','208','A08', 'A16') or
substring(ACODE_ICD9_3,1,3) in ('140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','179','180','181','182','183','184','185','186','187','188','189','190','191','192','193','194','195','196','197','198','199','200','201','202','203','204','205','206','207','208','A08', 'A16') or
--前四碼--
substring(ACODE_ICD9_1,1,4) in ('A090', 'A091', 'A094', 'A095', 'A096', 'A099', 'A100', 'A101', 'A109', 'A110', 'A111', 'A112', 'A113', 'A114', 'A115', 'A120', 'A121', 'A112', 'A123', 'A124', 'A125', 'A126', 'A129', 'A130', 'A139', 'A140', 'A141', 'A149') or
substring(ACODE_ICD9_2,1,4) in ('A090', 'A091', 'A094', 'A095', 'A096', 'A099', 'A100', 'A101', 'A109', 'A110', 'A111', 'A112', 'A113', 'A114', 'A115', 'A120', 'A121', 'A112', 'A123', 'A124', 'A125', 'A126', 'A129', 'A130', 'A139', 'A140', 'A141', 'A149') or
substring(ACODE_ICD9_3,1,4) in ('A090', 'A091', 'A094', 'A095', 'A096', 'A099', 'A100', 'A101', 'A109', 'A110', 'A111', 'A112', 'A113', 'A114', 'A115', 'A120', 'A121', 'A112', 'A123', 'A124', 'A125', 'A126', 'A129', 'A130', 'A139', 'A140', 'A141', 'A149')
union all
select ID, FUNC_DATE from HIGH_AGE_CD.DBO.CD2011
where
--前三碼--
substring(ACODE_ICD9_1,1,3) in ('140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','179','180','181','182','183','184','185','186','187','188','189','190','191','192','193','194','195','196','197','198','199','200','201','202','203','204','205','206','207','208','A08', 'A16') or
substring(ACODE_ICD9_2,1,3) in ('140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','179','180','181','182','183','184','185','186','187','188','189','190','191','192','193','194','195','196','197','198','199','200','201','202','203','204','205','206','207','208','A08', 'A16') or
substring(ACODE_ICD9_3,1,3) in ('140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','179','180','181','182','183','184','185','186','187','188','189','190','191','192','193','194','195','196','197','198','199','200','201','202','203','204','205','206','207','208','A08', 'A16') or
--前四碼--
substring(ACODE_ICD9_1,1,4) in ('A090', 'A091', 'A094', 'A095', 'A096', 'A099', 'A100', 'A101', 'A109', 'A110', 'A111', 'A112', 'A113', 'A114', 'A115', 'A120', 'A121', 'A112', 'A123', 'A124', 'A125', 'A126', 'A129', 'A130', 'A139', 'A140', 'A141', 'A149') or
substring(ACODE_ICD9_2,1,4) in ('A090', 'A091', 'A094', 'A095', 'A096', 'A099', 'A100', 'A101', 'A109', 'A110', 'A111', 'A112', 'A113', 'A114', 'A115', 'A120', 'A121', 'A112', 'A123', 'A124', 'A125', 'A126', 'A129', 'A130', 'A139', 'A140', 'A141', 'A149') or
substring(ACODE_ICD9_3,1,4) in ('A090', 'A091', 'A094', 'A095', 'A096', 'A099', 'A100', 'A101', 'A109', 'A110', 'A111', 'A112', 'A113', 'A114', 'A115', 'A120', 'A121', 'A112', 'A123', 'A124', 'A125', 'A126', 'A129', 'A130', 'A139', 'A140', 'A141', 'A149')
union all
select ID, FUNC_DATE from HIGH_AGE_CD.DBO.CD2012
where
--前三碼--
substring(ACODE_ICD9_1,1,3) in ('140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','179','180','181','182','183','184','185','186','187','188','189','190','191','192','193','194','195','196','197','198','199','200','201','202','203','204','205','206','207','208','A08', 'A16') or
substring(ACODE_ICD9_2,1,3) in ('140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','179','180','181','182','183','184','185','186','187','188','189','190','191','192','193','194','195','196','197','198','199','200','201','202','203','204','205','206','207','208','A08', 'A16') or
substring(ACODE_ICD9_3,1,3) in ('140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','179','180','181','182','183','184','185','186','187','188','189','190','191','192','193','194','195','196','197','198','199','200','201','202','203','204','205','206','207','208','A08', 'A16') or
--前四碼--
substring(ACODE_ICD9_1,1,4) in ('A090', 'A091', 'A094', 'A095', 'A096', 'A099', 'A100', 'A101', 'A109', 'A110', 'A111', 'A112', 'A113', 'A114', 'A115', 'A120', 'A121', 'A112', 'A123', 'A124', 'A125', 'A126', 'A129', 'A130', 'A139', 'A140', 'A141', 'A149') or
substring(ACODE_ICD9_2,1,4) in ('A090', 'A091', 'A094', 'A095', 'A096', 'A099', 'A100', 'A101', 'A109', 'A110', 'A111', 'A112', 'A113', 'A114', 'A115', 'A120', 'A121', 'A112', 'A123', 'A124', 'A125', 'A126', 'A129', 'A130', 'A139', 'A140', 'A141', 'A149') or
substring(ACODE_ICD9_3,1,4) in ('A090', 'A091', 'A094', 'A095', 'A096', 'A099', 'A100', 'A101', 'A109', 'A110', 'A111', 'A112', 'A113', 'A114', 'A115', 'A120', 'A121', 'A112', 'A123', 'A124', 'A125', 'A126', 'A129', 'A130', 'A139', 'A140', 'A141', 'A149')
union all
select ID, FUNC_DATE from HIGH_AGE_CD.DBO.CD2013
where
--前三碼--
substring(ACODE_ICD9_1,1,3) in ('140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','179','180','181','182','183','184','185','186','187','188','189','190','191','192','193','194','195','196','197','198','199','200','201','202','203','204','205','206','207','208','A08', 'A16') or
substring(ACODE_ICD9_2,1,3) in ('140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','179','180','181','182','183','184','185','186','187','188','189','190','191','192','193','194','195','196','197','198','199','200','201','202','203','204','205','206','207','208','A08', 'A16') or
substring(ACODE_ICD9_3,1,3) in ('140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','179','180','181','182','183','184','185','186','187','188','189','190','191','192','193','194','195','196','197','198','199','200','201','202','203','204','205','206','207','208','A08', 'A16') or
--前四碼--
substring(ACODE_ICD9_1,1,4) in ('A090', 'A091', 'A094', 'A095', 'A096', 'A099', 'A100', 'A101', 'A109', 'A110', 'A111', 'A112', 'A113', 'A114', 'A115', 'A120', 'A121', 'A112', 'A123', 'A124', 'A125', 'A126', 'A129', 'A130', 'A139', 'A140', 'A141', 'A149') or
substring(ACODE_ICD9_2,1,4) in ('A090', 'A091', 'A094', 'A095', 'A096', 'A099', 'A100', 'A101', 'A109', 'A110', 'A111', 'A112', 'A113', 'A114', 'A115', 'A120', 'A121', 'A112', 'A123', 'A124', 'A125', 'A126', 'A129', 'A130', 'A139', 'A140', 'A141', 'A149') or
substring(ACODE_ICD9_3,1,4) in ('A090', 'A091', 'A094', 'A095', 'A096', 'A099', 'A100', 'A101', 'A109', 'A110', 'A111', 'A112', 'A113', 'A114', 'A115', 'A120', 'A121', 'A112', 'A123', 'A124', 'A125', 'A126', 'A129', 'A130', 'A139', 'A140', 'A141', 'A149')
),
DD as(
select ID, IN_DATE as FUNC_DATE from HIGH_AGE_DD.DBO.DD1996
where
--前三碼--
substring(ICD9CM_CODE,1,3) in ('140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','179','180','181','182','183','184','185','186','187','188','189','190','191','192','193','194','195','196','197','198','199','200','201','202','203','204','205','206','207','208','A08', 'A16') or
substring(ICD9CM_CODE_1,1,3) in ('140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','179','180','181','182','183','184','185','186','187','188','189','190','191','192','193','194','195','196','197','198','199','200','201','202','203','204','205','206','207','208','A08', 'A16') or
substring(ICD9CM_CODE_2,1,3) in ('140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','179','180','181','182','183','184','185','186','187','188','189','190','191','192','193','194','195','196','197','198','199','200','201','202','203','204','205','206','207','208','A08', 'A16') or
substring(ICD9CM_CODE_3,1,3) in ('140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','179','180','181','182','183','184','185','186','187','188','189','190','191','192','193','194','195','196','197','198','199','200','201','202','203','204','205','206','207','208','A08', 'A16') or
substring(ICD9CM_CODE_4,1,3) in ('140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','179','180','181','182','183','184','185','186','187','188','189','190','191','192','193','194','195','196','197','198','199','200','201','202','203','204','205','206','207','208','A08', 'A16') or
--前四碼--
substring(ICD9CM_CODE,1,4) in ('A090', 'A091', 'A094', 'A095', 'A096', 'A099', 'A100', 'A101', 'A109', 'A110', 'A111', 'A112', 'A113', 'A114', 'A115', 'A120', 'A121', 'A112', 'A123', 'A124', 'A125', 'A126', 'A129', 'A130', 'A139', 'A140', 'A141', 'A149') or
substring(ICD9CM_CODE_1,1,4) in ('A090', 'A091', 'A094', 'A095', 'A096', 'A099', 'A100', 'A101', 'A109', 'A110', 'A111', 'A112', 'A113', 'A114', 'A115', 'A120', 'A121', 'A112', 'A123', 'A124', 'A125', 'A126', 'A129', 'A130', 'A139', 'A140', 'A141', 'A149') or
substring(ICD9CM_CODE_2,1,4) in ('A090', 'A091', 'A094', 'A095', 'A096', 'A099', 'A100', 'A101', 'A109', 'A110', 'A111', 'A112', 'A113', 'A114', 'A115', 'A120', 'A121', 'A112', 'A123', 'A124', 'A125', 'A126', 'A129', 'A130', 'A139', 'A140', 'A141', 'A149') or
substring(ICD9CM_CODE_3,1,4) in ('A090', 'A091', 'A094', 'A095', 'A096', 'A099', 'A100', 'A101', 'A109', 'A110', 'A111', 'A112', 'A113', 'A114', 'A115', 'A120', 'A121', 'A112', 'A123', 'A124', 'A125', 'A126', 'A129', 'A130', 'A139', 'A140', 'A141', 'A149') or
substring(ICD9CM_CODE_4,1,4) in ('A090', 'A091', 'A094', 'A095', 'A096', 'A099', 'A100', 'A101', 'A109', 'A110', 'A111', 'A112', 'A113', 'A114', 'A115', 'A120', 'A121', 'A112', 'A123', 'A124', 'A125', 'A126', 'A129', 'A130', 'A139', 'A140', 'A141', 'A149')
union all
select ID, IN_DATE as FUNC_DATE from HIGH_AGE_DD.DBO.DD1997
where
--前三碼--
substring(ICD9CM_CODE,1,3) in ('140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','179','180','181','182','183','184','185','186','187','188','189','190','191','192','193','194','195','196','197','198','199','200','201','202','203','204','205','206','207','208','A08', 'A16') or
substring(ICD9CM_CODE_1,1,3) in ('140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','179','180','181','182','183','184','185','186','187','188','189','190','191','192','193','194','195','196','197','198','199','200','201','202','203','204','205','206','207','208','A08', 'A16') or
substring(ICD9CM_CODE_2,1,3) in ('140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','179','180','181','182','183','184','185','186','187','188','189','190','191','192','193','194','195','196','197','198','199','200','201','202','203','204','205','206','207','208','A08', 'A16') or
substring(ICD9CM_CODE_3,1,3) in ('140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','179','180','181','182','183','184','185','186','187','188','189','190','191','192','193','194','195','196','197','198','199','200','201','202','203','204','205','206','207','208','A08', 'A16') or
substring(ICD9CM_CODE_4,1,3) in ('140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','179','180','181','182','183','184','185','186','187','188','189','190','191','192','193','194','195','196','197','198','199','200','201','202','203','204','205','206','207','208','A08', 'A16') or
--前四碼--
substring(ICD9CM_CODE,1,4) in ('A090', 'A091', 'A094', 'A095', 'A096', 'A099', 'A100', 'A101', 'A109', 'A110', 'A111', 'A112', 'A113', 'A114', 'A115', 'A120', 'A121', 'A112', 'A123', 'A124', 'A125', 'A126', 'A129', 'A130', 'A139', 'A140', 'A141', 'A149') or
substring(ICD9CM_CODE_1,1,4) in ('A090', 'A091', 'A094', 'A095', 'A096', 'A099', 'A100', 'A101', 'A109', 'A110', 'A111', 'A112', 'A113', 'A114', 'A115', 'A120', 'A121', 'A112', 'A123', 'A124', 'A125', 'A126', 'A129', 'A130', 'A139', 'A140', 'A141', 'A149') or
substring(ICD9CM_CODE_2,1,4) in ('A090', 'A091', 'A094', 'A095', 'A096', 'A099', 'A100', 'A101', 'A109', 'A110', 'A111', 'A112', 'A113', 'A114', 'A115', 'A120', 'A121', 'A112', 'A123', 'A124', 'A125', 'A126', 'A129', 'A130', 'A139', 'A140', 'A141', 'A149') or
substring(ICD9CM_CODE_3,1,4) in ('A090', 'A091', 'A094', 'A095', 'A096', 'A099', 'A100', 'A101', 'A109', 'A110', 'A111', 'A112', 'A113', 'A114', 'A115', 'A120', 'A121', 'A112', 'A123', 'A124', 'A125', 'A126', 'A129', 'A130', 'A139', 'A140', 'A141', 'A149') or
substring(ICD9CM_CODE_4,1,4) in ('A090', 'A091', 'A094', 'A095', 'A096', 'A099', 'A100', 'A101', 'A109', 'A110', 'A111', 'A112', 'A113', 'A114', 'A115', 'A120', 'A121', 'A112', 'A123', 'A124', 'A125', 'A126', 'A129', 'A130', 'A139', 'A140', 'A141', 'A149')
union all
select ID, IN_DATE as FUNC_DATE from HIGH_AGE_DD.DBO.DD1998
where
--前三碼--
substring(ICD9CM_CODE,1,3) in ('140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','179','180','181','182','183','184','185','186','187','188','189','190','191','192','193','194','195','196','197','198','199','200','201','202','203','204','205','206','207','208','A08', 'A16') or
substring(ICD9CM_CODE_1,1,3) in ('140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','179','180','181','182','183','184','185','186','187','188','189','190','191','192','193','194','195','196','197','198','199','200','201','202','203','204','205','206','207','208','A08', 'A16') or
substring(ICD9CM_CODE_2,1,3) in ('140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','179','180','181','182','183','184','185','186','187','188','189','190','191','192','193','194','195','196','197','198','199','200','201','202','203','204','205','206','207','208','A08', 'A16') or
substring(ICD9CM_CODE_3,1,3) in ('140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','179','180','181','182','183','184','185','186','187','188','189','190','191','192','193','194','195','196','197','198','199','200','201','202','203','204','205','206','207','208','A08', 'A16') or
substring(ICD9CM_CODE_4,1,3) in ('140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','179','180','181','182','183','184','185','186','187','188','189','190','191','192','193','194','195','196','197','198','199','200','201','202','203','204','205','206','207','208','A08', 'A16') or
--前四碼--
substring(ICD9CM_CODE,1,4) in ('A090', 'A091', 'A094', 'A095', 'A096', 'A099', 'A100', 'A101', 'A109', 'A110', 'A111', 'A112', 'A113', 'A114', 'A115', 'A120', 'A121', 'A112', 'A123', 'A124', 'A125', 'A126', 'A129', 'A130', 'A139', 'A140', 'A141', 'A149') or
substring(ICD9CM_CODE_1,1,4) in ('A090', 'A091', 'A094', 'A095', 'A096', 'A099', 'A100', 'A101', 'A109', 'A110', 'A111', 'A112', 'A113', 'A114', 'A115', 'A120', 'A121', 'A112', 'A123', 'A124', 'A125', 'A126', 'A129', 'A130', 'A139', 'A140', 'A141', 'A149') or
substring(ICD9CM_CODE_2,1,4) in ('A090', 'A091', 'A094', 'A095', 'A096', 'A099', 'A100', 'A101', 'A109', 'A110', 'A111', 'A112', 'A113', 'A114', 'A115', 'A120', 'A121', 'A112', 'A123', 'A124', 'A125', 'A126', 'A129', 'A130', 'A139', 'A140', 'A141', 'A149') or
substring(ICD9CM_CODE_3,1,4) in ('A090', 'A091', 'A094', 'A095', 'A096', 'A099', 'A100', 'A101', 'A109', 'A110', 'A111', 'A112', 'A113', 'A114', 'A115', 'A120', 'A121', 'A112', 'A123', 'A124', 'A125', 'A126', 'A129', 'A130', 'A139', 'A140', 'A141', 'A149') or
substring(ICD9CM_CODE_4,1,4) in ('A090', 'A091', 'A094', 'A095', 'A096', 'A099', 'A100', 'A101', 'A109', 'A110', 'A111', 'A112', 'A113', 'A114', 'A115', 'A120', 'A121', 'A112', 'A123', 'A124', 'A125', 'A126', 'A129', 'A130', 'A139', 'A140', 'A141', 'A149')
union all
select ID, IN_DATE as FUNC_DATE from HIGH_AGE_DD.DBO.DD1999
where
--前三碼--
substring(ICD9CM_CODE,1,3) in ('140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','179','180','181','182','183','184','185','186','187','188','189','190','191','192','193','194','195','196','197','198','199','200','201','202','203','204','205','206','207','208','A08', 'A16') or
substring(ICD9CM_CODE_1,1,3) in ('140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','179','180','181','182','183','184','185','186','187','188','189','190','191','192','193','194','195','196','197','198','199','200','201','202','203','204','205','206','207','208','A08', 'A16') or
substring(ICD9CM_CODE_2,1,3) in ('140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','179','180','181','182','183','184','185','186','187','188','189','190','191','192','193','194','195','196','197','198','199','200','201','202','203','204','205','206','207','208','A08', 'A16') or
substring(ICD9CM_CODE_3,1,3) in ('140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','179','180','181','182','183','184','185','186','187','188','189','190','191','192','193','194','195','196','197','198','199','200','201','202','203','204','205','206','207','208','A08', 'A16') or
substring(ICD9CM_CODE_4,1,3) in ('140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','179','180','181','182','183','184','185','186','187','188','189','190','191','192','193','194','195','196','197','198','199','200','201','202','203','204','205','206','207','208','A08', 'A16') or
--前四碼--
substring(ICD9CM_CODE,1,4) in ('A090', 'A091', 'A094', 'A095', 'A096', 'A099', 'A100', 'A101', 'A109', 'A110', 'A111', 'A112', 'A113', 'A114', 'A115', 'A120', 'A121', 'A112', 'A123', 'A124', 'A125', 'A126', 'A129', 'A130', 'A139', 'A140', 'A141', 'A149') or
substring(ICD9CM_CODE_1,1,4) in ('A090', 'A091', 'A094', 'A095', 'A096', 'A099', 'A100', 'A101', 'A109', 'A110', 'A111', 'A112', 'A113', 'A114', 'A115', 'A120', 'A121', 'A112', 'A123', 'A124', 'A125', 'A126', 'A129', 'A130', 'A139', 'A140', 'A141', 'A149') or
substring(ICD9CM_CODE_2,1,4) in ('A090', 'A091', 'A094', 'A095', 'A096', 'A099', 'A100', 'A101', 'A109', 'A110', 'A111', 'A112', 'A113', 'A114', 'A115', 'A120', 'A121', 'A112', 'A123', 'A124', 'A125', 'A126', 'A129', 'A130', 'A139', 'A140', 'A141', 'A149') or
substring(ICD9CM_CODE_3,1,4) in ('A090', 'A091', 'A094', 'A095', 'A096', 'A099', 'A100', 'A101', 'A109', 'A110', 'A111', 'A112', 'A113', 'A114', 'A115', 'A120', 'A121', 'A112', 'A123', 'A124', 'A125', 'A126', 'A129', 'A130', 'A139', 'A140', 'A141', 'A149') or
substring(ICD9CM_CODE_4,1,4) in ('A090', 'A091', 'A094', 'A095', 'A096', 'A099', 'A100', 'A101', 'A109', 'A110', 'A111', 'A112', 'A113', 'A114', 'A115', 'A120', 'A121', 'A112', 'A123', 'A124', 'A125', 'A126', 'A129', 'A130', 'A139', 'A140', 'A141', 'A149')
union all
select ID, IN_DATE as FUNC_DATE from HIGH_AGE_DD.DBO.DD2000
where
--前三碼--
substring(ICD9CM_CODE,1,3) in ('140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','179','180','181','182','183','184','185','186','187','188','189','190','191','192','193','194','195','196','197','198','199','200','201','202','203','204','205','206','207','208','A08', 'A16') or
substring(ICD9CM_CODE_1,1,3) in ('140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','179','180','181','182','183','184','185','186','187','188','189','190','191','192','193','194','195','196','197','198','199','200','201','202','203','204','205','206','207','208','A08', 'A16') or
substring(ICD9CM_CODE_2,1,3) in ('140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','179','180','181','182','183','184','185','186','187','188','189','190','191','192','193','194','195','196','197','198','199','200','201','202','203','204','205','206','207','208','A08', 'A16') or
substring(ICD9CM_CODE_3,1,3) in ('140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','179','180','181','182','183','184','185','186','187','188','189','190','191','192','193','194','195','196','197','198','199','200','201','202','203','204','205','206','207','208','A08', 'A16') or
substring(ICD9CM_CODE_4,1,3) in ('140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','179','180','181','182','183','184','185','186','187','188','189','190','191','192','193','194','195','196','197','198','199','200','201','202','203','204','205','206','207','208','A08', 'A16') or
--前四碼--
substring(ICD9CM_CODE,1,4) in ('A090', 'A091', 'A094', 'A095', 'A096', 'A099', 'A100', 'A101', 'A109', 'A110', 'A111', 'A112', 'A113', 'A114', 'A115', 'A120', 'A121', 'A112', 'A123', 'A124', 'A125', 'A126', 'A129', 'A130', 'A139', 'A140', 'A141', 'A149') or
substring(ICD9CM_CODE_1,1,4) in ('A090', 'A091', 'A094', 'A095', 'A096', 'A099', 'A100', 'A101', 'A109', 'A110', 'A111', 'A112', 'A113', 'A114', 'A115', 'A120', 'A121', 'A112', 'A123', 'A124', 'A125', 'A126', 'A129', 'A130', 'A139', 'A140', 'A141', 'A149') or
substring(ICD9CM_CODE_2,1,4) in ('A090', 'A091', 'A094', 'A095', 'A096', 'A099', 'A100', 'A101', 'A109', 'A110', 'A111', 'A112', 'A113', 'A114', 'A115', 'A120', 'A121', 'A112', 'A123', 'A124', 'A125', 'A126', 'A129', 'A130', 'A139', 'A140', 'A141', 'A149') or
substring(ICD9CM_CODE_3,1,4) in ('A090', 'A091', 'A094', 'A095', 'A096', 'A099', 'A100', 'A101', 'A109', 'A110', 'A111', 'A112', 'A113', 'A114', 'A115', 'A120', 'A121', 'A112', 'A123', 'A124', 'A125', 'A126', 'A129', 'A130', 'A139', 'A140', 'A141', 'A149') or
substring(ICD9CM_CODE_4,1,4) in ('A090', 'A091', 'A094', 'A095', 'A096', 'A099', 'A100', 'A101', 'A109', 'A110', 'A111', 'A112', 'A113', 'A114', 'A115', 'A120', 'A121', 'A112', 'A123', 'A124', 'A125', 'A126', 'A129', 'A130', 'A139', 'A140', 'A141', 'A149')
union all
select ID, IN_DATE as FUNC_DATE from HIGH_AGE_DD.DBO.DD2001
where
--前三碼--
substring(ICD9CM_CODE,1,3) in ('140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','179','180','181','182','183','184','185','186','187','188','189','190','191','192','193','194','195','196','197','198','199','200','201','202','203','204','205','206','207','208','A08', 'A16') or
substring(ICD9CM_CODE_1,1,3) in ('140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','179','180','181','182','183','184','185','186','187','188','189','190','191','192','193','194','195','196','197','198','199','200','201','202','203','204','205','206','207','208','A08', 'A16') or
substring(ICD9CM_CODE_2,1,3) in ('140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','179','180','181','182','183','184','185','186','187','188','189','190','191','192','193','194','195','196','197','198','199','200','201','202','203','204','205','206','207','208','A08', 'A16') or
substring(ICD9CM_CODE_3,1,3) in ('140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','179','180','181','182','183','184','185','186','187','188','189','190','191','192','193','194','195','196','197','198','199','200','201','202','203','204','205','206','207','208','A08', 'A16') or
substring(ICD9CM_CODE_4,1,3) in ('140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','179','180','181','182','183','184','185','186','187','188','189','190','191','192','193','194','195','196','197','198','199','200','201','202','203','204','205','206','207','208','A08', 'A16') or
--前四碼--
substring(ICD9CM_CODE,1,4) in ('A090', 'A091', 'A094', 'A095', 'A096', 'A099', 'A100', 'A101', 'A109', 'A110', 'A111', 'A112', 'A113', 'A114', 'A115', 'A120', 'A121', 'A112', 'A123', 'A124', 'A125', 'A126', 'A129', 'A130', 'A139', 'A140', 'A141', 'A149') or
substring(ICD9CM_CODE_1,1,4) in ('A090', 'A091', 'A094', 'A095', 'A096', 'A099', 'A100', 'A101', 'A109', 'A110', 'A111', 'A112', 'A113', 'A114', 'A115', 'A120', 'A121', 'A112', 'A123', 'A124', 'A125', 'A126', 'A129', 'A130', 'A139', 'A140', 'A141', 'A149') or
substring(ICD9CM_CODE_2,1,4) in ('A090', 'A091', 'A094', 'A095', 'A096', 'A099', 'A100', 'A101', 'A109', 'A110', 'A111', 'A112', 'A113', 'A114', 'A115', 'A120', 'A121', 'A112', 'A123', 'A124', 'A125', 'A126', 'A129', 'A130', 'A139', 'A140', 'A141', 'A149') or
substring(ICD9CM_CODE_3,1,4) in ('A090', 'A091', 'A094', 'A095', 'A096', 'A099', 'A100', 'A101', 'A109', 'A110', 'A111', 'A112', 'A113', 'A114', 'A115', 'A120', 'A121', 'A112', 'A123', 'A124', 'A125', 'A126', 'A129', 'A130', 'A139', 'A140', 'A141', 'A149') or
substring(ICD9CM_CODE_4,1,4) in ('A090', 'A091', 'A094', 'A095', 'A096', 'A099', 'A100', 'A101', 'A109', 'A110', 'A111', 'A112', 'A113', 'A114', 'A115', 'A120', 'A121', 'A112', 'A123', 'A124', 'A125', 'A126', 'A129', 'A130', 'A139', 'A140', 'A141', 'A149')
union all
select ID, IN_DATE as FUNC_DATE from HIGH_AGE_DD.DBO.DD2002
where
--前三碼--
substring(ICD9CM_CODE,1,3) in ('140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','179','180','181','182','183','184','185','186','187','188','189','190','191','192','193','194','195','196','197','198','199','200','201','202','203','204','205','206','207','208','A08', 'A16') or
substring(ICD9CM_CODE_1,1,3) in ('140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','179','180','181','182','183','184','185','186','187','188','189','190','191','192','193','194','195','196','197','198','199','200','201','202','203','204','205','206','207','208','A08', 'A16') or
substring(ICD9CM_CODE_2,1,3) in ('140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','179','180','181','182','183','184','185','186','187','188','189','190','191','192','193','194','195','196','197','198','199','200','201','202','203','204','205','206','207','208','A08', 'A16') or
substring(ICD9CM_CODE_3,1,3) in ('140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','179','180','181','182','183','184','185','186','187','188','189','190','191','192','193','194','195','196','197','198','199','200','201','202','203','204','205','206','207','208','A08', 'A16') or
substring(ICD9CM_CODE_4,1,3) in ('140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','179','180','181','182','183','184','185','186','187','188','189','190','191','192','193','194','195','196','197','198','199','200','201','202','203','204','205','206','207','208','A08', 'A16') or
--前四碼--
substring(ICD9CM_CODE,1,4) in ('A090', 'A091', 'A094', 'A095', 'A096', 'A099', 'A100', 'A101', 'A109', 'A110', 'A111', 'A112', 'A113', 'A114', 'A115', 'A120', 'A121', 'A112', 'A123', 'A124', 'A125', 'A126', 'A129', 'A130', 'A139', 'A140', 'A141', 'A149') or
substring(ICD9CM_CODE_1,1,4) in ('A090', 'A091', 'A094', 'A095', 'A096', 'A099', 'A100', 'A101', 'A109', 'A110', 'A111', 'A112', 'A113', 'A114', 'A115', 'A120', 'A121', 'A112', 'A123', 'A124', 'A125', 'A126', 'A129', 'A130', 'A139', 'A140', 'A141', 'A149') or
substring(ICD9CM_CODE_2,1,4) in ('A090', 'A091', 'A094', 'A095', 'A096', 'A099', 'A100', 'A101', 'A109', 'A110', 'A111', 'A112', 'A113', 'A114', 'A115', 'A120', 'A121', 'A112', 'A123', 'A124', 'A125', 'A126', 'A129', 'A130', 'A139', 'A140', 'A141', 'A149') or
substring(ICD9CM_CODE_3,1,4) in ('A090', 'A091', 'A094', 'A095', 'A096', 'A099', 'A100', 'A101', 'A109', 'A110', 'A111', 'A112', 'A113', 'A114', 'A115', 'A120', 'A121', 'A112', 'A123', 'A124', 'A125', 'A126', 'A129', 'A130', 'A139', 'A140', 'A141', 'A149') or
substring(ICD9CM_CODE_4,1,4) in ('A090', 'A091', 'A094', 'A095', 'A096', 'A099', 'A100', 'A101', 'A109', 'A110', 'A111', 'A112', 'A113', 'A114', 'A115', 'A120', 'A121', 'A112', 'A123', 'A124', 'A125', 'A126', 'A129', 'A130', 'A139', 'A140', 'A141', 'A149')
union all
select ID, IN_DATE as FUNC_DATE from HIGH_AGE_DD.DBO.DD2003
where
--前三碼--
substring(ICD9CM_CODE,1,3) in ('140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','179','180','181','182','183','184','185','186','187','188','189','190','191','192','193','194','195','196','197','198','199','200','201','202','203','204','205','206','207','208','A08', 'A16') or
substring(ICD9CM_CODE_1,1,3) in ('140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','179','180','181','182','183','184','185','186','187','188','189','190','191','192','193','194','195','196','197','198','199','200','201','202','203','204','205','206','207','208','A08', 'A16') or
substring(ICD9CM_CODE_2,1,3) in ('140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','179','180','181','182','183','184','185','186','187','188','189','190','191','192','193','194','195','196','197','198','199','200','201','202','203','204','205','206','207','208','A08', 'A16') or
substring(ICD9CM_CODE_3,1,3) in ('140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','179','180','181','182','183','184','185','186','187','188','189','190','191','192','193','194','195','196','197','198','199','200','201','202','203','204','205','206','207','208','A08', 'A16') or
substring(ICD9CM_CODE_4,1,3) in ('140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','179','180','181','182','183','184','185','186','187','188','189','190','191','192','193','194','195','196','197','198','199','200','201','202','203','204','205','206','207','208','A08', 'A16') or
--前四碼--
substring(ICD9CM_CODE,1,4) in ('A090', 'A091', 'A094', 'A095', 'A096', 'A099', 'A100', 'A101', 'A109', 'A110', 'A111', 'A112', 'A113', 'A114', 'A115', 'A120', 'A121', 'A112', 'A123', 'A124', 'A125', 'A126', 'A129', 'A130', 'A139', 'A140', 'A141', 'A149') or
substring(ICD9CM_CODE_1,1,4) in ('A090', 'A091', 'A094', 'A095', 'A096', 'A099', 'A100', 'A101', 'A109', 'A110', 'A111', 'A112', 'A113', 'A114', 'A115', 'A120', 'A121', 'A112', 'A123', 'A124', 'A125', 'A126', 'A129', 'A130', 'A139', 'A140', 'A141', 'A149') or
substring(ICD9CM_CODE_2,1,4) in ('A090', 'A091', 'A094', 'A095', 'A096', 'A099', 'A100', 'A101', 'A109', 'A110', 'A111', 'A112', 'A113', 'A114', 'A115', 'A120', 'A121', 'A112', 'A123', 'A124', 'A125', 'A126', 'A129', 'A130', 'A139', 'A140', 'A141', 'A149') or
substring(ICD9CM_CODE_3,1,4) in ('A090', 'A091', 'A094', 'A095', 'A096', 'A099', 'A100', 'A101', 'A109', 'A110', 'A111', 'A112', 'A113', 'A114', 'A115', 'A120', 'A121', 'A112', 'A123', 'A124', 'A125', 'A126', 'A129', 'A130', 'A139', 'A140', 'A141', 'A149') or
substring(ICD9CM_CODE_4,1,4) in ('A090', 'A091', 'A094', 'A095', 'A096', 'A099', 'A100', 'A101', 'A109', 'A110', 'A111', 'A112', 'A113', 'A114', 'A115', 'A120', 'A121', 'A112', 'A123', 'A124', 'A125', 'A126', 'A129', 'A130', 'A139', 'A140', 'A141', 'A149')
union all
select ID, IN_DATE as FUNC_DATE from HIGH_AGE_DD.DBO.DD2004
where
--前三碼--
substring(ICD9CM_CODE,1,3) in ('140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','179','180','181','182','183','184','185','186','187','188','189','190','191','192','193','194','195','196','197','198','199','200','201','202','203','204','205','206','207','208','A08', 'A16') or
substring(ICD9CM_CODE_1,1,3) in ('140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','179','180','181','182','183','184','185','186','187','188','189','190','191','192','193','194','195','196','197','198','199','200','201','202','203','204','205','206','207','208','A08', 'A16') or
substring(ICD9CM_CODE_2,1,3) in ('140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','179','180','181','182','183','184','185','186','187','188','189','190','191','192','193','194','195','196','197','198','199','200','201','202','203','204','205','206','207','208','A08', 'A16') or
substring(ICD9CM_CODE_3,1,3) in ('140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','179','180','181','182','183','184','185','186','187','188','189','190','191','192','193','194','195','196','197','198','199','200','201','202','203','204','205','206','207','208','A08', 'A16') or
substring(ICD9CM_CODE_4,1,3) in ('140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','179','180','181','182','183','184','185','186','187','188','189','190','191','192','193','194','195','196','197','198','199','200','201','202','203','204','205','206','207','208','A08', 'A16') or
--前四碼--
substring(ICD9CM_CODE,1,4) in ('A090', 'A091', 'A094', 'A095', 'A096', 'A099', 'A100', 'A101', 'A109', 'A110', 'A111', 'A112', 'A113', 'A114', 'A115', 'A120', 'A121', 'A112', 'A123', 'A124', 'A125', 'A126', 'A129', 'A130', 'A139', 'A140', 'A141', 'A149') or
substring(ICD9CM_CODE_1,1,4) in ('A090', 'A091', 'A094', 'A095', 'A096', 'A099', 'A100', 'A101', 'A109', 'A110', 'A111', 'A112', 'A113', 'A114', 'A115', 'A120', 'A121', 'A112', 'A123', 'A124', 'A125', 'A126', 'A129', 'A130', 'A139', 'A140', 'A141', 'A149') or
substring(ICD9CM_CODE_2,1,4) in ('A090', 'A091', 'A094', 'A095', 'A096', 'A099', 'A100', 'A101', 'A109', 'A110', 'A111', 'A112', 'A113', 'A114', 'A115', 'A120', 'A121', 'A112', 'A123', 'A124', 'A125', 'A126', 'A129', 'A130', 'A139', 'A140', 'A141', 'A149') or
substring(ICD9CM_CODE_3,1,4) in ('A090', 'A091', 'A094', 'A095', 'A096', 'A099', 'A100', 'A101', 'A109', 'A110', 'A111', 'A112', 'A113', 'A114', 'A115', 'A120', 'A121', 'A112', 'A123', 'A124', 'A125', 'A126', 'A129', 'A130', 'A139', 'A140', 'A141', 'A149') or
substring(ICD9CM_CODE_4,1,4) in ('A090', 'A091', 'A094', 'A095', 'A096', 'A099', 'A100', 'A101', 'A109', 'A110', 'A111', 'A112', 'A113', 'A114', 'A115', 'A120', 'A121', 'A112', 'A123', 'A124', 'A125', 'A126', 'A129', 'A130', 'A139', 'A140', 'A141', 'A149')
union all
select ID, IN_DATE as FUNC_DATE from HIGH_AGE_DD.DBO.DD2005
where
--前三碼--
substring(ICD9CM_CODE,1,3) in ('140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','179','180','181','182','183','184','185','186','187','188','189','190','191','192','193','194','195','196','197','198','199','200','201','202','203','204','205','206','207','208','A08', 'A16') or
substring(ICD9CM_CODE_1,1,3) in ('140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','179','180','181','182','183','184','185','186','187','188','189','190','191','192','193','194','195','196','197','198','199','200','201','202','203','204','205','206','207','208','A08', 'A16') or
substring(ICD9CM_CODE_2,1,3) in ('140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','179','180','181','182','183','184','185','186','187','188','189','190','191','192','193','194','195','196','197','198','199','200','201','202','203','204','205','206','207','208','A08', 'A16') or
substring(ICD9CM_CODE_3,1,3) in ('140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','179','180','181','182','183','184','185','186','187','188','189','190','191','192','193','194','195','196','197','198','199','200','201','202','203','204','205','206','207','208','A08', 'A16') or
substring(ICD9CM_CODE_4,1,3) in ('140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','179','180','181','182','183','184','185','186','187','188','189','190','191','192','193','194','195','196','197','198','199','200','201','202','203','204','205','206','207','208','A08', 'A16') or
--前四碼--
substring(ICD9CM_CODE,1,4) in ('A090', 'A091', 'A094', 'A095', 'A096', 'A099', 'A100', 'A101', 'A109', 'A110', 'A111', 'A112', 'A113', 'A114', 'A115', 'A120', 'A121', 'A112', 'A123', 'A124', 'A125', 'A126', 'A129', 'A130', 'A139', 'A140', 'A141', 'A149') or
substring(ICD9CM_CODE_1,1,4) in ('A090', 'A091', 'A094', 'A095', 'A096', 'A099', 'A100', 'A101', 'A109', 'A110', 'A111', 'A112', 'A113', 'A114', 'A115', 'A120', 'A121', 'A112', 'A123', 'A124', 'A125', 'A126', 'A129', 'A130', 'A139', 'A140', 'A141', 'A149') or
substring(ICD9CM_CODE_2,1,4) in ('A090', 'A091', 'A094', 'A095', 'A096', 'A099', 'A100', 'A101', 'A109', 'A110', 'A111', 'A112', 'A113', 'A114', 'A115', 'A120', 'A121', 'A112', 'A123', 'A124', 'A125', 'A126', 'A129', 'A130', 'A139', 'A140', 'A141', 'A149') or
substring(ICD9CM_CODE_3,1,4) in ('A090', 'A091', 'A094', 'A095', 'A096', 'A099', 'A100', 'A101', 'A109', 'A110', 'A111', 'A112', 'A113', 'A114', 'A115', 'A120', 'A121', 'A112', 'A123', 'A124', 'A125', 'A126', 'A129', 'A130', 'A139', 'A140', 'A141', 'A149') or
substring(ICD9CM_CODE_4,1,4) in ('A090', 'A091', 'A094', 'A095', 'A096', 'A099', 'A100', 'A101', 'A109', 'A110', 'A111', 'A112', 'A113', 'A114', 'A115', 'A120', 'A121', 'A112', 'A123', 'A124', 'A125', 'A126', 'A129', 'A130', 'A139', 'A140', 'A141', 'A149')
union all
select ID, IN_DATE as FUNC_DATE from HIGH_AGE_DD.DBO.DD2006
where
--前三碼--
substring(ICD9CM_CODE,1,3) in ('140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','179','180','181','182','183','184','185','186','187','188','189','190','191','192','193','194','195','196','197','198','199','200','201','202','203','204','205','206','207','208','A08', 'A16') or
substring(ICD9CM_CODE_1,1,3) in ('140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','179','180','181','182','183','184','185','186','187','188','189','190','191','192','193','194','195','196','197','198','199','200','201','202','203','204','205','206','207','208','A08', 'A16') or
substring(ICD9CM_CODE_2,1,3) in ('140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','179','180','181','182','183','184','185','186','187','188','189','190','191','192','193','194','195','196','197','198','199','200','201','202','203','204','205','206','207','208','A08', 'A16') or
substring(ICD9CM_CODE_3,1,3) in ('140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','179','180','181','182','183','184','185','186','187','188','189','190','191','192','193','194','195','196','197','198','199','200','201','202','203','204','205','206','207','208','A08', 'A16') or
substring(ICD9CM_CODE_4,1,3) in ('140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','179','180','181','182','183','184','185','186','187','188','189','190','191','192','193','194','195','196','197','198','199','200','201','202','203','204','205','206','207','208','A08', 'A16') or
--前四碼--
substring(ICD9CM_CODE,1,4) in ('A090', 'A091', 'A094', 'A095', 'A096', 'A099', 'A100', 'A101', 'A109', 'A110', 'A111', 'A112', 'A113', 'A114', 'A115', 'A120', 'A121', 'A112', 'A123', 'A124', 'A125', 'A126', 'A129', 'A130', 'A139', 'A140', 'A141', 'A149') or
substring(ICD9CM_CODE_1,1,4) in ('A090', 'A091', 'A094', 'A095', 'A096', 'A099', 'A100', 'A101', 'A109', 'A110', 'A111', 'A112', 'A113', 'A114', 'A115', 'A120', 'A121', 'A112', 'A123', 'A124', 'A125', 'A126', 'A129', 'A130', 'A139', 'A140', 'A141', 'A149') or
substring(ICD9CM_CODE_2,1,4) in ('A090', 'A091', 'A094', 'A095', 'A096', 'A099', 'A100', 'A101', 'A109', 'A110', 'A111', 'A112', 'A113', 'A114', 'A115', 'A120', 'A121', 'A112', 'A123', 'A124', 'A125', 'A126', 'A129', 'A130', 'A139', 'A140', 'A141', 'A149') or
substring(ICD9CM_CODE_3,1,4) in ('A090', 'A091', 'A094', 'A095', 'A096', 'A099', 'A100', 'A101', 'A109', 'A110', 'A111', 'A112', 'A113', 'A114', 'A115', 'A120', 'A121', 'A112', 'A123', 'A124', 'A125', 'A126', 'A129', 'A130', 'A139', 'A140', 'A141', 'A149') or
substring(ICD9CM_CODE_4,1,4) in ('A090', 'A091', 'A094', 'A095', 'A096', 'A099', 'A100', 'A101', 'A109', 'A110', 'A111', 'A112', 'A113', 'A114', 'A115', 'A120', 'A121', 'A112', 'A123', 'A124', 'A125', 'A126', 'A129', 'A130', 'A139', 'A140', 'A141', 'A149')
union all
select ID, IN_DATE as FUNC_DATE from HIGH_AGE_DD.DBO.DD2007
where
--前三碼--
substring(ICD9CM_CODE,1,3) in ('140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','179','180','181','182','183','184','185','186','187','188','189','190','191','192','193','194','195','196','197','198','199','200','201','202','203','204','205','206','207','208','A08', 'A16') or
substring(ICD9CM_CODE_1,1,3) in ('140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','179','180','181','182','183','184','185','186','187','188','189','190','191','192','193','194','195','196','197','198','199','200','201','202','203','204','205','206','207','208','A08', 'A16') or
substring(ICD9CM_CODE_2,1,3) in ('140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','179','180','181','182','183','184','185','186','187','188','189','190','191','192','193','194','195','196','197','198','199','200','201','202','203','204','205','206','207','208','A08', 'A16') or
substring(ICD9CM_CODE_3,1,3) in ('140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','179','180','181','182','183','184','185','186','187','188','189','190','191','192','193','194','195','196','197','198','199','200','201','202','203','204','205','206','207','208','A08', 'A16') or
substring(ICD9CM_CODE_4,1,3) in ('140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','179','180','181','182','183','184','185','186','187','188','189','190','191','192','193','194','195','196','197','198','199','200','201','202','203','204','205','206','207','208','A08', 'A16') or
--前四碼--
substring(ICD9CM_CODE,1,4) in ('A090', 'A091', 'A094', 'A095', 'A096', 'A099', 'A100', 'A101', 'A109', 'A110', 'A111', 'A112', 'A113', 'A114', 'A115', 'A120', 'A121', 'A112', 'A123', 'A124', 'A125', 'A126', 'A129', 'A130', 'A139', 'A140', 'A141', 'A149') or
substring(ICD9CM_CODE_1,1,4) in ('A090', 'A091', 'A094', 'A095', 'A096', 'A099', 'A100', 'A101', 'A109', 'A110', 'A111', 'A112', 'A113', 'A114', 'A115', 'A120', 'A121', 'A112', 'A123', 'A124', 'A125', 'A126', 'A129', 'A130', 'A139', 'A140', 'A141', 'A149') or
substring(ICD9CM_CODE_2,1,4) in ('A090', 'A091', 'A094', 'A095', 'A096', 'A099', 'A100', 'A101', 'A109', 'A110', 'A111', 'A112', 'A113', 'A114', 'A115', 'A120', 'A121', 'A112', 'A123', 'A124', 'A125', 'A126', 'A129', 'A130', 'A139', 'A140', 'A141', 'A149') or
substring(ICD9CM_CODE_3,1,4) in ('A090', 'A091', 'A094', 'A095', 'A096', 'A099', 'A100', 'A101', 'A109', 'A110', 'A111', 'A112', 'A113', 'A114', 'A115', 'A120', 'A121', 'A112', 'A123', 'A124', 'A125', 'A126', 'A129', 'A130', 'A139', 'A140', 'A141', 'A149') or
substring(ICD9CM_CODE_4,1,4) in ('A090', 'A091', 'A094', 'A095', 'A096', 'A099', 'A100', 'A101', 'A109', 'A110', 'A111', 'A112', 'A113', 'A114', 'A115', 'A120', 'A121', 'A112', 'A123', 'A124', 'A125', 'A126', 'A129', 'A130', 'A139', 'A140', 'A141', 'A149')
union all
select ID, IN_DATE as FUNC_DATE from HIGH_AGE_DD.DBO.DD2008
where
--前三碼--
substring(ICD9CM_CODE,1,3) in ('140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','179','180','181','182','183','184','185','186','187','188','189','190','191','192','193','194','195','196','197','198','199','200','201','202','203','204','205','206','207','208','A08', 'A16') or
substring(ICD9CM_CODE_1,1,3) in ('140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','179','180','181','182','183','184','185','186','187','188','189','190','191','192','193','194','195','196','197','198','199','200','201','202','203','204','205','206','207','208','A08', 'A16') or
substring(ICD9CM_CODE_2,1,3) in ('140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','179','180','181','182','183','184','185','186','187','188','189','190','191','192','193','194','195','196','197','198','199','200','201','202','203','204','205','206','207','208','A08', 'A16') or
substring(ICD9CM_CODE_3,1,3) in ('140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','179','180','181','182','183','184','185','186','187','188','189','190','191','192','193','194','195','196','197','198','199','200','201','202','203','204','205','206','207','208','A08', 'A16') or
substring(ICD9CM_CODE_4,1,3) in ('140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','179','180','181','182','183','184','185','186','187','188','189','190','191','192','193','194','195','196','197','198','199','200','201','202','203','204','205','206','207','208','A08', 'A16') or
--前四碼--
substring(ICD9CM_CODE,1,4) in ('A090', 'A091', 'A094', 'A095', 'A096', 'A099', 'A100', 'A101', 'A109', 'A110', 'A111', 'A112', 'A113', 'A114', 'A115', 'A120', 'A121', 'A112', 'A123', 'A124', 'A125', 'A126', 'A129', 'A130', 'A139', 'A140', 'A141', 'A149') or
substring(ICD9CM_CODE_1,1,4) in ('A090', 'A091', 'A094', 'A095', 'A096', 'A099', 'A100', 'A101', 'A109', 'A110', 'A111', 'A112', 'A113', 'A114', 'A115', 'A120', 'A121', 'A112', 'A123', 'A124', 'A125', 'A126', 'A129', 'A130', 'A139', 'A140', 'A141', 'A149') or
substring(ICD9CM_CODE_2,1,4) in ('A090', 'A091', 'A094', 'A095', 'A096', 'A099', 'A100', 'A101', 'A109', 'A110', 'A111', 'A112', 'A113', 'A114', 'A115', 'A120', 'A121', 'A112', 'A123', 'A124', 'A125', 'A126', 'A129', 'A130', 'A139', 'A140', 'A141', 'A149') or
substring(ICD9CM_CODE_3,1,4) in ('A090', 'A091', 'A094', 'A095', 'A096', 'A099', 'A100', 'A101', 'A109', 'A110', 'A111', 'A112', 'A113', 'A114', 'A115', 'A120', 'A121', 'A112', 'A123', 'A124', 'A125', 'A126', 'A129', 'A130', 'A139', 'A140', 'A141', 'A149') or
substring(ICD9CM_CODE_4,1,4) in ('A090', 'A091', 'A094', 'A095', 'A096', 'A099', 'A100', 'A101', 'A109', 'A110', 'A111', 'A112', 'A113', 'A114', 'A115', 'A120', 'A121', 'A112', 'A123', 'A124', 'A125', 'A126', 'A129', 'A130', 'A139', 'A140', 'A141', 'A149')
union all
select ID, IN_DATE as FUNC_DATE from HIGH_AGE_DD.DBO.DD2009
where
--前三碼--
substring(ICD9CM_CODE,1,3) in ('140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','179','180','181','182','183','184','185','186','187','188','189','190','191','192','193','194','195','196','197','198','199','200','201','202','203','204','205','206','207','208','A08', 'A16') or
substring(ICD9CM_CODE_1,1,3) in ('140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','179','180','181','182','183','184','185','186','187','188','189','190','191','192','193','194','195','196','197','198','199','200','201','202','203','204','205','206','207','208','A08', 'A16') or
substring(ICD9CM_CODE_2,1,3) in ('140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','179','180','181','182','183','184','185','186','187','188','189','190','191','192','193','194','195','196','197','198','199','200','201','202','203','204','205','206','207','208','A08', 'A16') or
substring(ICD9CM_CODE_3,1,3) in ('140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','179','180','181','182','183','184','185','186','187','188','189','190','191','192','193','194','195','196','197','198','199','200','201','202','203','204','205','206','207','208','A08', 'A16') or
substring(ICD9CM_CODE_4,1,3) in ('140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','179','180','181','182','183','184','185','186','187','188','189','190','191','192','193','194','195','196','197','198','199','200','201','202','203','204','205','206','207','208','A08', 'A16') or
--前四碼--
substring(ICD9CM_CODE,1,4) in ('A090', 'A091', 'A094', 'A095', 'A096', 'A099', 'A100', 'A101', 'A109', 'A110', 'A111', 'A112', 'A113', 'A114', 'A115', 'A120', 'A121', 'A112', 'A123', 'A124', 'A125', 'A126', 'A129', 'A130', 'A139', 'A140', 'A141', 'A149') or
substring(ICD9CM_CODE_1,1,4) in ('A090', 'A091', 'A094', 'A095', 'A096', 'A099', 'A100', 'A101', 'A109', 'A110', 'A111', 'A112', 'A113', 'A114', 'A115', 'A120', 'A121', 'A112', 'A123', 'A124', 'A125', 'A126', 'A129', 'A130', 'A139', 'A140', 'A141', 'A149') or
substring(ICD9CM_CODE_2,1,4) in ('A090', 'A091', 'A094', 'A095', 'A096', 'A099', 'A100', 'A101', 'A109', 'A110', 'A111', 'A112', 'A113', 'A114', 'A115', 'A120', 'A121', 'A112', 'A123', 'A124', 'A125', 'A126', 'A129', 'A130', 'A139', 'A140', 'A141', 'A149') or
substring(ICD9CM_CODE_3,1,4) in ('A090', 'A091', 'A094', 'A095', 'A096', 'A099', 'A100', 'A101', 'A109', 'A110', 'A111', 'A112', 'A113', 'A114', 'A115', 'A120', 'A121', 'A112', 'A123', 'A124', 'A125', 'A126', 'A129', 'A130', 'A139', 'A140', 'A141', 'A149') or
substring(ICD9CM_CODE_4,1,4) in ('A090', 'A091', 'A094', 'A095', 'A096', 'A099', 'A100', 'A101', 'A109', 'A110', 'A111', 'A112', 'A113', 'A114', 'A115', 'A120', 'A121', 'A112', 'A123', 'A124', 'A125', 'A126', 'A129', 'A130', 'A139', 'A140', 'A141', 'A149')
union all
select ID, IN_DATE as FUNC_DATE from HIGH_AGE_DD.DBO.DD2010
where
--前三碼--
substring(ICD9CM_CODE,1,3) in ('140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','179','180','181','182','183','184','185','186','187','188','189','190','191','192','193','194','195','196','197','198','199','200','201','202','203','204','205','206','207','208','A08', 'A16') or
substring(ICD9CM_CODE_1,1,3) in ('140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','179','180','181','182','183','184','185','186','187','188','189','190','191','192','193','194','195','196','197','198','199','200','201','202','203','204','205','206','207','208','A08', 'A16') or
substring(ICD9CM_CODE_2,1,3) in ('140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','179','180','181','182','183','184','185','186','187','188','189','190','191','192','193','194','195','196','197','198','199','200','201','202','203','204','205','206','207','208','A08', 'A16') or
substring(ICD9CM_CODE_3,1,3) in ('140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','179','180','181','182','183','184','185','186','187','188','189','190','191','192','193','194','195','196','197','198','199','200','201','202','203','204','205','206','207','208','A08', 'A16') or
substring(ICD9CM_CODE_4,1,3) in ('140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','179','180','181','182','183','184','185','186','187','188','189','190','191','192','193','194','195','196','197','198','199','200','201','202','203','204','205','206','207','208','A08', 'A16') or
--前四碼--
substring(ICD9CM_CODE,1,4) in ('A090', 'A091', 'A094', 'A095', 'A096', 'A099', 'A100', 'A101', 'A109', 'A110', 'A111', 'A112', 'A113', 'A114', 'A115', 'A120', 'A121', 'A112', 'A123', 'A124', 'A125', 'A126', 'A129', 'A130', 'A139', 'A140', 'A141', 'A149') or
substring(ICD9CM_CODE_1,1,4) in ('A090', 'A091', 'A094', 'A095', 'A096', 'A099', 'A100', 'A101', 'A109', 'A110', 'A111', 'A112', 'A113', 'A114', 'A115', 'A120', 'A121', 'A112', 'A123', 'A124', 'A125', 'A126', 'A129', 'A130', 'A139', 'A140', 'A141', 'A149') or
substring(ICD9CM_CODE_2,1,4) in ('A090', 'A091', 'A094', 'A095', 'A096', 'A099', 'A100', 'A101', 'A109', 'A110', 'A111', 'A112', 'A113', 'A114', 'A115', 'A120', 'A121', 'A112', 'A123', 'A124', 'A125', 'A126', 'A129', 'A130', 'A139', 'A140', 'A141', 'A149') or
substring(ICD9CM_CODE_3,1,4) in ('A090', 'A091', 'A094', 'A095', 'A096', 'A099', 'A100', 'A101', 'A109', 'A110', 'A111', 'A112', 'A113', 'A114', 'A115', 'A120', 'A121', 'A112', 'A123', 'A124', 'A125', 'A126', 'A129', 'A130', 'A139', 'A140', 'A141', 'A149') or
substring(ICD9CM_CODE_4,1,4) in ('A090', 'A091', 'A094', 'A095', 'A096', 'A099', 'A100', 'A101', 'A109', 'A110', 'A111', 'A112', 'A113', 'A114', 'A115', 'A120', 'A121', 'A112', 'A123', 'A124', 'A125', 'A126', 'A129', 'A130', 'A139', 'A140', 'A141', 'A149')
union all
select ID, IN_DATE as FUNC_DATE from HIGH_AGE_DD.DBO.DD2011
where
--前三碼--
substring(ICD9CM_CODE,1,3) in ('140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','179','180','181','182','183','184','185','186','187','188','189','190','191','192','193','194','195','196','197','198','199','200','201','202','203','204','205','206','207','208','A08', 'A16') or
substring(ICD9CM_CODE_1,1,3) in ('140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','179','180','181','182','183','184','185','186','187','188','189','190','191','192','193','194','195','196','197','198','199','200','201','202','203','204','205','206','207','208','A08', 'A16') or
substring(ICD9CM_CODE_2,1,3) in ('140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','179','180','181','182','183','184','185','186','187','188','189','190','191','192','193','194','195','196','197','198','199','200','201','202','203','204','205','206','207','208','A08', 'A16') or
substring(ICD9CM_CODE_3,1,3) in ('140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','179','180','181','182','183','184','185','186','187','188','189','190','191','192','193','194','195','196','197','198','199','200','201','202','203','204','205','206','207','208','A08', 'A16') or
substring(ICD9CM_CODE_4,1,3) in ('140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','179','180','181','182','183','184','185','186','187','188','189','190','191','192','193','194','195','196','197','198','199','200','201','202','203','204','205','206','207','208','A08', 'A16') or
--前四碼--
substring(ICD9CM_CODE,1,4) in ('A090', 'A091', 'A094', 'A095', 'A096', 'A099', 'A100', 'A101', 'A109', 'A110', 'A111', 'A112', 'A113', 'A114', 'A115', 'A120', 'A121', 'A112', 'A123', 'A124', 'A125', 'A126', 'A129', 'A130', 'A139', 'A140', 'A141', 'A149') or
substring(ICD9CM_CODE_1,1,4) in ('A090', 'A091', 'A094', 'A095', 'A096', 'A099', 'A100', 'A101', 'A109', 'A110', 'A111', 'A112', 'A113', 'A114', 'A115', 'A120', 'A121', 'A112', 'A123', 'A124', 'A125', 'A126', 'A129', 'A130', 'A139', 'A140', 'A141', 'A149') or
substring(ICD9CM_CODE_2,1,4) in ('A090', 'A091', 'A094', 'A095', 'A096', 'A099', 'A100', 'A101', 'A109', 'A110', 'A111', 'A112', 'A113', 'A114', 'A115', 'A120', 'A121', 'A112', 'A123', 'A124', 'A125', 'A126', 'A129', 'A130', 'A139', 'A140', 'A141', 'A149') or
substring(ICD9CM_CODE_3,1,4) in ('A090', 'A091', 'A094', 'A095', 'A096', 'A099', 'A100', 'A101', 'A109', 'A110', 'A111', 'A112', 'A113', 'A114', 'A115', 'A120', 'A121', 'A112', 'A123', 'A124', 'A125', 'A126', 'A129', 'A130', 'A139', 'A140', 'A141', 'A149') or
substring(ICD9CM_CODE_4,1,4) in ('A090', 'A091', 'A094', 'A095', 'A096', 'A099', 'A100', 'A101', 'A109', 'A110', 'A111', 'A112', 'A113', 'A114', 'A115', 'A120', 'A121', 'A112', 'A123', 'A124', 'A125', 'A126', 'A129', 'A130', 'A139', 'A140', 'A141', 'A149')
union all
select ID, IN_DATE as FUNC_DATE from HIGH_AGE_DD.DBO.DD2012
where
--前三碼--
substring(ICD9CM_CODE,1,3) in ('140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','179','180','181','182','183','184','185','186','187','188','189','190','191','192','193','194','195','196','197','198','199','200','201','202','203','204','205','206','207','208','A08', 'A16') or
substring(ICD9CM_CODE_1,1,3) in ('140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','179','180','181','182','183','184','185','186','187','188','189','190','191','192','193','194','195','196','197','198','199','200','201','202','203','204','205','206','207','208','A08', 'A16') or
substring(ICD9CM_CODE_2,1,3) in ('140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','179','180','181','182','183','184','185','186','187','188','189','190','191','192','193','194','195','196','197','198','199','200','201','202','203','204','205','206','207','208','A08', 'A16') or
substring(ICD9CM_CODE_3,1,3) in ('140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','179','180','181','182','183','184','185','186','187','188','189','190','191','192','193','194','195','196','197','198','199','200','201','202','203','204','205','206','207','208','A08', 'A16') or
substring(ICD9CM_CODE_4,1,3) in ('140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','179','180','181','182','183','184','185','186','187','188','189','190','191','192','193','194','195','196','197','198','199','200','201','202','203','204','205','206','207','208','A08', 'A16') or
--前四碼--
substring(ICD9CM_CODE,1,4) in ('A090', 'A091', 'A094', 'A095', 'A096', 'A099', 'A100', 'A101', 'A109', 'A110', 'A111', 'A112', 'A113', 'A114', 'A115', 'A120', 'A121', 'A112', 'A123', 'A124', 'A125', 'A126', 'A129', 'A130', 'A139', 'A140', 'A141', 'A149') or
substring(ICD9CM_CODE_1,1,4) in ('A090', 'A091', 'A094', 'A095', 'A096', 'A099', 'A100', 'A101', 'A109', 'A110', 'A111', 'A112', 'A113', 'A114', 'A115', 'A120', 'A121', 'A112', 'A123', 'A124', 'A125', 'A126', 'A129', 'A130', 'A139', 'A140', 'A141', 'A149') or
substring(ICD9CM_CODE_2,1,4) in ('A090', 'A091', 'A094', 'A095', 'A096', 'A099', 'A100', 'A101', 'A109', 'A110', 'A111', 'A112', 'A113', 'A114', 'A115', 'A120', 'A121', 'A112', 'A123', 'A124', 'A125', 'A126', 'A129', 'A130', 'A139', 'A140', 'A141', 'A149') or
substring(ICD9CM_CODE_3,1,4) in ('A090', 'A091', 'A094', 'A095', 'A096', 'A099', 'A100', 'A101', 'A109', 'A110', 'A111', 'A112', 'A113', 'A114', 'A115', 'A120', 'A121', 'A112', 'A123', 'A124', 'A125', 'A126', 'A129', 'A130', 'A139', 'A140', 'A141', 'A149') or
substring(ICD9CM_CODE_4,1,4) in ('A090', 'A091', 'A094', 'A095', 'A096', 'A099', 'A100', 'A101', 'A109', 'A110', 'A111', 'A112', 'A113', 'A114', 'A115', 'A120', 'A121', 'A112', 'A123', 'A124', 'A125', 'A126', 'A129', 'A130', 'A139', 'A140', 'A141', 'A149')
union all
select ID, IN_DATE as FUNC_DATE from HIGH_AGE_DD.DBO.DD2013
where
--前三碼--
substring(ICD9CM_CODE,1,3) in ('140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','179','180','181','182','183','184','185','186','187','188','189','190','191','192','193','194','195','196','197','198','199','200','201','202','203','204','205','206','207','208','A08', 'A16') or
substring(ICD9CM_CODE_1,1,3) in ('140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','179','180','181','182','183','184','185','186','187','188','189','190','191','192','193','194','195','196','197','198','199','200','201','202','203','204','205','206','207','208','A08', 'A16') or
substring(ICD9CM_CODE_2,1,3) in ('140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','179','180','181','182','183','184','185','186','187','188','189','190','191','192','193','194','195','196','197','198','199','200','201','202','203','204','205','206','207','208','A08', 'A16') or
substring(ICD9CM_CODE_3,1,3) in ('140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','179','180','181','182','183','184','185','186','187','188','189','190','191','192','193','194','195','196','197','198','199','200','201','202','203','204','205','206','207','208','A08', 'A16') or
substring(ICD9CM_CODE_4,1,3) in ('140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','179','180','181','182','183','184','185','186','187','188','189','190','191','192','193','194','195','196','197','198','199','200','201','202','203','204','205','206','207','208','A08', 'A16') or
--前四碼--
substring(ICD9CM_CODE,1,4) in ('A090', 'A091', 'A094', 'A095', 'A096', 'A099', 'A100', 'A101', 'A109', 'A110', 'A111', 'A112', 'A113', 'A114', 'A115', 'A120', 'A121', 'A112', 'A123', 'A124', 'A125', 'A126', 'A129', 'A130', 'A139', 'A140', 'A141', 'A149') or
substring(ICD9CM_CODE_1,1,4) in ('A090', 'A091', 'A094', 'A095', 'A096', 'A099', 'A100', 'A101', 'A109', 'A110', 'A111', 'A112', 'A113', 'A114', 'A115', 'A120', 'A121', 'A112', 'A123', 'A124', 'A125', 'A126', 'A129', 'A130', 'A139', 'A140', 'A141', 'A149') or
substring(ICD9CM_CODE_2,1,4) in ('A090', 'A091', 'A094', 'A095', 'A096', 'A099', 'A100', 'A101', 'A109', 'A110', 'A111', 'A112', 'A113', 'A114', 'A115', 'A120', 'A121', 'A112', 'A123', 'A124', 'A125', 'A126', 'A129', 'A130', 'A139', 'A140', 'A141', 'A149') or
substring(ICD9CM_CODE_3,1,4) in ('A090', 'A091', 'A094', 'A095', 'A096', 'A099', 'A100', 'A101', 'A109', 'A110', 'A111', 'A112', 'A113', 'A114', 'A115', 'A120', 'A121', 'A112', 'A123', 'A124', 'A125', 'A126', 'A129', 'A130', 'A139', 'A140', 'A141', 'A149') or
substring(ICD9CM_CODE_4,1,4) in ('A090', 'A091', 'A094', 'A095', 'A096', 'A099', 'A100', 'A101', 'A109', 'A110', 'A111', 'A112', 'A113', 'A114', 'A115', 'A120', 'A121', 'A112', 'A123', 'A124', 'A125', 'A126', 'A129', 'A130', 'A139', 'A140', 'A141', 'A149')
),
A as(
SELECT *, 'cd' as FUNC_TYPE FROM CD
UNION ALL
SELECT *, 'dd' as FUNC_TYPE FROM DD
),
B as(
SELECT ID, MIN(FUNC_DATE) AS F_C_DATE FROM A
GROUP BY ID
)
select B.*, HIGH_AGE_ID.dbo.UID100W.ID_SEX, HIGH_AGE_ID.dbo.UID100W.NEW_BIRTHDAY into HIGH_AGE_CD.dbo.FIRST_CANCER from B
left join HIGH_AGE_ID.dbo.UID100W
on HIGH_AGE_ID.dbo.UID100W.ID = B.ID