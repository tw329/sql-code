WITH 
CD AS(
	SELECT ID, FUNC_DATE FROM HIGH_AGE_CD.DBO.CD1996
	WHERE 
		(SUBSTRING(ACODE_ICD9_1,1,3) = '250' AND (SUBSTRING(ACODE_ICD9_1,5,1) = '3' or SUBSTRING(ACODE_ICD9_1,5,1) = '1'))
		OR
		(SUBSTRING(ACODE_ICD9_2,1,3) = '250' AND (SUBSTRING(ACODE_ICD9_2,5,1) = '3' or SUBSTRING(ACODE_ICD9_2,5,1) = '1'))
		OR
		(SUBSTRING(ACODE_ICD9_3,1,3) = '250' AND (SUBSTRING(ACODE_ICD9_3,5,1) = '3' or SUBSTRING(ACODE_ICD9_3,5,1) = '1'))
	union all
	SELECT ID, FUNC_DATE FROM HIGH_AGE_CD.DBO.CD1997
	WHERE 
		(SUBSTRING(ACODE_ICD9_1,1,3) = '250' AND (SUBSTRING(ACODE_ICD9_1,5,1) = '3' or SUBSTRING(ACODE_ICD9_1,5,1) = '1'))
		OR
		(SUBSTRING(ACODE_ICD9_2,1,3) = '250' AND (SUBSTRING(ACODE_ICD9_2,5,1) = '3' or SUBSTRING(ACODE_ICD9_2,5,1) = '1'))
		OR
		(SUBSTRING(ACODE_ICD9_3,1,3) = '250' AND (SUBSTRING(ACODE_ICD9_3,5,1) = '3' or SUBSTRING(ACODE_ICD9_3,5,1) = '1'))
	union all
	SELECT ID, FUNC_DATE FROM HIGH_AGE_CD.DBO.CD1998
	WHERE 
		(SUBSTRING(ACODE_ICD9_1,1,3) = '250' AND (SUBSTRING(ACODE_ICD9_1,5,1) = '3' or SUBSTRING(ACODE_ICD9_1,5,1) = '1'))
		OR
		(SUBSTRING(ACODE_ICD9_2,1,3) = '250' AND (SUBSTRING(ACODE_ICD9_2,5,1) = '3' or SUBSTRING(ACODE_ICD9_2,5,1) = '1'))
		OR
		(SUBSTRING(ACODE_ICD9_3,1,3) = '250' AND (SUBSTRING(ACODE_ICD9_3,5,1) = '3' or SUBSTRING(ACODE_ICD9_3,5,1) = '1'))
	union all
	SELECT ID, FUNC_DATE FROM HIGH_AGE_CD.DBO.CD1999
	WHERE 
		(SUBSTRING(ACODE_ICD9_1,1,3) = '250' AND (SUBSTRING(ACODE_ICD9_1,5,1) = '3' or SUBSTRING(ACODE_ICD9_1,5,1) = '1'))
		OR
		(SUBSTRING(ACODE_ICD9_2,1,3) = '250' AND (SUBSTRING(ACODE_ICD9_2,5,1) = '3' or SUBSTRING(ACODE_ICD9_2,5,1) = '1'))
		OR
		(SUBSTRING(ACODE_ICD9_3,1,3) = '250' AND (SUBSTRING(ACODE_ICD9_3,5,1) = '3' or SUBSTRING(ACODE_ICD9_3,5,1) = '1'))
	union all
	SELECT ID, FUNC_DATE FROM HIGH_AGE_CD.DBO.CD2000
	WHERE 
		(SUBSTRING(ACODE_ICD9_1,1,3) = '250' AND (SUBSTRING(ACODE_ICD9_1,5,1) = '3' or SUBSTRING(ACODE_ICD9_1,5,1) = '1'))
		OR
		(SUBSTRING(ACODE_ICD9_2,1,3) = '250' AND (SUBSTRING(ACODE_ICD9_2,5,1) = '3' or SUBSTRING(ACODE_ICD9_2,5,1) = '1'))
		OR
		(SUBSTRING(ACODE_ICD9_3,1,3) = '250' AND (SUBSTRING(ACODE_ICD9_3,5,1) = '3' or SUBSTRING(ACODE_ICD9_3,5,1) = '1'))
	union all
	SELECT ID, FUNC_DATE FROM HIGH_AGE_CD.DBO.CD2001
	WHERE 
		(SUBSTRING(ACODE_ICD9_1,1,3) = '250' AND (SUBSTRING(ACODE_ICD9_1,5,1) = '3' or SUBSTRING(ACODE_ICD9_1,5,1) = '1'))
		OR
		(SUBSTRING(ACODE_ICD9_2,1,3) = '250' AND (SUBSTRING(ACODE_ICD9_2,5,1) = '3' or SUBSTRING(ACODE_ICD9_2,5,1) = '1'))
		OR
		(SUBSTRING(ACODE_ICD9_3,1,3) = '250' AND (SUBSTRING(ACODE_ICD9_3,5,1) = '3' or SUBSTRING(ACODE_ICD9_3,5,1) = '1'))
	union all
	SELECT ID, FUNC_DATE FROM HIGH_AGE_CD.DBO.CD2002
	WHERE 
		(SUBSTRING(ACODE_ICD9_1,1,3) = '250' AND (SUBSTRING(ACODE_ICD9_1,5,1) = '3' or SUBSTRING(ACODE_ICD9_1,5,1) = '1'))
		OR
		(SUBSTRING(ACODE_ICD9_2,1,3) = '250' AND (SUBSTRING(ACODE_ICD9_2,5,1) = '3' or SUBSTRING(ACODE_ICD9_2,5,1) = '1'))
		OR
		(SUBSTRING(ACODE_ICD9_3,1,3) = '250' AND (SUBSTRING(ACODE_ICD9_3,5,1) = '3' or SUBSTRING(ACODE_ICD9_3,5,1) = '1'))
	union all
	SELECT ID, FUNC_DATE FROM HIGH_AGE_CD.DBO.CD2003
	WHERE 
		(SUBSTRING(ACODE_ICD9_1,1,3) = '250' AND (SUBSTRING(ACODE_ICD9_1,5,1) = '3' or SUBSTRING(ACODE_ICD9_1,5,1) = '1'))
		OR
		(SUBSTRING(ACODE_ICD9_2,1,3) = '250' AND (SUBSTRING(ACODE_ICD9_2,5,1) = '3' or SUBSTRING(ACODE_ICD9_2,5,1) = '1'))
		OR
		(SUBSTRING(ACODE_ICD9_3,1,3) = '250' AND (SUBSTRING(ACODE_ICD9_3,5,1) = '3' or SUBSTRING(ACODE_ICD9_3,5,1) = '1'))
	union all
	SELECT ID, FUNC_DATE FROM HIGH_AGE_CD.DBO.CD2004
	WHERE 
		(SUBSTRING(ACODE_ICD9_1,1,3) = '250' AND (SUBSTRING(ACODE_ICD9_1,5,1) = '3' or SUBSTRING(ACODE_ICD9_1,5,1) = '1'))
		OR
		(SUBSTRING(ACODE_ICD9_2,1,3) = '250' AND (SUBSTRING(ACODE_ICD9_2,5,1) = '3' or SUBSTRING(ACODE_ICD9_2,5,1) = '1'))
		OR
		(SUBSTRING(ACODE_ICD9_3,1,3) = '250' AND (SUBSTRING(ACODE_ICD9_3,5,1) = '3' or SUBSTRING(ACODE_ICD9_3,5,1) = '1'))
	union all
	SELECT ID, FUNC_DATE FROM HIGH_AGE_CD.DBO.CD2005
	WHERE 
		(SUBSTRING(ACODE_ICD9_1,1,3) = '250' AND (SUBSTRING(ACODE_ICD9_1,5,1) = '3' or SUBSTRING(ACODE_ICD9_1,5,1) = '1'))
		OR
		(SUBSTRING(ACODE_ICD9_2,1,3) = '250' AND (SUBSTRING(ACODE_ICD9_2,5,1) = '3' or SUBSTRING(ACODE_ICD9_2,5,1) = '1'))
		OR
		(SUBSTRING(ACODE_ICD9_3,1,3) = '250' AND (SUBSTRING(ACODE_ICD9_3,5,1) = '3' or SUBSTRING(ACODE_ICD9_3,5,1) = '1'))
	union all
	SELECT ID, FUNC_DATE FROM HIGH_AGE_CD.DBO.CD2006
	WHERE 
		(SUBSTRING(ACODE_ICD9_1,1,3) = '250' AND (SUBSTRING(ACODE_ICD9_1,5,1) = '3' or SUBSTRING(ACODE_ICD9_1,5,1) = '1'))
		OR
		(SUBSTRING(ACODE_ICD9_2,1,3) = '250' AND (SUBSTRING(ACODE_ICD9_2,5,1) = '3' or SUBSTRING(ACODE_ICD9_2,5,1) = '1'))
		OR
		(SUBSTRING(ACODE_ICD9_3,1,3) = '250' AND (SUBSTRING(ACODE_ICD9_3,5,1) = '3' or SUBSTRING(ACODE_ICD9_3,5,1) = '1'))
	union all
	SELECT ID, FUNC_DATE FROM HIGH_AGE_CD.DBO.CD2007
	WHERE 
		(SUBSTRING(ACODE_ICD9_1,1,3) = '250' AND (SUBSTRING(ACODE_ICD9_1,5,1) = '3' or SUBSTRING(ACODE_ICD9_1,5,1) = '1'))
		OR
		(SUBSTRING(ACODE_ICD9_2,1,3) = '250' AND (SUBSTRING(ACODE_ICD9_2,5,1) = '3' or SUBSTRING(ACODE_ICD9_2,5,1) = '1'))
		OR
		(SUBSTRING(ACODE_ICD9_3,1,3) = '250' AND (SUBSTRING(ACODE_ICD9_3,5,1) = '3' or SUBSTRING(ACODE_ICD9_3,5,1) = '1'))
	union all
	SELECT ID, FUNC_DATE FROM HIGH_AGE_CD.DBO.CD2008
	WHERE 
		(SUBSTRING(ACODE_ICD9_1,1,3) = '250' AND (SUBSTRING(ACODE_ICD9_1,5,1) = '3' or SUBSTRING(ACODE_ICD9_1,5,1) = '1'))
		OR
		(SUBSTRING(ACODE_ICD9_2,1,3) = '250' AND (SUBSTRING(ACODE_ICD9_2,5,1) = '3' or SUBSTRING(ACODE_ICD9_2,5,1) = '1'))
		OR
		(SUBSTRING(ACODE_ICD9_3,1,3) = '250' AND (SUBSTRING(ACODE_ICD9_3,5,1) = '3' or SUBSTRING(ACODE_ICD9_3,5,1) = '1'))
	union all
	SELECT ID, FUNC_DATE FROM HIGH_AGE_CD.DBO.CD2009
	WHERE 
		(SUBSTRING(ACODE_ICD9_1,1,3) = '250' AND (SUBSTRING(ACODE_ICD9_1,5,1) = '3' or SUBSTRING(ACODE_ICD9_1,5,1) = '1'))
		OR
		(SUBSTRING(ACODE_ICD9_2,1,3) = '250' AND (SUBSTRING(ACODE_ICD9_2,5,1) = '3' or SUBSTRING(ACODE_ICD9_2,5,1) = '1'))
		OR
		(SUBSTRING(ACODE_ICD9_3,1,3) = '250' AND (SUBSTRING(ACODE_ICD9_3,5,1) = '3' or SUBSTRING(ACODE_ICD9_3,5,1) = '1'))
	union all
	SELECT ID, FUNC_DATE FROM HIGH_AGE_CD.DBO.CD2010
	WHERE 
		(SUBSTRING(ACODE_ICD9_1,1,3) = '250' AND (SUBSTRING(ACODE_ICD9_1,5,1) = '3' or SUBSTRING(ACODE_ICD9_1,5,1) = '1'))
		OR
		(SUBSTRING(ACODE_ICD9_2,1,3) = '250' AND (SUBSTRING(ACODE_ICD9_2,5,1) = '3' or SUBSTRING(ACODE_ICD9_2,5,1) = '1'))
		OR
		(SUBSTRING(ACODE_ICD9_3,1,3) = '250' AND (SUBSTRING(ACODE_ICD9_3,5,1) = '3' or SUBSTRING(ACODE_ICD9_3,5,1) = '1'))
	union all
	SELECT ID, FUNC_DATE FROM HIGH_AGE_CD.DBO.CD2011
	WHERE 
		(SUBSTRING(ACODE_ICD9_1,1,3) = '250' AND (SUBSTRING(ACODE_ICD9_1,5,1) = '3' or SUBSTRING(ACODE_ICD9_1,5,1) = '1'))
		OR
		(SUBSTRING(ACODE_ICD9_2,1,3) = '250' AND (SUBSTRING(ACODE_ICD9_2,5,1) = '3' or SUBSTRING(ACODE_ICD9_2,5,1) = '1'))
		OR
		(SUBSTRING(ACODE_ICD9_3,1,3) = '250' AND (SUBSTRING(ACODE_ICD9_3,5,1) = '3' or SUBSTRING(ACODE_ICD9_3,5,1) = '1'))
	union all
	SELECT ID, FUNC_DATE FROM HIGH_AGE_CD.DBO.CD2012
	WHERE 
		(SUBSTRING(ACODE_ICD9_1,1,3) = '250' AND (SUBSTRING(ACODE_ICD9_1,5,1) = '3' or SUBSTRING(ACODE_ICD9_1,5,1) = '1'))
		OR
		(SUBSTRING(ACODE_ICD9_2,1,3) = '250' AND (SUBSTRING(ACODE_ICD9_2,5,1) = '3' or SUBSTRING(ACODE_ICD9_2,5,1) = '1'))
		OR
		(SUBSTRING(ACODE_ICD9_3,1,3) = '250' AND (SUBSTRING(ACODE_ICD9_3,5,1) = '3' or SUBSTRING(ACODE_ICD9_3,5,1) = '1'))
	union all
	SELECT ID, FUNC_DATE FROM HIGH_AGE_CD.DBO.CD2013
	WHERE 
		(SUBSTRING(ACODE_ICD9_1,1,3) = '250' AND (SUBSTRING(ACODE_ICD9_1,5,1) = '3' or SUBSTRING(ACODE_ICD9_1,5,1) = '1'))
		OR
		(SUBSTRING(ACODE_ICD9_2,1,3) = '250' AND (SUBSTRING(ACODE_ICD9_2,5,1) = '3' or SUBSTRING(ACODE_ICD9_2,5,1) = '1'))
		OR
		(SUBSTRING(ACODE_ICD9_3,1,3) = '250' AND (SUBSTRING(ACODE_ICD9_3,5,1) = '3' or SUBSTRING(ACODE_ICD9_3,5,1) = '1'))
),
DD AS(
	SELECT ID, IN_DATE FROM HIGH_AGE_DD.DBO.DD1996
	WHERE 
		(SUBSTRING(ICD9CM_CODE,1,3) = '250' AND (SUBSTRING(ICD9CM_CODE,5,1) = '3' or SUBSTRING(ICD9CM_CODE,5,1) = '1'))
		OR
		(SUBSTRING(ICD9CM_CODE_1,1,3) = '250' AND (SUBSTRING(ICD9CM_CODE_1,5,1) = '3' or SUBSTRING(ICD9CM_CODE_1,5,1) = '1'))
		OR
		(SUBSTRING(ICD9CM_CODE_2,1,3) = '250' AND (SUBSTRING(ICD9CM_CODE_2,5,1) = '3' or SUBSTRING(ICD9CM_CODE_2,5,1) = '1'))
		OR
		(SUBSTRING(ICD9CM_CODE_3,1,3) = '250' AND (SUBSTRING(ICD9CM_CODE_3,5,1) = '3' or SUBSTRING(ICD9CM_CODE_3,5,1) = '1'))
		OR
		(SUBSTRING(ICD9CM_CODE_4,1,3) = '250' AND (SUBSTRING(ICD9CM_CODE_4,5,1) = '3' or SUBSTRING(ICD9CM_CODE_4,5,1) = '1'))
	UNION ALL
	SELECT ID, IN_DATE FROM HIGH_AGE_DD.DBO.DD1997
	WHERE 
		(SUBSTRING(ICD9CM_CODE,1,3) = '250' AND (SUBSTRING(ICD9CM_CODE,5,1) = '3' or SUBSTRING(ICD9CM_CODE,5,1) = '1'))
		OR
		(SUBSTRING(ICD9CM_CODE_1,1,3) = '250' AND (SUBSTRING(ICD9CM_CODE_1,5,1) = '3' or SUBSTRING(ICD9CM_CODE_1,5,1) = '1'))
		OR
		(SUBSTRING(ICD9CM_CODE_2,1,3) = '250' AND (SUBSTRING(ICD9CM_CODE_2,5,1) = '3' or SUBSTRING(ICD9CM_CODE_2,5,1) = '1'))
		OR
		(SUBSTRING(ICD9CM_CODE_3,1,3) = '250' AND (SUBSTRING(ICD9CM_CODE_3,5,1) = '3' or SUBSTRING(ICD9CM_CODE_3,5,1) = '1'))
		OR
		(SUBSTRING(ICD9CM_CODE_4,1,3) = '250' AND (SUBSTRING(ICD9CM_CODE_4,5,1) = '3' or SUBSTRING(ICD9CM_CODE_4,5,1) = '1'))
	UNION ALL
	SELECT ID, IN_DATE FROM HIGH_AGE_DD.DBO.DD1998
	WHERE 
		(SUBSTRING(ICD9CM_CODE,1,3) = '250' AND (SUBSTRING(ICD9CM_CODE,5,1) = '3' or SUBSTRING(ICD9CM_CODE,5,1) = '1'))
		OR
		(SUBSTRING(ICD9CM_CODE_1,1,3) = '250' AND (SUBSTRING(ICD9CM_CODE_1,5,1) = '3' or SUBSTRING(ICD9CM_CODE_1,5,1) = '1'))
		OR
		(SUBSTRING(ICD9CM_CODE_2,1,3) = '250' AND (SUBSTRING(ICD9CM_CODE_2,5,1) = '3' or SUBSTRING(ICD9CM_CODE_2,5,1) = '1'))
		OR
		(SUBSTRING(ICD9CM_CODE_3,1,3) = '250' AND (SUBSTRING(ICD9CM_CODE_3,5,1) = '3' or SUBSTRING(ICD9CM_CODE_3,5,1) = '1'))
		OR
		(SUBSTRING(ICD9CM_CODE_4,1,3) = '250' AND (SUBSTRING(ICD9CM_CODE_4,5,1) = '3' or SUBSTRING(ICD9CM_CODE_4,5,1) = '1'))
	UNION ALL
	SELECT ID, IN_DATE FROM HIGH_AGE_DD.DBO.DD1999
	WHERE 
		(SUBSTRING(ICD9CM_CODE,1,3) = '250' AND (SUBSTRING(ICD9CM_CODE,5,1) = '3' or SUBSTRING(ICD9CM_CODE,5,1) = '1'))
		OR
		(SUBSTRING(ICD9CM_CODE_1,1,3) = '250' AND (SUBSTRING(ICD9CM_CODE_1,5,1) = '3' or SUBSTRING(ICD9CM_CODE_1,5,1) = '1'))
		OR
		(SUBSTRING(ICD9CM_CODE_2,1,3) = '250' AND (SUBSTRING(ICD9CM_CODE_2,5,1) = '3' or SUBSTRING(ICD9CM_CODE_2,5,1) = '1'))
		OR
		(SUBSTRING(ICD9CM_CODE_3,1,3) = '250' AND (SUBSTRING(ICD9CM_CODE_3,5,1) = '3' or SUBSTRING(ICD9CM_CODE_3,5,1) = '1'))
		OR
		(SUBSTRING(ICD9CM_CODE_4,1,3) = '250' AND (SUBSTRING(ICD9CM_CODE_4,5,1) = '3' or SUBSTRING(ICD9CM_CODE_4,5,1) = '1'))
	UNION ALL
	SELECT ID, IN_DATE FROM HIGH_AGE_DD.DBO.DD2000
	WHERE 
		(SUBSTRING(ICD9CM_CODE,1,3) = '250' AND (SUBSTRING(ICD9CM_CODE,5,1) = '3' or SUBSTRING(ICD9CM_CODE,5,1) = '1'))
		OR
		(SUBSTRING(ICD9CM_CODE_1,1,3) = '250' AND (SUBSTRING(ICD9CM_CODE_1,5,1) = '3' or SUBSTRING(ICD9CM_CODE_1,5,1) = '1'))
		OR
		(SUBSTRING(ICD9CM_CODE_2,1,3) = '250' AND (SUBSTRING(ICD9CM_CODE_2,5,1) = '3' or SUBSTRING(ICD9CM_CODE_2,5,1) = '1'))
		OR
		(SUBSTRING(ICD9CM_CODE_3,1,3) = '250' AND (SUBSTRING(ICD9CM_CODE_3,5,1) = '3' or SUBSTRING(ICD9CM_CODE_3,5,1) = '1'))
		OR
		(SUBSTRING(ICD9CM_CODE_4,1,3) = '250' AND (SUBSTRING(ICD9CM_CODE_4,5,1) = '3' or SUBSTRING(ICD9CM_CODE_4,5,1) = '1'))
	UNION ALL
	SELECT ID, IN_DATE FROM HIGH_AGE_DD.DBO.DD2001
	WHERE 
		(SUBSTRING(ICD9CM_CODE,1,3) = '250' AND (SUBSTRING(ICD9CM_CODE,5,1) = '3' or SUBSTRING(ICD9CM_CODE,5,1) = '1'))
		OR
		(SUBSTRING(ICD9CM_CODE_1,1,3) = '250' AND (SUBSTRING(ICD9CM_CODE_1,5,1) = '3' or SUBSTRING(ICD9CM_CODE_1,5,1) = '1'))
		OR
		(SUBSTRING(ICD9CM_CODE_2,1,3) = '250' AND (SUBSTRING(ICD9CM_CODE_2,5,1) = '3' or SUBSTRING(ICD9CM_CODE_2,5,1) = '1'))
		OR
		(SUBSTRING(ICD9CM_CODE_3,1,3) = '250' AND (SUBSTRING(ICD9CM_CODE_3,5,1) = '3' or SUBSTRING(ICD9CM_CODE_3,5,1) = '1'))
		OR
		(SUBSTRING(ICD9CM_CODE_4,1,3) = '250' AND (SUBSTRING(ICD9CM_CODE_4,5,1) = '3' or SUBSTRING(ICD9CM_CODE_4,5,1) = '1'))
	UNION ALL
	SELECT ID, IN_DATE FROM HIGH_AGE_DD.DBO.DD2002
	WHERE 
		(SUBSTRING(ICD9CM_CODE,1,3) = '250' AND (SUBSTRING(ICD9CM_CODE,5,1) = '3' or SUBSTRING(ICD9CM_CODE,5,1) = '1'))
		OR
		(SUBSTRING(ICD9CM_CODE_1,1,3) = '250' AND (SUBSTRING(ICD9CM_CODE_1,5,1) = '3' or SUBSTRING(ICD9CM_CODE_1,5,1) = '1'))
		OR
		(SUBSTRING(ICD9CM_CODE_2,1,3) = '250' AND (SUBSTRING(ICD9CM_CODE_2,5,1) = '3' or SUBSTRING(ICD9CM_CODE_2,5,1) = '1'))
		OR
		(SUBSTRING(ICD9CM_CODE_3,1,3) = '250' AND (SUBSTRING(ICD9CM_CODE_3,5,1) = '3' or SUBSTRING(ICD9CM_CODE_3,5,1) = '1'))
		OR
		(SUBSTRING(ICD9CM_CODE_4,1,3) = '250' AND (SUBSTRING(ICD9CM_CODE_4,5,1) = '3' or SUBSTRING(ICD9CM_CODE_4,5,1) = '1'))
	UNION ALL
	SELECT ID, IN_DATE FROM HIGH_AGE_DD.DBO.DD2003
	WHERE 
		(SUBSTRING(ICD9CM_CODE,1,3) = '250' AND (SUBSTRING(ICD9CM_CODE,5,1) = '3' or SUBSTRING(ICD9CM_CODE,5,1) = '1'))
		OR
		(SUBSTRING(ICD9CM_CODE_1,1,3) = '250' AND (SUBSTRING(ICD9CM_CODE_1,5,1) = '3' or SUBSTRING(ICD9CM_CODE_1,5,1) = '1'))
		OR
		(SUBSTRING(ICD9CM_CODE_2,1,3) = '250' AND (SUBSTRING(ICD9CM_CODE_2,5,1) = '3' or SUBSTRING(ICD9CM_CODE_2,5,1) = '1'))
		OR
		(SUBSTRING(ICD9CM_CODE_3,1,3) = '250' AND (SUBSTRING(ICD9CM_CODE_3,5,1) = '3' or SUBSTRING(ICD9CM_CODE_3,5,1) = '1'))
		OR
		(SUBSTRING(ICD9CM_CODE_4,1,3) = '250' AND (SUBSTRING(ICD9CM_CODE_4,5,1) = '3' or SUBSTRING(ICD9CM_CODE_4,5,1) = '1'))
	UNION ALL
	SELECT ID, IN_DATE FROM HIGH_AGE_DD.DBO.DD2004
	WHERE 
		(SUBSTRING(ICD9CM_CODE,1,3) = '250' AND (SUBSTRING(ICD9CM_CODE,5,1) = '3' or SUBSTRING(ICD9CM_CODE,5,1) = '1'))
		OR
		(SUBSTRING(ICD9CM_CODE_1,1,3) = '250' AND (SUBSTRING(ICD9CM_CODE_1,5,1) = '3' or SUBSTRING(ICD9CM_CODE_1,5,1) = '1'))
		OR
		(SUBSTRING(ICD9CM_CODE_2,1,3) = '250' AND (SUBSTRING(ICD9CM_CODE_2,5,1) = '3' or SUBSTRING(ICD9CM_CODE_2,5,1) = '1'))
		OR
		(SUBSTRING(ICD9CM_CODE_3,1,3) = '250' AND (SUBSTRING(ICD9CM_CODE_3,5,1) = '3' or SUBSTRING(ICD9CM_CODE_3,5,1) = '1'))
		OR
		(SUBSTRING(ICD9CM_CODE_4,1,3) = '250' AND (SUBSTRING(ICD9CM_CODE_4,5,1) = '3' or SUBSTRING(ICD9CM_CODE_4,5,1) = '1'))
	UNION ALL
	SELECT ID, IN_DATE FROM HIGH_AGE_DD.DBO.DD2005
	WHERE 
		(SUBSTRING(ICD9CM_CODE,1,3) = '250' AND (SUBSTRING(ICD9CM_CODE,5,1) = '3' or SUBSTRING(ICD9CM_CODE,5,1) = '1'))
		OR
		(SUBSTRING(ICD9CM_CODE_1,1,3) = '250' AND (SUBSTRING(ICD9CM_CODE_1,5,1) = '3' or SUBSTRING(ICD9CM_CODE_1,5,1) = '1'))
		OR
		(SUBSTRING(ICD9CM_CODE_2,1,3) = '250' AND (SUBSTRING(ICD9CM_CODE_2,5,1) = '3' or SUBSTRING(ICD9CM_CODE_2,5,1) = '1'))
		OR
		(SUBSTRING(ICD9CM_CODE_3,1,3) = '250' AND (SUBSTRING(ICD9CM_CODE_3,5,1) = '3' or SUBSTRING(ICD9CM_CODE_3,5,1) = '1'))
		OR
		(SUBSTRING(ICD9CM_CODE_4,1,3) = '250' AND (SUBSTRING(ICD9CM_CODE_4,5,1) = '3' or SUBSTRING(ICD9CM_CODE_4,5,1) = '1'))
	UNION ALL
	SELECT ID, IN_DATE FROM HIGH_AGE_DD.DBO.DD2006
	WHERE 
		(SUBSTRING(ICD9CM_CODE,1,3) = '250' AND (SUBSTRING(ICD9CM_CODE,5,1) = '3' or SUBSTRING(ICD9CM_CODE,5,1) = '1'))
		OR
		(SUBSTRING(ICD9CM_CODE_1,1,3) = '250' AND (SUBSTRING(ICD9CM_CODE_1,5,1) = '3' or SUBSTRING(ICD9CM_CODE_1,5,1) = '1'))
		OR
		(SUBSTRING(ICD9CM_CODE_2,1,3) = '250' AND (SUBSTRING(ICD9CM_CODE_2,5,1) = '3' or SUBSTRING(ICD9CM_CODE_2,5,1) = '1'))
		OR
		(SUBSTRING(ICD9CM_CODE_3,1,3) = '250' AND (SUBSTRING(ICD9CM_CODE_3,5,1) = '3' or SUBSTRING(ICD9CM_CODE_3,5,1) = '1'))
		OR
		(SUBSTRING(ICD9CM_CODE_4,1,3) = '250' AND (SUBSTRING(ICD9CM_CODE_4,5,1) = '3' or SUBSTRING(ICD9CM_CODE_4,5,1) = '1'))
	UNION ALL
	SELECT ID, IN_DATE FROM HIGH_AGE_DD.DBO.DD2007
	WHERE 
		(SUBSTRING(ICD9CM_CODE,1,3) = '250' AND (SUBSTRING(ICD9CM_CODE,5,1) = '3' or SUBSTRING(ICD9CM_CODE,5,1) = '1'))
		OR
		(SUBSTRING(ICD9CM_CODE_1,1,3) = '250' AND (SUBSTRING(ICD9CM_CODE_1,5,1) = '3' or SUBSTRING(ICD9CM_CODE_1,5,1) = '1'))
		OR
		(SUBSTRING(ICD9CM_CODE_2,1,3) = '250' AND (SUBSTRING(ICD9CM_CODE_2,5,1) = '3' or SUBSTRING(ICD9CM_CODE_2,5,1) = '1'))
		OR
		(SUBSTRING(ICD9CM_CODE_3,1,3) = '250' AND (SUBSTRING(ICD9CM_CODE_3,5,1) = '3' or SUBSTRING(ICD9CM_CODE_3,5,1) = '1'))
		OR
		(SUBSTRING(ICD9CM_CODE_4,1,3) = '250' AND (SUBSTRING(ICD9CM_CODE_4,5,1) = '3' or SUBSTRING(ICD9CM_CODE_4,5,1) = '1'))
	UNION ALL
	SELECT ID, IN_DATE FROM HIGH_AGE_DD.DBO.DD2008
	WHERE 
		(SUBSTRING(ICD9CM_CODE,1,3) = '250' AND (SUBSTRING(ICD9CM_CODE,5,1) = '3' or SUBSTRING(ICD9CM_CODE,5,1) = '1'))
		OR
		(SUBSTRING(ICD9CM_CODE_1,1,3) = '250' AND (SUBSTRING(ICD9CM_CODE_1,5,1) = '3' or SUBSTRING(ICD9CM_CODE_1,5,1) = '1'))
		OR
		(SUBSTRING(ICD9CM_CODE_2,1,3) = '250' AND (SUBSTRING(ICD9CM_CODE_2,5,1) = '3' or SUBSTRING(ICD9CM_CODE_2,5,1) = '1'))
		OR
		(SUBSTRING(ICD9CM_CODE_3,1,3) = '250' AND (SUBSTRING(ICD9CM_CODE_3,5,1) = '3' or SUBSTRING(ICD9CM_CODE_3,5,1) = '1'))
		OR
		(SUBSTRING(ICD9CM_CODE_4,1,3) = '250' AND (SUBSTRING(ICD9CM_CODE_4,5,1) = '3' or SUBSTRING(ICD9CM_CODE_4,5,1) = '1'))
	UNION ALL
	SELECT ID, IN_DATE FROM HIGH_AGE_DD.DBO.DD2009
	WHERE 
		(SUBSTRING(ICD9CM_CODE,1,3) = '250' AND (SUBSTRING(ICD9CM_CODE,5,1) = '3' or SUBSTRING(ICD9CM_CODE,5,1) = '1'))
		OR
		(SUBSTRING(ICD9CM_CODE_1,1,3) = '250' AND (SUBSTRING(ICD9CM_CODE_1,5,1) = '3' or SUBSTRING(ICD9CM_CODE_1,5,1) = '1'))
		OR
		(SUBSTRING(ICD9CM_CODE_2,1,3) = '250' AND (SUBSTRING(ICD9CM_CODE_2,5,1) = '3' or SUBSTRING(ICD9CM_CODE_2,5,1) = '1'))
		OR
		(SUBSTRING(ICD9CM_CODE_3,1,3) = '250' AND (SUBSTRING(ICD9CM_CODE_3,5,1) = '3' or SUBSTRING(ICD9CM_CODE_3,5,1) = '1'))
		OR
		(SUBSTRING(ICD9CM_CODE_4,1,3) = '250' AND (SUBSTRING(ICD9CM_CODE_4,5,1) = '3' or SUBSTRING(ICD9CM_CODE_4,5,1) = '1'))
	UNION ALL
	SELECT ID, IN_DATE FROM HIGH_AGE_DD.DBO.DD2010
	WHERE 
		(SUBSTRING(ICD9CM_CODE,1,3) = '250' AND (SUBSTRING(ICD9CM_CODE,5,1) = '3' or SUBSTRING(ICD9CM_CODE,5,1) = '1'))
		OR
		(SUBSTRING(ICD9CM_CODE_1,1,3) = '250' AND (SUBSTRING(ICD9CM_CODE_1,5,1) = '3' or SUBSTRING(ICD9CM_CODE_1,5,1) = '1'))
		OR
		(SUBSTRING(ICD9CM_CODE_2,1,3) = '250' AND (SUBSTRING(ICD9CM_CODE_2,5,1) = '3' or SUBSTRING(ICD9CM_CODE_2,5,1) = '1'))
		OR
		(SUBSTRING(ICD9CM_CODE_3,1,3) = '250' AND (SUBSTRING(ICD9CM_CODE_3,5,1) = '3' or SUBSTRING(ICD9CM_CODE_3,5,1) = '1'))
		OR
		(SUBSTRING(ICD9CM_CODE_4,1,3) = '250' AND (SUBSTRING(ICD9CM_CODE_4,5,1) = '3' or SUBSTRING(ICD9CM_CODE_4,5,1) = '1'))
	UNION ALL
	SELECT ID, IN_DATE FROM HIGH_AGE_DD.DBO.DD2011
	WHERE 
		(SUBSTRING(ICD9CM_CODE,1,3) = '250' AND (SUBSTRING(ICD9CM_CODE,5,1) = '3' or SUBSTRING(ICD9CM_CODE,5,1) = '1'))
		OR
		(SUBSTRING(ICD9CM_CODE_1,1,3) = '250' AND (SUBSTRING(ICD9CM_CODE_1,5,1) = '3' or SUBSTRING(ICD9CM_CODE_1,5,1) = '1'))
		OR
		(SUBSTRING(ICD9CM_CODE_2,1,3) = '250' AND (SUBSTRING(ICD9CM_CODE_2,5,1) = '3' or SUBSTRING(ICD9CM_CODE_2,5,1) = '1'))
		OR
		(SUBSTRING(ICD9CM_CODE_3,1,3) = '250' AND (SUBSTRING(ICD9CM_CODE_3,5,1) = '3' or SUBSTRING(ICD9CM_CODE_3,5,1) = '1'))
		OR
		(SUBSTRING(ICD9CM_CODE_4,1,3) = '250' AND (SUBSTRING(ICD9CM_CODE_4,5,1) = '3' or SUBSTRING(ICD9CM_CODE_4,5,1) = '1'))
	UNION ALL
	SELECT ID, IN_DATE FROM HIGH_AGE_DD.DBO.DD2012
	WHERE 
		(SUBSTRING(ICD9CM_CODE,1,3) = '250' AND (SUBSTRING(ICD9CM_CODE,5,1) = '3' or SUBSTRING(ICD9CM_CODE,5,1) = '1'))
		OR
		(SUBSTRING(ICD9CM_CODE_1,1,3) = '250' AND (SUBSTRING(ICD9CM_CODE_1,5,1) = '3' or SUBSTRING(ICD9CM_CODE_1,5,1) = '1'))
		OR
		(SUBSTRING(ICD9CM_CODE_2,1,3) = '250' AND (SUBSTRING(ICD9CM_CODE_2,5,1) = '3' or SUBSTRING(ICD9CM_CODE_2,5,1) = '1'))
		OR
		(SUBSTRING(ICD9CM_CODE_3,1,3) = '250' AND (SUBSTRING(ICD9CM_CODE_3,5,1) = '3' or SUBSTRING(ICD9CM_CODE_3,5,1) = '1'))
		OR
		(SUBSTRING(ICD9CM_CODE_4,1,3) = '250' AND (SUBSTRING(ICD9CM_CODE_4,5,1) = '3' or SUBSTRING(ICD9CM_CODE_4,5,1) = '1'))
	UNION ALL
	SELECT ID, IN_DATE FROM HIGH_AGE_DD.DBO.DD2013
	WHERE 
		(SUBSTRING(ICD9CM_CODE,1,3) = '250' AND (SUBSTRING(ICD9CM_CODE,5,1) = '3' or SUBSTRING(ICD9CM_CODE,5,1) = '1'))
		OR
		(SUBSTRING(ICD9CM_CODE_1,1,3) = '250' AND (SUBSTRING(ICD9CM_CODE_1,5,1) = '3' or SUBSTRING(ICD9CM_CODE_1,5,1) = '1'))
		OR
		(SUBSTRING(ICD9CM_CODE_2,1,3) = '250' AND (SUBSTRING(ICD9CM_CODE_2,5,1) = '3' or SUBSTRING(ICD9CM_CODE_2,5,1) = '1'))
		OR
		(SUBSTRING(ICD9CM_CODE_3,1,3) = '250' AND (SUBSTRING(ICD9CM_CODE_3,5,1) = '3' or SUBSTRING(ICD9CM_CODE_3,5,1) = '1'))
		OR
		(SUBSTRING(ICD9CM_CODE_4,1,3) = '250' AND (SUBSTRING(ICD9CM_CODE_4,5,1) = '3' or SUBSTRING(ICD9CM_CODE_4,5,1) = '1'))
),
A AS(
SELECT * FROM CD
UNION ALL
SELECT ID, IN_DATE AS FUNC_DATE FROM DD
),
B As(
SELECT distinct A.ID, HIGH_AGE_ID.dbo.UID100W.ID_SEX FROM A
left join HIGH_AGE_ID.dbo.UID100W
on UID100W.ID = A.ID)
select B.id_sex, count(B.id_sex) from B
group by B.ID_SEX