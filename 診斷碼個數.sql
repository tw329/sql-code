WITH 
CD AS(
	SELECT ID, ACODE_ICD9_1, ACODE_ICD9_2, ACODE_ICD9_3 FROM HIGH_AGE_CD.DBO.CD2005
	WHERE 
		ACODE_ICD9_2 != '00000' and ACODE_ICD9_3 != '00000'

	union all
	SELECT ID, ACODE_ICD9_1, ACODE_ICD9_2, ACODE_ICD9_3 FROM HIGH_AGE_CD.DBO.CD2006
	WHERE 
		ACODE_ICD9_2 != '00000' and ACODE_ICD9_3 != '00000'

	union all
	SELECT ID, ACODE_ICD9_1, ACODE_ICD9_2, ACODE_ICD9_3 FROM HIGH_AGE_CD.DBO.CD2007
	WHERE 
		ACODE_ICD9_2 != '00000' and ACODE_ICD9_3 != '00000'

	union all
	SELECT ID, ACODE_ICD9_1, ACODE_ICD9_2, ACODE_ICD9_3 FROM HIGH_AGE_CD.DBO.CD2008
	WHERE 
		ACODE_ICD9_2 != '00000' and ACODE_ICD9_3 != '00000'

	union all
	SELECT ID, ACODE_ICD9_1, ACODE_ICD9_2, ACODE_ICD9_3 FROM HIGH_AGE_CD.DBO.CD2009
	WHERE 
		ACODE_ICD9_2 != '00000' and ACODE_ICD9_3 != '00000'

	union all
	SELECT ID, ACODE_ICD9_1, ACODE_ICD9_2, ACODE_ICD9_3 FROM HIGH_AGE_CD.DBO.CD2010
	WHERE 
		ACODE_ICD9_2 != '00000' and ACODE_ICD9_3 != '00000'

	union all
	SELECT ID, ACODE_ICD9_1, ACODE_ICD9_2, ACODE_ICD9_3 FROM HIGH_AGE_CD.DBO.CD2011
	WHERE 
		ACODE_ICD9_2 != '00000' and ACODE_ICD9_3 != '00000'
	union all
	SELECT ID, ACODE_ICD9_1, ACODE_ICD9_2, ACODE_ICD9_3 FROM HIGH_AGE_CD.DBO.CD2012
	WHERE 
		ACODE_ICD9_2 != '00000' and ACODE_ICD9_3 != '00000'
	union all
	SELECT ID, ACODE_ICD9_1, ACODE_ICD9_2, ACODE_ICD9_3 FROM HIGH_AGE_CD.DBO.CD2013
	WHERE 
		ACODE_ICD9_2 != '00000' and ACODE_ICD9_3 != '00000'
)

SELECT count(ID) as 'HΩ', count(distinct ID) as 'H计' FROM CD;

--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

WITH 
CD AS(
	SELECT ID, ACODE_ICD9_1, ACODE_ICD9_2, ACODE_ICD9_3 FROM HIGH_AGE_CD.DBO.CD2005
	WHERE 

((SUBSTRING(ACODE_ICD9_1,1,3) = '250' AND SUBSTRING(ACODE_ICD9_1,5,1) != '3' AND SUBSTRING(ACODE_ICD9_1,5,1) != '1')
OR
(SUBSTRING(ACODE_ICD9_2,1,3) = '250' AND SUBSTRING(ACODE_ICD9_2,5,1) != '3' AND SUBSTRING(ACODE_ICD9_2,5,1) != '1')
OR
(SUBSTRING(ACODE_ICD9_3,1,3) = '250' AND SUBSTRING(ACODE_ICD9_3,5,1) != '3' AND SUBSTRING(ACODE_ICD9_3,5,1) != '1')
OR
substring(ACODE_ICD9_1,1,4) = 'A181' or substring(ACODE_ICD9_2,1,4) = 'A181' or substring(ACODE_ICD9_3,1,4) = 'A181')
and
(CASE_TYPE = '04' or CASE_TYPE = '06')
	union all
	SELECT ID, ACODE_ICD9_1, ACODE_ICD9_2, ACODE_ICD9_3 FROM HIGH_AGE_CD.DBO.CD2006
	WHERE 

((SUBSTRING(ACODE_ICD9_1,1,3) = '250' AND SUBSTRING(ACODE_ICD9_1,5,1) != '3' AND SUBSTRING(ACODE_ICD9_1,5,1) != '1')
OR
(SUBSTRING(ACODE_ICD9_2,1,3) = '250' AND SUBSTRING(ACODE_ICD9_2,5,1) != '3' AND SUBSTRING(ACODE_ICD9_2,5,1) != '1')
OR
(SUBSTRING(ACODE_ICD9_3,1,3) = '250' AND SUBSTRING(ACODE_ICD9_3,5,1) != '3' AND SUBSTRING(ACODE_ICD9_3,5,1) != '1')
OR
substring(ACODE_ICD9_1,1,4) = 'A181' or substring(ACODE_ICD9_2,1,4) = 'A181' or substring(ACODE_ICD9_3,1,4) = 'A181')
and
(CASE_TYPE = '04' or CASE_TYPE = '06')
	union all
	SELECT ID, ACODE_ICD9_1, ACODE_ICD9_2, ACODE_ICD9_3 FROM HIGH_AGE_CD.DBO.CD2007
	WHERE 

((SUBSTRING(ACODE_ICD9_1,1,3) = '250' AND SUBSTRING(ACODE_ICD9_1,5,1) != '3' AND SUBSTRING(ACODE_ICD9_1,5,1) != '1')
OR
(SUBSTRING(ACODE_ICD9_2,1,3) = '250' AND SUBSTRING(ACODE_ICD9_2,5,1) != '3' AND SUBSTRING(ACODE_ICD9_2,5,1) != '1')
OR
(SUBSTRING(ACODE_ICD9_3,1,3) = '250' AND SUBSTRING(ACODE_ICD9_3,5,1) != '3' AND SUBSTRING(ACODE_ICD9_3,5,1) != '1')
OR
substring(ACODE_ICD9_1,1,4) = 'A181' or substring(ACODE_ICD9_2,1,4) = 'A181' or substring(ACODE_ICD9_3,1,4) = 'A181')
and
(CASE_TYPE = '04' or CASE_TYPE = '06')
	union all
	SELECT ID, ACODE_ICD9_1, ACODE_ICD9_2, ACODE_ICD9_3 FROM HIGH_AGE_CD.DBO.CD2008
	WHERE 

((SUBSTRING(ACODE_ICD9_1,1,3) = '250' AND SUBSTRING(ACODE_ICD9_1,5,1) != '3' AND SUBSTRING(ACODE_ICD9_1,5,1) != '1')
OR
(SUBSTRING(ACODE_ICD9_2,1,3) = '250' AND SUBSTRING(ACODE_ICD9_2,5,1) != '3' AND SUBSTRING(ACODE_ICD9_2,5,1) != '1')
OR
(SUBSTRING(ACODE_ICD9_3,1,3) = '250' AND SUBSTRING(ACODE_ICD9_3,5,1) != '3' AND SUBSTRING(ACODE_ICD9_3,5,1) != '1')
OR
substring(ACODE_ICD9_1,1,4) = 'A181' or substring(ACODE_ICD9_2,1,4) = 'A181' or substring(ACODE_ICD9_3,1,4) = 'A181')
and
(CASE_TYPE = '04' or CASE_TYPE = '06')
	union all
	SELECT ID, ACODE_ICD9_1, ACODE_ICD9_2, ACODE_ICD9_3 FROM HIGH_AGE_CD.DBO.CD2009
	WHERE 

((SUBSTRING(ACODE_ICD9_1,1,3) = '250' AND SUBSTRING(ACODE_ICD9_1,5,1) != '3' AND SUBSTRING(ACODE_ICD9_1,5,1) != '1')
OR
(SUBSTRING(ACODE_ICD9_2,1,3) = '250' AND SUBSTRING(ACODE_ICD9_2,5,1) != '3' AND SUBSTRING(ACODE_ICD9_2,5,1) != '1')
OR
(SUBSTRING(ACODE_ICD9_3,1,3) = '250' AND SUBSTRING(ACODE_ICD9_3,5,1) != '3' AND SUBSTRING(ACODE_ICD9_3,5,1) != '1')
OR
substring(ACODE_ICD9_1,1,4) = 'A181' or substring(ACODE_ICD9_2,1,4) = 'A181' or substring(ACODE_ICD9_3,1,4) = 'A181')
and
(CASE_TYPE = '04' or CASE_TYPE = '06')
	union all
	SELECT ID, ACODE_ICD9_1, ACODE_ICD9_2, ACODE_ICD9_3 FROM HIGH_AGE_CD.DBO.CD2010
	WHERE 

((SUBSTRING(ACODE_ICD9_1,1,3) = '250' AND SUBSTRING(ACODE_ICD9_1,5,1) != '3' AND SUBSTRING(ACODE_ICD9_1,5,1) != '1')
OR
(SUBSTRING(ACODE_ICD9_2,1,3) = '250' AND SUBSTRING(ACODE_ICD9_2,5,1) != '3' AND SUBSTRING(ACODE_ICD9_2,5,1) != '1')
OR
(SUBSTRING(ACODE_ICD9_3,1,3) = '250' AND SUBSTRING(ACODE_ICD9_3,5,1) != '3' AND SUBSTRING(ACODE_ICD9_3,5,1) != '1')
OR
substring(ACODE_ICD9_1,1,4) = 'A181' or substring(ACODE_ICD9_2,1,4) = 'A181' or substring(ACODE_ICD9_3,1,4) = 'A181')
and
(CASE_TYPE = '04' or CASE_TYPE = '06')
	union all
	SELECT ID, ACODE_ICD9_1, ACODE_ICD9_2, ACODE_ICD9_3 FROM HIGH_AGE_CD.DBO.CD2011
	WHERE 

((SUBSTRING(ACODE_ICD9_1,1,3) = '250' AND SUBSTRING(ACODE_ICD9_1,5,1) != '3' AND SUBSTRING(ACODE_ICD9_1,5,1) != '1')
OR
(SUBSTRING(ACODE_ICD9_2,1,3) = '250' AND SUBSTRING(ACODE_ICD9_2,5,1) != '3' AND SUBSTRING(ACODE_ICD9_2,5,1) != '1')
OR
(SUBSTRING(ACODE_ICD9_3,1,3) = '250' AND SUBSTRING(ACODE_ICD9_3,5,1) != '3' AND SUBSTRING(ACODE_ICD9_3,5,1) != '1')
OR
substring(ACODE_ICD9_1,1,4) = 'A181' or substring(ACODE_ICD9_2,1,4) = 'A181' or substring(ACODE_ICD9_3,1,4) = 'A181')
and
(CASE_TYPE = '04' or CASE_TYPE = '06')
	union all
	SELECT ID, ACODE_ICD9_1, ACODE_ICD9_2, ACODE_ICD9_3 FROM HIGH_AGE_CD.DBO.CD2012
	WHERE 

((SUBSTRING(ACODE_ICD9_1,1,3) = '250' AND SUBSTRING(ACODE_ICD9_1,5,1) != '3' AND SUBSTRING(ACODE_ICD9_1,5,1) != '1')
OR
(SUBSTRING(ACODE_ICD9_2,1,3) = '250' AND SUBSTRING(ACODE_ICD9_2,5,1) != '3' AND SUBSTRING(ACODE_ICD9_2,5,1) != '1')
OR
(SUBSTRING(ACODE_ICD9_3,1,3) = '250' AND SUBSTRING(ACODE_ICD9_3,5,1) != '3' AND SUBSTRING(ACODE_ICD9_3,5,1) != '1')
OR
substring(ACODE_ICD9_1,1,4) = 'A181' or substring(ACODE_ICD9_2,1,4) = 'A181' or substring(ACODE_ICD9_3,1,4) = 'A181')
and
(CASE_TYPE = '04' or CASE_TYPE = '06')
	union all
	SELECT ID, ACODE_ICD9_1, ACODE_ICD9_2, ACODE_ICD9_3 FROM HIGH_AGE_CD.DBO.CD2013
	WHERE 

((SUBSTRING(ACODE_ICD9_1,1,3) = '250' AND SUBSTRING(ACODE_ICD9_1,5,1) != '3' AND SUBSTRING(ACODE_ICD9_1,5,1) != '1')
OR
(SUBSTRING(ACODE_ICD9_2,1,3) = '250' AND SUBSTRING(ACODE_ICD9_2,5,1) != '3' AND SUBSTRING(ACODE_ICD9_2,5,1) != '1')
OR
(SUBSTRING(ACODE_ICD9_3,1,3) = '250' AND SUBSTRING(ACODE_ICD9_3,5,1) != '3' AND SUBSTRING(ACODE_ICD9_3,5,1) != '1')
OR
substring(ACODE_ICD9_1,1,4) = 'A181' or substring(ACODE_ICD9_2,1,4) = 'A181' or substring(ACODE_ICD9_3,1,4) = 'A181')
and
(CASE_TYPE = '04' or CASE_TYPE = '06')
)

--SELECT count(ID) as 'HΩ', count(distinct ID) as 'H计' FROM CD;
SELECT ACODE_ICD9_1, count(ACODE_ICD9_1) as 'H计' FROM CD
group by ACODE_ICD9_1
order by 'H计';
----------------------------------------------------------------------------------------------------------------------------------------------------------


WITH 
CD AS(
	SELECT ID, ACODE_ICD9_1, ACODE_ICD9_2, ACODE_ICD9_3 FROM HIGH_AGE_CD.DBO.CD2005
	WHERE 


(CASE_TYPE = '04' or CASE_TYPE = '06')
	union all
	SELECT ID, ACODE_ICD9_1, ACODE_ICD9_2, ACODE_ICD9_3 FROM HIGH_AGE_CD.DBO.CD2006
	WHERE 


(CASE_TYPE = '04' or CASE_TYPE = '06')
	union all
	SELECT ID, ACODE_ICD9_1, ACODE_ICD9_2, ACODE_ICD9_3 FROM HIGH_AGE_CD.DBO.CD2007
	WHERE 


(CASE_TYPE = '04' or CASE_TYPE = '06')
	union all
	SELECT ID, ACODE_ICD9_1, ACODE_ICD9_2, ACODE_ICD9_3 FROM HIGH_AGE_CD.DBO.CD2008
	WHERE 


(CASE_TYPE = '04' or CASE_TYPE = '06')
	union all
	SELECT ID, ACODE_ICD9_1, ACODE_ICD9_2, ACODE_ICD9_3 FROM HIGH_AGE_CD.DBO.CD2009
	WHERE 


(CASE_TYPE = '04' or CASE_TYPE = '06')
	union all
	SELECT ID, ACODE_ICD9_1, ACODE_ICD9_2, ACODE_ICD9_3 FROM HIGH_AGE_CD.DBO.CD2010
	WHERE 


(CASE_TYPE = '04' or CASE_TYPE = '06')
	union all
	SELECT ID, ACODE_ICD9_1, ACODE_ICD9_2, ACODE_ICD9_3 FROM HIGH_AGE_CD.DBO.CD2011
	WHERE 


(CASE_TYPE = '04' or CASE_TYPE = '06')
	union all
	SELECT ID, ACODE_ICD9_1, ACODE_ICD9_2, ACODE_ICD9_3 FROM HIGH_AGE_CD.DBO.CD2012
	WHERE 

(CASE_TYPE = '04' or CASE_TYPE = '06')
	union all
	SELECT ID, ACODE_ICD9_1, ACODE_ICD9_2, ACODE_ICD9_3 FROM HIGH_AGE_CD.DBO.CD2013
	WHERE 

(CASE_TYPE = '04' or CASE_TYPE = '06')
)

SELECT ACODE_ICD9_1, count(ACODE_ICD9_1) as 'H计' FROM CD
group by ACODE_ICD9_1
order by 'H计';

SELECT ACODE_ICD9_2, count(ACODE_ICD9_2) as 'H计' FROM CD
group by ACODE_ICD9_2

SELECT ACODE_ICD9_3, count(ACODE_ICD9_3) as 'H计' FROM CD
group by ACODE_ICD9_3

---------------------------------------------------------------------------------------------------------------------


WITH 
CD AS(
	SELECT ID FROM HIGH_AGE_CD.DBO.CD2005
	WHERE 


(CASE_TYPE = '08')
	union all
	SELECT ID FROM HIGH_AGE_CD.DBO.CD2006
	WHERE 


(CASE_TYPE = '08')
	union all
	SELECT ID FROM HIGH_AGE_CD.DBO.CD2007
	WHERE 


(CASE_TYPE = '08')
	union all
	SELECT ID FROM HIGH_AGE_CD.DBO.CD2008
	WHERE 


(CASE_TYPE = '08')
	union all
	SELECT ID FROM HIGH_AGE_CD.DBO.CD2009
	WHERE 


(CASE_TYPE = '08')
	union all
	SELECT ID FROM HIGH_AGE_CD.DBO.CD2010
	WHERE 


(CASE_TYPE = '08')
	union all
	SELECT ID FROM HIGH_AGE_CD.DBO.CD2011
	WHERE 


(CASE_TYPE = '08')
	union all
	SELECT ID FROM HIGH_AGE_CD.DBO.CD2012
	WHERE 

(CASE_TYPE = '08')
	union all
	SELECT ID FROM HIGH_AGE_CD.DBO.CD2013
	WHERE 

(CASE_TYPE = '08')
)

SELECT count(ID) as 'HΩ', count(distinct ID) as 'H计' FROM CD


