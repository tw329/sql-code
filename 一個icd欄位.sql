WITH 
CD AS(
	SELECT ID, ACODE_ICD9_1, ACODE_ICD9_2, ACODE_ICD9_3 FROM HIGH_AGE_CD.DBO.CD2005
	WHERE
		(SUBSTRING(ACODE_ICD9_1,1,3) = '250' AND SUBSTRING(ACODE_ICD9_1,5,1) != '3' AND SUBSTRING(ACODE_ICD9_1,5,1) != '1') and
		(CASE_TYPE = '04' or CASE_TYPE = '06') and
		ACODE_ICD9_2 != '00000' and ACODE_ICD9_3 != '00000'

	union all
	SELECT ID, ACODE_ICD9_1, ACODE_ICD9_2, ACODE_ICD9_3 FROM HIGH_AGE_CD.DBO.CD2006
	WHERE 
		(SUBSTRING(ACODE_ICD9_1,1,3) = '250' AND SUBSTRING(ACODE_ICD9_1,5,1) != '3' AND SUBSTRING(ACODE_ICD9_1,5,1) != '1') and
		(CASE_TYPE = '04' or CASE_TYPE = '06') and
		ACODE_ICD9_2 != '00000' and ACODE_ICD9_3 != '00000'

	union all
	SELECT ID, ACODE_ICD9_1, ACODE_ICD9_2, ACODE_ICD9_3 FROM HIGH_AGE_CD.DBO.CD2007
	WHERE 
		(SUBSTRING(ACODE_ICD9_1,1,3) = '250' AND SUBSTRING(ACODE_ICD9_1,5,1) != '3' AND SUBSTRING(ACODE_ICD9_1,5,1) != '1') and
		(CASE_TYPE = '04' or CASE_TYPE = '06') and
		ACODE_ICD9_2 != '00000' and ACODE_ICD9_3 != '00000'

	union all
	SELECT ID, ACODE_ICD9_1, ACODE_ICD9_2, ACODE_ICD9_3 FROM HIGH_AGE_CD.DBO.CD2008
	WHERE 
		(SUBSTRING(ACODE_ICD9_1,1,3) = '250' AND SUBSTRING(ACODE_ICD9_1,5,1) != '3' AND SUBSTRING(ACODE_ICD9_1,5,1) != '1') and
		(CASE_TYPE = '04' or CASE_TYPE = '06') and
		ACODE_ICD9_2 != '00000' and ACODE_ICD9_3 != '00000'

	union all
	SELECT ID, ACODE_ICD9_1, ACODE_ICD9_2, ACODE_ICD9_3 FROM HIGH_AGE_CD.DBO.CD2009
	WHERE 
		(SUBSTRING(ACODE_ICD9_1,1,3) = '250' AND SUBSTRING(ACODE_ICD9_1,5,1) != '3' AND SUBSTRING(ACODE_ICD9_1,5,1) != '1') and
		(CASE_TYPE = '04' or CASE_TYPE = '06') and
		ACODE_ICD9_2 != '00000' and ACODE_ICD9_3 != '00000'

	union all
	SELECT ID, ACODE_ICD9_1, ACODE_ICD9_2, ACODE_ICD9_3 FROM HIGH_AGE_CD.DBO.CD2010
	WHERE 
		(SUBSTRING(ACODE_ICD9_1,1,3) = '250' AND SUBSTRING(ACODE_ICD9_1,5,1) != '3' AND SUBSTRING(ACODE_ICD9_1,5,1) != '1') and
		(CASE_TYPE = '04' or CASE_TYPE = '06') and
		ACODE_ICD9_2 != '00000' and ACODE_ICD9_3 != '00000'

	union all
	SELECT ID, ACODE_ICD9_1, ACODE_ICD9_2, ACODE_ICD9_3 FROM HIGH_AGE_CD.DBO.CD2011
	WHERE 
		(SUBSTRING(ACODE_ICD9_1,1,3) = '250' AND SUBSTRING(ACODE_ICD9_1,5,1) != '3' AND SUBSTRING(ACODE_ICD9_1,5,1) != '1') and
		(CASE_TYPE = '04' or CASE_TYPE = '06') and
		ACODE_ICD9_2 != '00000' and ACODE_ICD9_3 != '00000'
	union all
	SELECT ID, ACODE_ICD9_1, ACODE_ICD9_2, ACODE_ICD9_3 FROM HIGH_AGE_CD.DBO.CD2012
	WHERE 
		(SUBSTRING(ACODE_ICD9_1,1,3) = '250' AND SUBSTRING(ACODE_ICD9_1,5,1) != '3' AND SUBSTRING(ACODE_ICD9_1,5,1) != '1') and
		(CASE_TYPE = '04' or CASE_TYPE = '06') and
		ACODE_ICD9_2 != '00000' and ACODE_ICD9_3 != '00000'
	union all
	SELECT ID, ACODE_ICD9_1, ACODE_ICD9_2, ACODE_ICD9_3 FROM HIGH_AGE_CD.DBO.CD2013
	WHERE 
		(SUBSTRING(ACODE_ICD9_1,1,3) = '250' AND SUBSTRING(ACODE_ICD9_1,5,1) != '3' AND SUBSTRING(ACODE_ICD9_1,5,1) != '1') and
		(CASE_TYPE = '04' or CASE_TYPE = '06') and
		ACODE_ICD9_2 != '00000' and ACODE_ICD9_3 != '00000'
)

select distinct CD.ID from CD

